<!doctype html><html class=no-js lang=en><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><title>在 Linux 中怎样将 MySQL 迁移到 MariaDB 上 - Linux.cn Archive</title>
<script>(function(e,t){e[t]=e[t].replace("no-js","js")})(document.documentElement,"className")</script><meta name=description content><meta property="og:title" content="在 Linux 中怎样将 MySQL 迁移到 MariaDB 上"><meta property="og:description" content="自从甲骨文收购 MySQL 后，由于甲骨文对 MySQL 的开发和维护更多倾向于闭门的立场，很多 MySQL 的开发者和用户放弃了 MySQL。在社区驱动下，促使更多人移到 MySQL 的另一个叫 MariaDB 的分支。在原有 MySQL 开发人员的带领下，MariaDB 的开发遵循开源的理念，并确保它的二进制格式与 MySQL 兼容。Linux 发行版如 Red Hat 家族（Fedora，CentOS，RHEL），Ubuntu 和 Mint，openSUSE 和 Debian 已经开始使用，并支持 MariaDB 作为 MySQL 的直接替换品。  如果你想要将 MySQL 中的数据库迁移到 MariaDB 中，这篇文章就是你所期待的。幸运的是"><meta property="og:type" content="article"><meta property="og:url" content="/article-6210-1.html"><meta property="article:section" content="posts"><meta property="article:published_time" content="2015-09-14T09:14:00+00:00"><meta property="article:modified_time" content="2015-09-14T09:14:00+00:00"><meta itemprop=name content="在 Linux 中怎样将 MySQL 迁移到 MariaDB 上"><meta itemprop=description content="自从甲骨文收购 MySQL 后，由于甲骨文对 MySQL 的开发和维护更多倾向于闭门的立场，很多 MySQL 的开发者和用户放弃了 MySQL。在社区驱动下，促使更多人移到 MySQL 的另一个叫 MariaDB 的分支。在原有 MySQL 开发人员的带领下，MariaDB 的开发遵循开源的理念，并确保它的二进制格式与 MySQL 兼容。Linux 发行版如 Red Hat 家族（Fedora，CentOS，RHEL），Ubuntu 和 Mint，openSUSE 和 Debian 已经开始使用，并支持 MariaDB 作为 MySQL 的直接替换品。  如果你想要将 MySQL 中的数据库迁移到 MariaDB 中，这篇文章就是你所期待的。幸运的是"><meta itemprop=datePublished content="2015-09-14T09:14:00+00:00"><meta itemprop=dateModified content="2015-09-14T09:14:00+00:00"><meta itemprop=wordCount content="457"><meta itemprop=keywords content="MySQL,迁移,MariaDB,"><link rel=preconnect href=https://fonts.bunny.net crossorigin><link rel=dns-prefetch href=//fonts.bunny.net><link rel=dns-prefetch href=//fonts.bunny.net><link rel=stylesheet href="https://fonts.bunny.net/css?family=Open+Sans:400,400i,700"><link rel=stylesheet href=/css/style.css><link rel="shortcut icon" href=/favicon.ico></head><body class=body><div class="container container--outer"><header class=header><div class="container header__container"><div class=logo><a class=logo__link href=/ title="Linux.cn Archive" rel=home><div class="logo__item logo__text"><div class=logo__title>Linux.cn Archive</div></div></a></div><nav class=menu><button class=menu__btn aria-haspopup=true aria-expanded=false tabindex=0>
<span class=menu__btn-title tabindex=-1>Menu</span></button><ul class=menu__list><li class=menu__item><a class=menu__link href=/><span class=menu__text>Home</span></a></li><li class=menu__item><a class=menu__link href=/categories/><span class=menu__text>Categories</span></a></li><li class=menu__item><a class=menu__link href=/tags/><span class=menu__text>Tags</span></a></li><li class=menu__item><a class=menu__link href><span class=menu__text>RSS</span></a></li></ul></nav></div></header><div class="wrapper flex"><div class=primary><main class=main role=main><article class=post><header class=post__header><h1 class=post__title>在 Linux 中怎样将 MySQL 迁移到 MariaDB 上</h1><div class="post__meta meta"><div class="meta__item-datetime meta__item"><svg class="meta__icon icon icon-time" width="16" height="14" viewBox="0 0 30 28"><path d="M15 0C7 0 1 6 1 14s6 14 14 14 14-6 14-14S23 0 15 0zm0 25C9 25 4 20 4 14S9 3 15 3s11 5 11 11-5 11-11 11zm1-18h-2v8.4l6.8 4.4L22 18l-6-3.8V7z"/></svg><time class=meta__text datetime=2015-09-14T09:14:00Z>September 14, 2015</time></div></div></header><div class="content post__content clearfix"><p>自从甲骨文收购 MySQL 后，由于甲骨文对 MySQL 的开发和维护更多倾向于闭门的立场，很多 MySQL 的开发者和用户放弃了 MySQL。在社区驱动下，促使更多人移到 MySQL 的另一个叫 MariaDB 的分支。在原有 MySQL 开发人员的带领下，MariaDB 的开发遵循开源的理念，并确保<a href=https://mariadb.com/kb/en/mariadb/mariadb-vs-mysql-compatibility/>它的二进制格式与 MySQL 兼容</a>。Linux 发行版如 Red Hat 家族（Fedora，CentOS，RHEL），Ubuntu 和 Mint，openSUSE 和 Debian 已经开始使用，并支持 MariaDB 作为 MySQL 的直接替换品。</p><p><img src=/data/attachment/album/201509/13/212003cfteafjxezxxfefs.jpg alt></p><p>如果你想要将 MySQL 中的数据库迁移到 MariaDB 中，这篇文章就是你所期待的。幸运的是，由于他们的二进制兼容性，MySQL-to-MariaDB 迁移过程是非常简单的。如果你按照下面的步骤，将 MySQL 迁移到 MariaDB 会是无痛的。</p><h3 id=准备-mysql-数据库和表>准备 MySQL 数据库和表</h3><p>出于演示的目的，我们在做迁移之前在数据库中创建一个测试的 MySQL 数据库和表。如果你在 MySQL 中已经有了要迁移到 MariaDB 的数据库，跳过此步骤。否则，按以下步骤操作。</p><p>在终端输入 root 密码登录到 MySQL 。</p><pre tabindex=0><code>$ mysql -u root -p 
</code></pre><p>创建一个数据库和表。</p><pre tabindex=0><code>mysql&gt; create database test01;
mysql&gt; use test01;
mysql&gt; create table pet(name varchar(30), owner varchar(30), species varchar(20), sex char(1));
</code></pre><p>在表中添加一些数据。</p><pre tabindex=0><code>mysql&gt; insert into pet values(&#39;brandon&#39;,&#39;Jack&#39;,&#39;puddle&#39;,&#39;m&#39;),(&#39;dixie&#39;,&#39;Danny&#39;,&#39;chihuahua&#39;,&#39;f&#39;); 
</code></pre><p>退出 MySQL 数据库.</p><h3 id=备份-mysql-数据库>备份 MySQL 数据库</h3><p>下一步是备份现有的 MySQL 数据库。使用下面的 mysqldump 命令导出现有的数据库到文件中。运行此命令之前，请确保你的 MySQL 服务器上启用了二进制日志。如果你不知道如何启用二进制日志，请参阅结尾的教程说明。</p><pre tabindex=0><code>$ mysqldump --all-databases --user=root --password --master-data &gt; backupdb.sql 
</code></pre><p><img src=/data/attachment/album/201509/13/212006qh7hw8bnfkhnuhng.jpg alt></p><p>现在，在卸载 MySQL 之前先在系统上备份 my.cnf 文件。此步是可选的。</p><pre tabindex=0><code>$ sudo cp /etc/mysql/my.cnf /opt/my.cnf.bak 
</code></pre><h3 id=卸载-mysql>卸载 MySQL</h3><p>首先，停止 MySQL 服务。</p><pre tabindex=0><code>$ sudo service mysql stop
</code></pre><p>或者:</p><pre tabindex=0><code>$ sudo systemctl stop mysql
</code></pre><p>或:</p><pre tabindex=0><code>$ sudo /etc/init.d/mysql stop 
</code></pre><p>然后继续下一步，使用以下命令移除 MySQL 和配置文件。</p><p>在基于 RPM 的系统上 (例如, CentOS, Fedora 或 RHEL):</p><pre tabindex=0><code>$ sudo yum remove mysql* mysql-server mysql-devel mysql-libs
$ sudo rm -rf /var/lib/mysql 
</code></pre><p>在基于 Debian 的系统上(例如, Debian, Ubuntu 或 Mint):</p><pre tabindex=0><code>$ sudo apt-get remove mysql-server mysql-client mysql-common
$ sudo apt-get autoremove
$ sudo apt-get autoclean
$ sudo deluser mysql
$ sudo rm -rf /var/lib/mysql 
</code></pre><h3 id=安装-mariadb>安装 MariaDB</h3><p>在 CentOS/RHEL 7和Ubuntu（14.04或更高版本）上，最新的 MariaDB 已经包含在其官方源。在 Fedora 上，自19 版本后 MariaDB 已经替代了 MySQL。如果你使用的是旧版本或 LTS 类型如 Ubuntu 13.10 或更早的，你仍然可以通过添加其官方仓库来安装 MariaDB。</p><p><a href="https://downloads.mariadb.org/mariadb/repositories/#mirror=aasaam">MariaDB 网站</a> 提供了一个在线工具帮助你依据你的 Linux 发行版中来添加 MariaDB 的官方仓库。此工具为 openSUSE, Arch Linux, Mageia, Fedora, CentOS, RedHat, Mint, Ubuntu, 和 Debian 提供了 MariaDB 的官方仓库.</p><p><img src=/data/attachment/album/201509/13/212009l3liivqs1in0i77i.jpg alt></p><p>下面例子中，我们使用 Ubuntu 14.04 发行版和 CentOS 7 配置 MariaDB 库。</p><p><strong>Ubuntu 14.04</strong></p><pre tabindex=0><code>$ sudo apt-get install software-properties-common
$ sudo apt-key adv --recv-keys --keyserver hkp://keyserver.ubuntu.com:80 0xcbcb082a1bb943db
$ sudo add-apt-repository &#39;deb http://mirror.mephi.ru/mariadb/repo/5.5/ubuntu trusty main&#39;
$ sudo apt-get update
$ sudo apt-get install mariadb-server 
</code></pre><p><strong>CentOS 7</strong></p><p>以下为 MariaDB 创建一个自定义的 yum 仓库文件。</p><pre tabindex=0><code>$ sudo vi /etc/yum.repos.d/MariaDB.repo 
</code></pre><hr><pre tabindex=0><code>[mariadb]
name = MariaDB
baseurl = http://yum.mariadb.org/5.5/centos7-amd64
gpgkey=https://yum.mariadb.org/RPM-GPG-KEY-MariaDB
gpgcheck=1
</code></pre><hr><pre tabindex=0><code>$ sudo yum install MariaDB-server MariaDB-client 
</code></pre><p>安装了所有必要的软件包后，你可能会被要求为 MariaDB 的 root 用户创建一个新密码。设置 root 的密码后，别忘了恢复备份的 my.cnf 文件。</p><pre tabindex=0><code>$ sudo cp /opt/my.cnf /etc/mysql/
</code></pre><p>现在启动 MariaDB 服务。</p><pre tabindex=0><code>$ sudo service mariadb start
</code></pre><p>或:</p><pre tabindex=0><code>$ sudo systemctl start mariadb
</code></pre><p>或:</p><pre tabindex=0><code>$ sudo /etc/init.d/mariadb start 
</code></pre><h3 id=导入-mysql-的数据库>导入 MySQL 的数据库</h3><p>最后，我们将以前导出的数据库导入到 MariaDB 服务器中。</p><pre tabindex=0><code>$ mysql -u root -p &lt; backupdb.sql 
</code></pre><p>输入你 MariaDB 的 root 密码，数据库导入过程将开始。导入过程完成后，将返回到命令提示符下。</p><p>要检查导入过程是否完全成功，请登录到 MariaDB 服务器，并查看一些样本来检查。</p><pre tabindex=0><code>$ mysql -u root -p
</code></pre><hr><pre tabindex=0><code>MariaDB [(none)]&gt; show databases;
MariaDB [(none)]&gt; use test01;
MariaDB [test01]&gt; select * from pet; 
</code></pre><p><img src=/data/attachment/album/201509/13/212018xcndeiyhn077fidr.jpg alt></p><h3 id=结论>结论</h3><p>如你在本教程中看到的，MySQL-to-MariaDB 的迁移并不难。你应该知道，MariaDB 相比 MySQL 有很多新的功能。至于配置方面，在我的测试情况下，我只是将我旧的 MySQL 配置文件（my.cnf）作为 MariaDB 的配置文件，导入过程完全没有出现任何问题。对于配置文件，我建议你在迁移之前请仔细阅读 MariaDB 配置选项的文件，特别是如果你正在使用 MySQL 的特定配置。</p><p>如果你正在运行有海量的表、包括群集或主从复制的数据库的复杂配置，看一看 Mozilla IT 和 Operations 团队的 <a href=https://blog.mozilla.org/it/2013/12/16/upgrading-from-mysql-5-1-to-mariadb-5-5/>更详细的指南</a> ，或者 <a href=https://mariadb.com/kb/en/mariadb/documentation/>官方的 MariaDB 文档</a>。</p><h3 id=故障排除>故障排除</h3><p>1、 在运行 mysqldump 命令备份数据库时出现以下错误。</p><pre tabindex=0><code>$ mysqldump --all-databases --user=root --password --master-data &gt; backupdb.sql 
</code></pre><hr><pre tabindex=0><code>mysqldump: Error: Binlogging on server not active
</code></pre><p>通过使用 &ldquo;&ndash;master-data&rdquo;，你可以在导出的输出中包含二进制日志信息，这对于数据库的复制和恢复是有用的。但是，二进制日志未在 MySQL 服务器启用。要解决这个错误，修改 my.cnf 文件，并在 [mysqld] 部分添加下面的选项。（LCTT 译注：事实上，如果你并没有启用二进制日志，那取消"&ndash;master-data"即可。）</p><pre tabindex=0><code>log-bin=mysql-bin
</code></pre><p>保存 my.cnf 文件，并重新启动 MySQL 服务：</p><pre tabindex=0><code>$ sudo service mysql restart
</code></pre><p>或者:</p><pre tabindex=0><code>$ sudo systemctl restart mysql
</code></pre><p>或:</p><pre tabindex=0><code>$ sudo /etc/init.d/mysql restart 
</code></pre><hr><p>via: <a href=http://xmodulo.com/migrate-mysql-to-mariadb-linux.html>http://xmodulo.com/migrate-mysql-to-mariadb-linux.html</a></p><p>作者：<a href=http://xmodulo.com/author/kristophorus>Kristophorus Hadiono</a> 译者：<a href=https://github.com/strugglingyouth>strugglingyouth</a> 校对：<a href=https://github.com/wxy>wxy</a></p><p>本文由 <a href=https://github.com/LCTT/TranslateProject>LCTT</a> 原创翻译，<a href=http://linux.cn/>Linux中国</a> 荣誉推出</p></div><footer class=post__footer><div class="post__tags tags clearfix"><svg class="tags__badge icon icon-tag" width="16" height="16" viewBox="0 0 32 32"><path d="M32 19c0 1-1 2-1 2L21 31s-1 1-2 1-2-1-2-1L2 16c-1-1-1.4-2-1.4-2S0 12.5.0 11V3C0 1.5.8.8.8.8S1.5.0 3 0h8c1.5.0 3 .6 3 .6S15 1 16 2l15 15s1 1 1 2zM7 10a3 3 0 100-6 3 3 0 000 6z"/></svg><ul class=tags__list><li class=tags__item><a class="tags__link btn" href=/tags/mysql/ rel=tag>MySQL</a></li><li class=tags__item><a class="tags__link btn" href=/tags/%E8%BF%81%E7%A7%BB/ rel=tag>迁移</a></li><li class=tags__item><a class="tags__link btn" href=/tags/mariadb/ rel=tag>MariaDB</a></li></ul></div></footer></article></main></div></div><footer class=footer><div class="container footer__container flex"><div class=footer__copyright>&copy; 2025 Linux.cn Archive.
<span class=footer__copyright-credits>Generated with <a href=https://gohugo.io/ rel="nofollow noopener" target=_blank>Hugo</a> and <a href=https://github.com/Vimux/Mainroad/ rel="nofollow noopener" target=_blank>Mainroad</a> theme.</span></div></div></footer></div><script async defer src=/js/menu.js></script></body></html>