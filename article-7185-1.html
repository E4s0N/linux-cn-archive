<!doctype html><html class=no-js lang=en><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><title>如何在 Debian 中配置 Tripewire IDS - Linux.cn Archive</title>
<script>(function(e,t){e[t]=e[t].replace("no-js","js")})(document.documentElement,"className")</script><meta name=description content><meta property="og:title" content="如何在 Debian 中配置 Tripewire IDS"><meta property="og:description" content="它是 Linux 环境下基于主机的入侵检测系统（IDS）。tripwire 的高级功能可以检测并报告任何 Linux 中未授权的（文件和目录）的更改。"><meta property="og:type" content="article"><meta property="og:url" content="/article-7185-1.html"><meta property="article:section" content="posts"><meta property="article:published_time" content="2016-04-03T10:41:29+00:00"><meta property="article:modified_time" content="2016-04-03T10:41:29+00:00"><meta itemprop=name content="如何在 Debian 中配置 Tripewire IDS"><meta itemprop=description content="它是 Linux 环境下基于主机的入侵检测系统（IDS）。tripwire 的高级功能可以检测并报告任何 Linux 中未授权的（文件和目录）的更改。"><meta itemprop=datePublished content="2016-04-03T10:41:29+00:00"><meta itemprop=dateModified content="2016-04-03T10:41:29+00:00"><meta itemprop=wordCount content="878"><meta itemprop=keywords content="Tripewire,"><link rel=preconnect href=https://fonts.bunny.net crossorigin><link rel=dns-prefetch href=//fonts.bunny.net><link rel=dns-prefetch href=//fonts.bunny.net><link rel=stylesheet href="https://fonts.bunny.net/css?family=Open+Sans:400,400i,700"><link rel=stylesheet href=/css/style.css><link rel="shortcut icon" href=/favicon.ico></head><body class=body><div class="container container--outer"><header class=header><div class="container header__container"><div class=logo><a class=logo__link href=/ title="Linux.cn Archive" rel=home><div class="logo__item logo__text"><div class=logo__title>Linux.cn Archive</div></div></a></div><nav class=menu><button class=menu__btn aria-haspopup=true aria-expanded=false tabindex=0>
<span class=menu__btn-title tabindex=-1>Menu</span></button><ul class=menu__list><li class=menu__item><a class=menu__link href=/><span class=menu__text>Home</span></a></li><li class=menu__item><a class=menu__link href=/categories/><span class=menu__text>Categories</span></a></li><li class=menu__item><a class=menu__link href=/tags/><span class=menu__text>Tags</span></a></li><li class=menu__item><a class=menu__link href><span class=menu__text>RSS</span></a></li></ul></nav></div></header><div class="wrapper flex"><div class=primary><main class=main role=main><article class=post><header class=post__header><h1 class=post__title>如何在 Debian 中配置 Tripewire IDS</h1><div class="post__meta meta"><div class="meta__item-datetime meta__item"><svg class="meta__icon icon icon-time" width="16" height="14" viewBox="0 0 30 28"><path d="M15 0C7 0 1 6 1 14s6 14 14 14 14-6 14-14S23 0 15 0zm0 25C9 25 4 20 4 14S9 3 15 3s11 5 11 11-5 11-11 11zm1-18h-2v8.4l6.8 4.4L22 18l-6-3.8V7z"/></svg><time class=meta__text datetime=2016-04-03T10:41:29Z>April 03, 2016</time></div></div></header><div class="content post__content clearfix"><p>本文是一篇关于 Debian 中安装和配置 tripewire 的文章。它是 Linux 环境下基于主机的入侵检测系统（IDS）。tripwire 的高级功能可以检测并报告任何 Linux 中未授权的（文件和目录）的更改。tripewire 安装之后，会先创建一个基本的数据库，tripewire 监控并检测新文件的创建修改和谁修改了它等等。如果修改是合法的，你可以接受修改并更新 tripwire 的数据库。</p><p><img src=https://img.linux.net.cn/data/attachment/album/201604/03/104130pcgghcphbab1h8dt.jpg alt></p><h3 id=安装和配置>安装和配置</h3><p>tripwire 在 Debian VM 中的安装如下。</p><pre tabindex=0><code># apt-get install tripwire
</code></pre><p><img src=https://img.linux.net.cn/data/attachment/album/201604/03/104134dleanyyn1d412d2n.png alt=installation></p><p>安装中，tripwire 会有下面的配置提示。</p><h4 id=站点密钥创建>站点密钥创建</h4><p>tripwire 需要一个站点口令（site passphrase）来加密 tripwire 的配置文件 tw.cfg 和策略文件 tw.pol。tripewire 使用指定的密码加密两个文件。一个 tripewire 实例必须指定站点口令。</p><p><img src=https://img.linux.net.cn/data/attachment/album/201604/03/104134johmrbx1xgh11gkg.png alt="site key1"></p><h4 id=本地密钥口令>本地密钥口令</h4><p>本地口令用来保护 tripwire 数据库和报告文件。本地密钥用于阻止非授权的 tripewire 数据库修改。</p><p><img src=https://img.linux.net.cn/data/attachment/album/201604/03/104135cf0gt0vaxptabfgx.png alt="local key1"></p><h4 id=tripwire-配置路径>tripwire 配置路径</h4><p>tripewire 配置存储在 /etc/tripwire/twcfg.txt。它用于生成加密的配置文件 tw.cfg。</p><p><img src=https://img.linux.net.cn/data/attachment/album/201604/03/104136f499o66z80t9ylcr.png alt="configuration file"></p><p><strong>tripwire 策略路径</strong></p><p>tripwire 在 /etc/tripwire/twpol.txt 中保存策略文件。它用于生成加密的策略文件 tw.pol。</p><p><img src=https://img.linux.net.cn/data/attachment/album/201604/03/104137krtemgexmvexo4ra.png alt="tripwire policy"></p><p>安装完成后如下图所示。</p><p><img src=https://img.linux.net.cn/data/attachment/album/201604/03/104137ny981ax2c1s181dy.png alt="installed tripewire1"></p><h4 id=tripwire-配置文件-twcfgtxt>tripwire 配置文件 (twcfg.txt)</h4><p>tripewire 配置文件（twcfg.txt）细节如下图所示。加密策略文件（tw.pol）、站点密钥（site.key）和本地密钥（hostname-local.key）在后面展示。</p><pre tabindex=0><code>ROOT         =/usr/sbin

POLFILE       =/etc/tripwire/tw.pol

DBFILE       =/var/lib/tripwire/$(HOSTNAME).twd

REPORTFILE   =/var/lib/tripwire/report/$(HOSTNAME)-$(DATE).twr

SITEKEYFILE   =/etc/tripwire/site.key

LOCALKEYFILE =/etc/tripwire/$(HOSTNAME)-local.key

EDITOR       =/usr/bin/editor

LATEPROMPTING =false

LOOSEDIRECTORYCHECKING =false

MAILNOVIOLATIONS =true

EMAILREPORTLEVEL =3

REPORTLEVEL   =3

SYSLOGREPORTING =true

MAILMETHOD   =SMTP

SMTPHOST     =localhost

SMTPPORT     =25

TEMPDIRECTORY =/tmp
</code></pre><h4 id=tripwire-策略配置>tripwire 策略配置</h4><p>在生成基础数据库之前先配置 tripwire 配置。有必要经用一些策略如 /dev、 /proc 、/root/mail 等。详细的 twpol.txt 策略文件如下所示。</p><pre tabindex=0><code>@@section GLOBAL
TWBIN = /usr/sbin;
TWETC = /etc/tripwire;
TWVAR = /var/lib/tripwire;

#
# File System Definitions
#
@@section FS

#
# First, some variables to make configuration easier
#
SEC_CRIT      = $(IgnoreNone)-SHa ; # Critical files that cannot change

SEC_BIN       = $(ReadOnly) ;        # Binaries that should not change

SEC_CONFIG    = $(Dynamic) ;         # Config files that are changed
# infrequently but accessed
# often

SEC_LOG       = $(Growing) ;         # Files that grow, but that
# should never change ownership

SEC_INVARIANT = +tpug ;              # Directories that should never
# change permission or ownership

SIG_LOW       = 33 ;                 # Non-critical files that are of
# minimal security impact

SIG_MED       = 66 ;                 # Non-critical files that are of
# significant security impact

SIG_HI        = 100 ;                # Critical files that are
# significant points of
# vulnerability

#
# tripwire Binaries
#
(
rulename = &#34;tripwire Binaries&#34;,
severity = $(SIG_HI)
)
{
$(TWBIN)/siggen            -&gt; $(SEC_BIN) ;
$(TWBIN)/tripwire        -&gt; $(SEC_BIN) ;
$(TWBIN)/twadmin        -&gt; $(SEC_BIN) ;
$(TWBIN)/twprint        -&gt; $(SEC_BIN) ;
}
{
/boot            -&gt; $(SEC_CRIT) ;
/lib/modules        -&gt; $(SEC_CRIT) ;
}

(
rulename = &#34;Boot Scripts&#34;,
severity = $(SIG_HI)
)
{
/etc/init.d        -&gt; $(SEC_BIN) ;
#/etc/rc.boot        -&gt; $(SEC_BIN) ;
/etc/rcS.d        -&gt; $(SEC_BIN) ;
/etc/rc0.d        -&gt; $(SEC_BIN) ;
/etc/rc1.d        -&gt; $(SEC_BIN) ;
/etc/rc2.d        -&gt; $(SEC_BIN) ;
/etc/rc3.d        -&gt; $(SEC_BIN) ;
/etc/rc4.d        -&gt; $(SEC_BIN) ;
/etc/rc5.d        -&gt; $(SEC_BIN) ;
/etc/rc6.d        -&gt; $(SEC_BIN) ;
}

(
rulename = &#34;Root file-system executables&#34;,
severity = $(SIG_HI)
)
{
/bin            -&gt; $(SEC_BIN) ;
/sbin            -&gt; $(SEC_BIN) ;
}

#
# Critical Libraries
#
(
rulename = &#34;Root file-system libraries&#34;,
severity = $(SIG_HI)
)
{
/lib            -&gt; $(SEC_BIN) ;
}

#
# Login and Privilege Raising Programs
#
(
rulename = &#34;Security Control&#34;,
severity = $(SIG_MED)
)
{
/etc/passwd        -&gt; $(SEC_CONFIG) ;
/etc/shadow        -&gt; $(SEC_CONFIG) ;
}
{
#/var/lock        -&gt; $(SEC_CONFIG) ;
#/var/run        -&gt; $(SEC_CONFIG) ; # daemon PIDs
/var/log        -&gt; $(SEC_CONFIG) ;
}

# These files change the behavior of the root account
(
rulename = &#34;Root config files&#34;,
severity = 100
)
{
/root                -&gt; $(SEC_CRIT) ; # Catch all additions to /root
#/root/mail            -&gt; $(SEC_CONFIG) ;
#/root/Mail            -&gt; $(SEC_CONFIG) ;
/root/.xsession-errors        -&gt; $(SEC_CONFIG) ;
#/root/.xauth            -&gt; $(SEC_CONFIG) ;
#/root/.tcshrc            -&gt; $(SEC_CONFIG) ;
#/root/.sawfish            -&gt; $(SEC_CONFIG) ;
#/root/.pinerc            -&gt; $(SEC_CONFIG) ;
#/root/.mc            -&gt; $(SEC_CONFIG) ;
#/root/.gnome_private        -&gt; $(SEC_CONFIG) ;
#/root/.gnome-desktop        -&gt; $(SEC_CONFIG) ;
#/root/.gnome            -&gt; $(SEC_CONFIG) ;
#/root/.esd_auth            -&gt; $(SEC_CONFIG) ;
#    /root/.elm            -&gt; $(SEC_CONFIG) ;
#/root/.cshrc                -&gt; $(SEC_CONFIG) ;
#/root/.bashrc            -&gt; $(SEC_CONFIG) ;
#/root/.bash_profile        -&gt; $(SEC_CONFIG) ;
#    /root/.bash_logout        -&gt; $(SEC_CONFIG) ;
#/root/.bash_history        -&gt; $(SEC_CONFIG) ;
#/root/.amandahosts        -&gt; $(SEC_CONFIG) ;
#/root/.addressbook.lu        -&gt; $(SEC_CONFIG) ;
#/root/.addressbook        -&gt; $(SEC_CONFIG) ;
#/root/.Xresources        -&gt; $(SEC_CONFIG) ;
#/root/.Xauthority        -&gt; $(SEC_CONFIG) -i ; # Changes Inode number on login
/root/.ICEauthority            -&gt; $(SEC_CONFIG) ;
}

#
# Critical devices
#
(
rulename = &#34;Devices &amp; Kernel information&#34;,
severity = $(SIG_HI),
)
{
#/dev        -&gt; $(Device) ;
#/proc        -&gt; $(Device) ;
}
</code></pre><h4 id=tripwire-报告>tripwire 报告</h4><p><strong>tripwire-check</strong> 命令检查 twpol.txt 文件并基于此文件生成 tripwire 报告如下。如果 twpol.txt 中有任何错误，tripwire 不会生成报告。</p><p><img src=https://img.linux.net.cn/data/attachment/album/201604/03/104138flllxa2az2vls2zv.png alt="tripwire report"></p><p><strong>文本形式报告</strong></p><pre tabindex=0><code>root@VMdebian:/home/labadmin# tripwire --check

Parsing policy file: /etc/tripwire/tw.pol

*** Processing Unix File System ***

Performing integrity check...

Wrote report file: /var/lib/tripwire/report/VMdebian-20151024-122322.twr

Open Source tripwire(R) 2.4.2.2 Integrity Check Report

Report generated by:         root

Report created on:           Sat Oct 24 12:23:22 2015

Database last updated on:     Never

Report Summary:

=========================================================

Host name:                   VMdebian

Host IP address:             127.0.1.1

Host ID:                     None

Policy file used:             /etc/tripwire/tw.pol

Configuration file used:     /etc/tripwire/tw.cfg

Database file used:           /var/lib/tripwire/VMdebian.twd

Command line used:           tripwire --check

=========================================================

Rule Summary:

=========================================================

-------------------------------------------------------------------------------

Section: Unix File System

-------------------------------------------------------------------------------

Rule Name                       Severity Level   Added   Removed Modified

---------                       --------------   -----   ------- --------

Other binaries                 66               0       0       0      

tripwire Binaries               100               0       0       0      

Other libraries                 66               0       0       0      

Root file-system executables   100               0       0       0      

tripwire Data Files             100               0       0       0      

System boot changes             100               0       0       0      

(/var/log)

Root file-system libraries     100               0       0       0      

(/lib)

Critical system boot files     100               0       0       0      

Other configuration files       66               0       0       0      

(/etc)

Boot Scripts                   100               0       0       0      

Security Control               66               0       0       0      

Root config files               100               0       0       0      

Invariant Directories           66               0       0       0      

Total objects scanned: 25943

Total violations found: 0

=========================Object Summary:================================

-------------------------------------------------------------------------------

# Section: Unix File System

-------------------------------------------------------------------------------

No violations.

===========================Error Report:=====================================

No Errors

-------------------------------------------------------------------------------

*** End of report ***

Open Source tripwire 2.4 Portions copyright 2000 tripwire, Inc. tripwire is a registered

trademark of tripwire, Inc. This software comes with ABSOLUTELY NO WARRANTY;

for details use --version. This is free software which may be redistributed

or modified only under certain conditions; see COPYING for details.

All rights reserved.

Integrity check complete.
</code></pre><h3 id=总结>总结</h3><p>本篇中，我们学习安装配置开源入侵检测软件 tripwire。首先生成基础数据库并通过比较检测出任何改动（文件/文件夹）。然而，tripwire 并不是实时监测的 IDS。</p><hr><p>via: <a href=http://linoxide.com/security/configure-tripwire-ids-debian/>http://linoxide.com/security/configure-tripwire-ids-debian/</a></p><p>作者：<a href=http://linoxide.com/author/naveeda/>nido</a> 译者：<a href=https://github.com/geekpi>geekpi</a> 校对：<a href=https://github.com/wxy>wxy</a></p><p>本文由 <a href=https://github.com/LCTT/TranslateProject>LCTT</a> 原创编译，<a href=https://linux.cn/>Linux中国</a> 荣誉推出</p></div><footer class=post__footer><div class="post__tags tags clearfix"><svg class="tags__badge icon icon-tag" width="16" height="16" viewBox="0 0 32 32"><path d="M32 19c0 1-1 2-1 2L21 31s-1 1-2 1-2-1-2-1L2 16c-1-1-1.4-2-1.4-2S0 12.5.0 11V3C0 1.5.8.8.8.8S1.5.0 3 0h8c1.5.0 3 .6 3 .6S15 1 16 2l15 15s1 1 1 2zM7 10a3 3 0 100-6 3 3 0 000 6z"/></svg><ul class=tags__list><li class=tags__item><a class="tags__link btn" href=/tags/tripewire/ rel=tag>Tripewire</a></li></ul></div></footer></article></main></div></div><footer class=footer><div class="container footer__container flex"><div class=footer__copyright>&copy; 2025 Linux.cn Archive.
<span class=footer__copyright-credits>Generated with <a href=https://gohugo.io/ rel="nofollow noopener" target=_blank>Hugo</a> and <a href=https://github.com/Vimux/Mainroad/ rel="nofollow noopener" target=_blank>Mainroad</a> theme.</span></div></div></footer></div><script async defer src=/js/menu.js></script></body></html>