<!doctype html><html class=no-js lang=en><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><title>Python 版的 Nmon 分析器：让你远离 excel 宏 - Linux.cn Archive</title>
<script>(function(e,t){e[t]=e[t].replace("no-js","js")})(document.documentElement,"className")</script><meta name=description content><meta property="og:title" content="Python 版的 Nmon 分析器：让你远离 excel 宏"><meta property="og:description" content="nmon 输出的文件很难直接由电子表格应用来处理，因此诞生了 Nmon_Analyzer excel 宏。这个过程很死板而且有点麻烦。现在出现了一个更灵活的工具，我向你们介绍一下 pyNmonAnalyzer。"><meta property="og:type" content="article"><meta property="og:url" content="/article-9294-1.html"><meta property="article:section" content="posts"><meta property="article:published_time" content="2018-01-30T12:12:00+00:00"><meta property="article:modified_time" content="2018-01-30T12:12:00+00:00"><meta itemprop=name content="Python 版的 Nmon 分析器：让你远离 excel 宏"><meta itemprop=description content="nmon 输出的文件很难直接由电子表格应用来处理，因此诞生了 Nmon_Analyzer excel 宏。这个过程很死板而且有点麻烦。现在出现了一个更灵活的工具，我向你们介绍一下 pyNmonAnalyzer。"><meta itemprop=datePublished content="2018-01-30T12:12:00+00:00"><meta itemprop=dateModified content="2018-01-30T12:12:00+00:00"><meta itemprop=wordCount content="270"><meta itemprop=keywords content="nmon,"><link rel=preconnect href=https://fonts.bunny.net crossorigin><link rel=dns-prefetch href=//fonts.bunny.net><link rel=dns-prefetch href=//fonts.bunny.net><link rel=stylesheet href="https://fonts.bunny.net/css?family=Open+Sans:400,400i,700"><link rel=stylesheet href=/css/style.css><link rel="shortcut icon" href=/favicon.ico></head><body class=body><div class="container container--outer"><header class=header><div class="container header__container"><div class=logo><a class=logo__link href=/ title="Linux.cn Archive" rel=home><div class="logo__item logo__text"><div class=logo__title>Linux.cn Archive</div></div></a></div><nav class=menu><button class=menu__btn aria-haspopup=true aria-expanded=false tabindex=0>
<span class=menu__btn-title tabindex=-1>Menu</span></button><ul class=menu__list><li class=menu__item><a class=menu__link href=/><span class=menu__text>Home</span></a></li><li class=menu__item><a class=menu__link href=/categories/><span class=menu__text>Categories</span></a></li><li class=menu__item><a class=menu__link href=/tags/><span class=menu__text>Tags</span></a></li><li class=menu__item><a class=menu__link href><span class=menu__text>RSS</span></a></li></ul></nav></div></header><div class="wrapper flex"><div class=primary><main class=main role=main><article class=post><header class=post__header><h1 class=post__title>Python 版的 Nmon 分析器：让你远离 excel 宏</h1><div class="post__meta meta"><div class="meta__item-datetime meta__item"><svg class="meta__icon icon icon-time" width="16" height="14" viewBox="0 0 30 28"><path d="M15 0C7 0 1 6 1 14s6 14 14 14 14-6 14-14S23 0 15 0zm0 25C9 25 4 20 4 14S9 3 15 3s11 5 11 11-5 11-11 11zm1-18h-2v8.4l6.8 4.4L22 18l-6-3.8V7z"/></svg><time class=meta__text datetime=2018-01-30T12:12:00Z>January 30, 2018</time></div></div></header><div class="content post__content clearfix"><p><img src=/data/attachment/album/201801/30/121232ke7q2v7f44cj2e3c.png alt="pyNmonAnalyzer Graph output" title="pyNmonAnalyzer Graph output"></p><p><a href=http://nmon.sourceforge.net/>Nigel&rsquo;s monitor</a>，也叫做 “Nmon”，是一个很好的监控、记录和分析 Linux/*nix 系统性能随时间变化的工具。Nmon 最初由 IBM 开发并于 2009 年夏天开源。时至今日 Nmon 已经在所有 Linux 平台和架构上都可用了。它提供了很棒的当前系统统计信息的基于命令行的实时可视化报告，这些统计信息包括 CPU、RAM、网络和磁盘 I/O。然而，Nmon 最棒的特性是可以随着时间的推移记录系统性能快照。</p><p>比如：<code>nmon -f -s 1</code>。</p><p><img src=/data/attachment/album/201801/30/121232vf9yzxc5tco5spai.png alt="nmon CPU and Disk utilization"></p><p>会创建一个日志文件，该日志文件最开头是一些系统的元数据（AAA - BBBV 部分），后面是所监控的系统属性的定时快照，比如 CPU 和内存的使用情况。这个输出的文件很难直接由电子表格应用来处理，因此诞生了 <a href=http://www.ibm.com/developerworks/wikis/display/WikiPtype/nmonanalyser>Nmon_Analyzer</a> excel 宏。如果你用的是 Windows/Mac 并安装了 Microsoft Office，那么这个工具非常不错。如果没有这个环境那也可以使用 Nmon2rrd 工具，这个工具能将日志文件转换 RRD 输入文件，进而生成图形。这个过程很死板而且有点麻烦。现在出现了一个更灵活的工具，我向你们介绍一下 pyNmonAnalyzer，它提供了一个可定制化的解决方案来生成结构化的 CSV 文件和带有用 <a href=http://matplotlib.org/>matplotlib</a> 生成的图片的简单 HTML 报告。</p><h3 id=入门介绍>入门介绍</h3><p>系统需求：</p><p>从名字中就能看出我们需要有 python。此外 pyNmonAnalyzer 还依赖于 matplotlib 和 numpy。若你使用的是 debian 衍生的系统，则你需要先安装这些包：</p><pre tabindex=0><code>$ sudo apt-get install python-numpy python-matplotlib
</code></pre><h4 id=获取-pynmonanalyzer>获取 pyNmonAnalyzer：</h4><p>你可以克隆 git 仓库：</p><pre tabindex=0><code>$ git clone git@github.com:madmaze/pyNmonAnalyzer.git
</code></pre><p>或者，直接从这里下载：<a href=https://github.com/madmaze/pyNmonAnalyzer/blob/master/release/pyNmonAnalyzer-1.0.zip>pyNmonAnalyzer-1.0.zip</a> 。(LCTT 译注：这是个 5 年前的项目但是一直在陆陆续续的进行维护）</p><p>接下来我们需要一个 Nmon 文件，如果没有的话，可以使用发行版中提供的实例或者自己录制一个样本：<code>nmon -F test.nmon -s 1 -c 120</code>，会录制 120 个快照，每秒一个，存储到 test.nmon 文件中。</p><p>让我们来看看基本的帮助信息：</p><pre tabindex=0><code>$ ./pyNmonAnalyzer.py -h
usage: pyNmonAnalyzer.py [-h] [-x] [-d] [-o OUTDIR] [-c] [-b] [-r CONFFNAME]
 input_file

nmonParser converts Nmon monitor files into time-sorted
CSV/Spreadsheets for easier analysis, without the use of the
MS Excel Macro. Also included is an option to build an HTML
report with graphs, which is configured through report.config.

positional arguments:
 input_file Input NMON file

optional arguments:
 -h, --help show this help message and exit
 -x, --overwrite overwrite existing results (Default: False)
 -d, --debug debug? (Default: False)
 -o OUTDIR, --output OUTDIR
 Output dir for CSV (Default: ./data/)
 -c, --csv CSV output? (Default: False)
 -b, --buildReport report output? (Default: False)
 -r CONFFNAME, --reportConfig CONFFNAME
 Report config file, if none exists: we will write the
 default config file out (Default: ./report.config)
</code></pre><p>该工具有两个主要的选项</p><ol><li>将 nmon 文件传唤成一系列独立的 CSV 文件</li><li>使用 matplotlib 生成带图形的 HTML 报告</li></ol><p>下面命令既会生成 CSV 文件，也会生成 HTML 报告：</p><pre tabindex=0><code>$ ./pyNmonAnalyzer.py -c -b test.nmon
</code></pre><p>这会创建一个 <code>./data</code> 目录，其中有一个存放 CSV 文件的目录 (<code>./data/csv/</code>)，一个存放 PNG 图片的目录 (<code>./data/img/</code>) 以及一个 HTML 报告 (<code>./data/report.html</code>)。</p><p>默认情况下，HTML 报告中会用图片展示 CPU、磁盘繁忙程度、内存使用情况和网络传输情况。所有这些都定义在一个不言自明的配置文件中 (<code>report.config</code>)。目前这个工具还不是特别的灵活，因为 CPU 和 MEM 除了 <code>on</code> 和 <code>off</code> 外，无法做其他的配置。不过下一步将会改进作图的方法并允许用户灵活地指定针对哪些数据使用哪种作图方法。</p><p>目前这些报告还十分的枯燥而且只能打印出基本的几种标记图表，不过它的功能还在不断的完善中。目前在开发的是一个向导来让配置调整变得更容易。如果有任何建议，找到任何 bug 或者有任何功能需求，欢迎与我交流。</p><hr><p>via: <a href=https://matthiaslee.com/python-nmon-analyzer-moving-away-from-excel-macros/>https://matthiaslee.com/python-nmon-analyzer-moving-away-from-excel-macros/</a></p><p>作者：<a href=https://matthiaslee.com/>Matthias Lee</a> 译者：<a href=https://github.com/lujun9972>lujun9972</a> 校对：<a href=https://github.com/wxy>wxy</a></p><p>本文由 <a href=https://github.com/LCTT/TranslateProject>LCTT</a> 原创编译，<a href=https://linux.cn/>Linux中国</a> 荣誉推出</p></div><footer class=post__footer><div class="post__tags tags clearfix"><svg class="tags__badge icon icon-tag" width="16" height="16" viewBox="0 0 32 32"><path d="M32 19c0 1-1 2-1 2L21 31s-1 1-2 1-2-1-2-1L2 16c-1-1-1.4-2-1.4-2S0 12.5.0 11V3C0 1.5.8.8.8.8S1.5.0 3 0h8c1.5.0 3 .6 3 .6S15 1 16 2l15 15s1 1 1 2zM7 10a3 3 0 100-6 3 3 0 000 6z"/></svg><ul class=tags__list><li class=tags__item><a class="tags__link btn" href=/tags/nmon/ rel=tag>nmon</a></li></ul></div></footer></article></main></div></div><footer class=footer><div class="container footer__container flex"><div class=footer__copyright>&copy; 2025 Linux.cn Archive.
<span class=footer__copyright-credits>Generated with <a href=https://gohugo.io/ rel="nofollow noopener" target=_blank>Hugo</a> and <a href=https://github.com/Vimux/Mainroad/ rel="nofollow noopener" target=_blank>Mainroad</a> theme.</span></div></div></footer></div><script async defer src=/js/menu.js></script></body></html>