<!doctype html><html class=no-js lang=en><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><title>awk 系列：在 awk 中如何使用流程控制语句 - Linux.cn Archive</title>
<script>(function(e,t){e[t]=e[t].replace("no-js","js")})(document.documentElement,"className")</script><meta name=description content><meta property="og:title" content="awk 系列：在 awk 中如何使用流程控制语句"><meta property="og:description" content="awk 系列的这一部分使应该你明白了一个明确的基于某些条件控制的 awk 命令是如何执行的基本概念。"><meta property="og:type" content="article"><meta property="og:url" content="/article-7723-1.html"><meta property="article:section" content="posts"><meta property="article:published_time" content="2016-08-27T17:31:47+00:00"><meta property="article:modified_time" content="2016-08-27T17:31:47+00:00"><meta itemprop=name content="awk 系列：在 awk 中如何使用流程控制语句"><meta itemprop=description content="awk 系列的这一部分使应该你明白了一个明确的基于某些条件控制的 awk 命令是如何执行的基本概念。"><meta itemprop=datePublished content="2016-08-27T17:31:47+00:00"><meta itemprop=dateModified content="2016-08-27T17:31:47+00:00"><meta itemprop=wordCount content="416"><meta itemprop=keywords content="awk,"><link rel=preconnect href=https://fonts.bunny.net crossorigin><link rel=dns-prefetch href=//fonts.bunny.net><link rel=dns-prefetch href=//fonts.bunny.net><link rel=stylesheet href="https://fonts.bunny.net/css?family=Open+Sans:400,400i,700"><link rel=stylesheet href=/css/style.css><link rel="shortcut icon" href=/favicon.ico></head><body class=body><div class="container container--outer"><header class=header><div class="container header__container"><div class=logo><a class=logo__link href=/ title="Linux.cn Archive" rel=home><div class="logo__item logo__text"><div class=logo__title>Linux.cn Archive</div></div></a></div><nav class=menu><button class=menu__btn aria-haspopup=true aria-expanded=false tabindex=0>
<span class=menu__btn-title tabindex=-1>Menu</span></button><ul class=menu__list><li class=menu__item><a class=menu__link href=/><span class=menu__text>Home</span></a></li><li class=menu__item><a class=menu__link href=/categories/><span class=menu__text>Categories</span></a></li><li class=menu__item><a class=menu__link href=/tags/><span class=menu__text>Tags</span></a></li><li class=menu__item><a class=menu__link href><span class=menu__text>RSS</span></a></li></ul></nav></div></header><div class="wrapper flex"><div class=primary><main class=main role=main><article class=post><header class=post__header><h1 class=post__title>awk 系列：在 awk 中如何使用流程控制语句</h1><div class="post__meta meta"><div class="meta__item-datetime meta__item"><svg class="meta__icon icon icon-time" width="16" height="14" viewBox="0 0 30 28"><path d="M15 0C7 0 1 6 1 14s6 14 14 14 14-6 14-14S23 0 15 0zm0 25C9 25 4 20 4 14S9 3 15 3s11 5 11 11-5 11-11 11zm1-18h-2v8.4l6.8 4.4L22 18l-6-3.8V7z"/></svg><time class=meta__text datetime=2016-08-27T17:31:47Z>August 27, 2016</time></div></div></header><div class="content post__content clearfix"><p>当你回顾所有到目前为止我们已经覆盖的 awk 实例，从 awk 系列的开始，你会注意到各种实例的所有指令是顺序执行的，即一个接一个地执行。但在某些情况下，我们可能希望基于一些条件进行文本过滤操作，即流程控制语句允许的那些语句。</p><p><img src=/data/attachment/album/201608/27/173149uf87ujwhg85z85n7.png alt></p><p>在 awk 编程中有各种各样的流程控制语句，其中包括：</p><ul><li>if-else 语句</li><li>for 语句</li><li>while 语句</li><li>do-while 语句</li><li>break 语句</li><li>continue 语句</li><li>next 语句</li><li>nextfile 语句</li><li>exit 语句</li></ul><p>然而，对于本系列的这一部分，我们将阐述：<code>if-else</code>、<code>for</code>、<code>while</code> 和 <code>do while</code> 语句。请记住，我们已经在这个 <a href=/article-7609-1.html>awk 系列的第 6 部分</a>介绍过如何使用 awk 的 <code>next</code> 语句。</p><h3 id=1-if-else-语句>1. if-else 语句</h3><p>如你想的那样。if 语句的语法类似于 shell 中的 if 语句：</p><pre tabindex=0><code>if  (条件 1) {
     动作 1
}
else {
      动作 2
}
</code></pre><p>在上述语法中，<code>条件 1</code> 和<code>条件 2</code> 是 awk 表达式，而<code>动作 1</code> 和<code>动作 2</code> 是当各自的条件得到满足时所执行的 awk 命令。</p><p>当<code>条件 1</code> 满足时，意味着它为真，那么<code>动作 1</code> 被执行并退出 <code>if 语句</code>，否则<code>动作 2</code> 被执行。</p><p>if 语句还能扩展为如下的 <code>if-else_if-else</code> 语句：</p><pre tabindex=0><code>if (条件 1){
     动作 1
}
else if (条件 2){
      动作 2
}
else{
     动作 3
}
</code></pre><p>对于上面的形式，如果<code>条件 1</code> 为真，那么<code>动作 1</code> 被执行并退出 <code>if 语句</code>，否则<code>条件 2</code> 被求值且如果值为真，那么<code>动作 2</code> 被执行并退出 <code>if 语句</code>。然而，当<code>条件 2</code> 为假时，那么<code>动作 3</code> 被执行并退出 <code>if 语句</code>。</p><p>这是在使用 if 语句的一个实例，我们有一个用户和他们年龄的列表，存储在文件 users.txt 中。</p><p>我们要打印一个清单，显示用户的名称和用户的年龄是否小于或超过 25 岁。</p><pre tabindex=0><code>aaronkilik@tecMint ~ $ cat users.txt
Sarah L         35      F
Aaron Kili      40      M
John  Doo       20      M
Kili  Seth      49      M
</code></pre><p>我们可以写一个简短的 shell 脚本来执行上文中我们的工作，这是脚本的内容：</p><pre tabindex=0><code>#!/bin/bash
awk &#39; {
        if ( $3 &lt;= 25 ){
           print &#34;User&#34;,$1,$2,&#34;is less than 25 years old.&#34; ;
        }
        else {
           print &#34;User&#34;,$1,$2,&#34;is more than 25 years old&#34; ;
        }
}&#39;    ~/users.txt
</code></pre><p>然后保存文件并退出，按如下方式使脚本可执行并运行它：</p><pre tabindex=0><code>$ chmod +x test.sh
$ ./test.sh
</code></pre><p>输出样例</p><pre tabindex=0><code>User Sarah L is more than 25 years old
User Aaron Kili is more than 25 years old
User John Doo is less than 25 years old.
User Kili Seth is more than 25 years old
</code></pre><h3 id=2-for-语句>2. for 语句</h3><p>如果你想在一个循环中执行一些 awk 命令，那么 <code>for 语句</code>为你提供一个做这个的合适方式，格式如下：</p><pre tabindex=0><code>for ( 计数器的初始化 ; 测试条件 ; 计数器增加 ){
      动作
}
</code></pre><p>这里，该方法是通过一个计数器来控制循环执行来定义的，首先你需要初始化这个计数器，然后针对测试条件运行它，如果它为真，执行这些动作并最终增加这个计数器。当计数器不满足条件时，循环终止。</p><p>在我们想要打印数字 0 到 10 时，以下 awk 命令显示 for 语句是如何工作的：</p><pre tabindex=0><code>$ awk &#39;BEGIN{ for(counter=0;counter&lt;=10;counter++){ print counter} }&#39;
</code></pre><p>输出样例</p><pre tabindex=0><code>0
1
2
3
4
5
6
7
8
9
10
</code></pre><h3 id=3-while-语句>3. while 语句</h3><p>while 语句的传统语法如下：</p><pre tabindex=0><code>while ( 条件 ) {
          动作
}
</code></pre><p>这个<code>条件</code>是一个 awk 表达式而<code>动作</code>是当条件为真时被执行的 awk 命令。</p><p>下面是一个说明使用 <code>while</code> 语句来打印数字 0 到 10 的脚本：</p><pre tabindex=0><code>#!/bin/bash
awk &#39; BEGIN{ counter=0;
        while(counter&lt;=10){
              print counter;
              counter+=1;
        }
}&#39;
</code></pre><p>保存文件并使脚本可执行，然后运行它：</p><pre tabindex=0><code>$ chmod +x test.sh
$ ./test.sh
</code></pre><p>输出样例</p><pre tabindex=0><code>0
1
2
3
4
5
6
7
8
9
10
</code></pre><h3 id=4-do-while-语句>4. do while 语句</h3><p>它是上文中 <code>while</code> 语句的一个变型，具有以下语法：</p><pre tabindex=0><code>do {
     动作
}
 while (条件)
</code></pre><p>这轻微的区别在于，在 <code>do while</code> 语句下，awk 的命令在求值条件之前执行。使用上文 <code>while</code> 语句的例子，我们可以通过按如下所述修改 test.sh 脚本中的 awk 命令来说明 <code>do while</code> 语句的用法：</p><pre tabindex=0><code>#!/bin/bash

awk &#39; BEGIN{ counter=0;
        do{
            print counter;
            counter+=1;
        }
        while (counter&lt;=10)
}&#39;
</code></pre><p>修改脚本之后，保存文件并退出。按如下方式使脚本可执行并执行它：</p><pre tabindex=0><code>$ chmod +x test.sh
$ ./test.sh
</code></pre><p>输出样例</p><pre tabindex=0><code>0
1
2
3
4
5
6
7
8
9
10
</code></pre><h3 id=总结>总结</h3><p>这不是关于 awk 的流程控制语句的一个全面的指南，正如我早先提到的，在 awk 里还有其他几个流程控制语句。</p><p>尽管如此，awk 系列的这一部分使应该你明白了一个明确的基于某些条件控制的 awk 命令是如何执行的基本概念。</p><p>你还可以了解其余更多的流程控制语句以获得更多关于该主题的理解。最后，在 awk 的系列下一节，我们将进入编写 awk 脚本。</p><hr><p>via: <a href=http://www.tecmint.com/use-flow-control-statements-with-awk-command/>http://www.tecmint.com/use-flow-control-statements-with-awk-command/</a> 作者：<a href=http://www.tecmint.com/author/aaronkili/>Aaron Kili</a> 译者：<a href=https://github.com/robot527>robot527</a> 校对：<a href=https://github.com/wxy>wxy</a></p><p>本文由 <a href=https://github.com/LCTT/TranslateProject>LCTT</a> 原创编译，<a href=https://linux.cn/>Linux 中国</a> 荣誉推出</p></div><footer class=post__footer><div class="post__tags tags clearfix"><svg class="tags__badge icon icon-tag" width="16" height="16" viewBox="0 0 32 32"><path d="M32 19c0 1-1 2-1 2L21 31s-1 1-2 1-2-1-2-1L2 16c-1-1-1.4-2-1.4-2S0 12.5.0 11V3C0 1.5.8.8.8.8S1.5.0 3 0h8c1.5.0 3 .6 3 .6S15 1 16 2l15 15s1 1 1 2zM7 10a3 3 0 100-6 3 3 0 000 6z"/></svg><ul class=tags__list><li class=tags__item><a class="tags__link btn" href=/tags/awk/ rel=tag>awk</a></li></ul></div></footer></article></main></div></div><footer class=footer><div class="container footer__container flex"><div class=footer__copyright>&copy; 2025 Linux.cn Archive.
<span class=footer__copyright-credits>Generated with <a href=https://gohugo.io/ rel="nofollow noopener" target=_blank>Hugo</a> and <a href=https://github.com/Vimux/Mainroad/ rel="nofollow noopener" target=_blank>Mainroad</a> theme.</span></div></div></footer></div><script async defer src=/js/menu.js></script></body></html>