<!doctype html><html class=no-js lang=en><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><title>使用 Vagrant 在不同的操作系统上测试你的脚本 - Linux.cn Archive</title>
<script>(function(e,t){e[t]=e[t].replace("no-js","js")})(document.documentElement,"className")</script><meta name=description content><meta property="og:title" content="使用 Vagrant 在不同的操作系统上测试你的脚本"><meta property="og:description" content="Vagrant 可以帮助你在你的电脑上运行其他操作系统，这意味着你可以构建、测试、疯狂折腾而不毁坏你的系统。"><meta property="og:type" content="article"><meta property="og:url" content="/article-13829-1.html"><meta property="article:section" content="posts"><meta property="article:published_time" content="2021-09-28T11:58:35+00:00"><meta property="article:modified_time" content="2021-09-28T11:58:35+00:00"><meta itemprop=name content="使用 Vagrant 在不同的操作系统上测试你的脚本"><meta itemprop=description content="Vagrant 可以帮助你在你的电脑上运行其他操作系统，这意味着你可以构建、测试、疯狂折腾而不毁坏你的系统。"><meta itemprop=datePublished content="2021-09-28T11:58:35+00:00"><meta itemprop=dateModified content="2021-09-28T11:58:35+00:00"><meta itemprop=wordCount content="387"><meta itemprop=keywords content="Vagrant,虚拟机,"><link rel=preconnect href=https://fonts.bunny.net crossorigin><link rel=dns-prefetch href=//fonts.bunny.net><link rel=dns-prefetch href=//fonts.bunny.net><link rel=stylesheet href="https://fonts.bunny.net/css?family=Open+Sans:400,400i,700"><link rel=stylesheet href=/css/style.css><link rel="shortcut icon" href=/favicon.ico></head><body class=body><div class="container container--outer"><header class=header><div class="container header__container"><div class=logo><a class=logo__link href=/ title="Linux.cn Archive" rel=home><div class="logo__item logo__text"><div class=logo__title>Linux.cn Archive</div></div></a></div><nav class=menu><button class=menu__btn aria-haspopup=true aria-expanded=false tabindex=0>
<span class=menu__btn-title tabindex=-1>Menu</span></button><ul class=menu__list><li class=menu__item><a class=menu__link href=/><span class=menu__text>Home</span></a></li><li class=menu__item><a class=menu__link href=/categories/><span class=menu__text>Categories</span></a></li><li class=menu__item><a class=menu__link href=/tags/><span class=menu__text>Tags</span></a></li><li class=menu__item><a class=menu__link href><span class=menu__text>RSS</span></a></li></ul></nav></div></header><div class="wrapper flex"><div class=primary><main class=main role=main><article class=post><header class=post__header><h1 class=post__title>使用 Vagrant 在不同的操作系统上测试你的脚本</h1><div class="post__meta meta"><div class="meta__item-datetime meta__item"><svg class="meta__icon icon icon-time" width="16" height="14" viewBox="0 0 30 28"><path d="M15 0C7 0 1 6 1 14s6 14 14 14 14-6 14-14S23 0 15 0zm0 25C9 25 4 20 4 14S9 3 15 3s11 5 11 11-5 11-11 11zm1-18h-2v8.4l6.8 4.4L22 18l-6-3.8V7z"/></svg><time class=meta__text datetime=2021-09-28T11:58:35Z>September 28, 2021</time></div></div></header><div class="content post__content clearfix"><blockquote><p>Vagrant 可以帮助你在你的电脑上运行其他操作系统，这意味着你可以构建、测试、疯狂折腾而不毁坏你的系统。</p></blockquote><p><img src=https://img.linux.net.cn/data/attachment/album/202109/28/115827gv75kkrhnnhvkhcf.jpg alt title="Woman using laptop concentrating"></p><p>我使用 Vagrant 已经很长时间了。我使用几种 DevOps 工具，把它们全安装在一个系统上会搞得很乱。Vagrant 可以让你在不破坏系统的情况下随意折腾，因为你根本不需要在生产系统上做实验。</p><p>如果你熟悉 <a href=https://opensource.com/article/21/6/try-linux-virtualbox>VirtualBox</a> 或 <a href=https://opensource.com/article/19/5/getting-started-gnome-boxes-virtualization>GNOME Boxes</a>，那么学习 Vagrant 很容易。Vagrant 有一个简单而干净的界面用于管理虚拟机。一个名为 <code>Vagrantfile</code> 的配置文件，允许你定制你的虚拟机（称为 “Vagrant 盒子 box ”）。一个简单的命令行界面让你启动、停止、暂停或销毁你的“盒子”。</p><p>考虑一下这个简单的例子。</p><p>假设你想写 Ansible 或 shell 脚本，在一个新的服务器上安装 Nginx。你不能在你自己的系统上这样做，因为你运行的可能不是你想测试的操作系统，或者没有所有的依赖项。启动新的云服务器进行测试可能会很费时和昂贵。这就是 Vagrant 派上用处的地方。你可以用它来启动一个虚拟机，用你的脚本来 配备 provision 它，并证明一切按预期工作。然后，你可以删除这个“盒子”，重新配备它，并重新运行你的脚本来验证它。你可以多次重复这个过程，直到你确信你的脚本在所有条件下都能工作。你可以将你的 Vagrantfile 提交给 Git，以确保你的团队正在测试完全相同的环境（因为他们将使用完全相同的测试机）。不会再有“但它在我的机器上运行良好！”这事了。</p><h3 id=开始使用>开始使用</h3><p>首先，<a href=https://www.vagrantup.com/docs/installation>在你的系统上安装 Vagrant</a>，然后创建一个新的文件夹进行实验。在这个新文件夹中，创建一个名为 <code>Vagrantfile</code> 的新文件，内容如下：</p><pre tabindex=0><code>Vagrant.configure(&#34;2&#34;) do |config|

 config.vm.box = &#34;ubuntu/hirsute64&#34;

end
</code></pre><p>你也可以运行 <code>vagrant init ubuntu/hirsute64</code>，它将为你生成一个新的 Vagrant 文件。现在运行 <code>vagrant up</code>。这个命令将从 Vagrant 仓库中下载 <code>ubuntu/hirsuite64</code> 镜像。</p><pre tabindex=0><code>Bringing machine &#39;default&#39; up with &#39;virtualbox&#39; provider...
==&gt; default: Importing base box &#39;ubuntu/hirsute64&#39;...
==&gt; default: Matching MAC address for NAT networking...
==&gt; default: Checking if box &#39;ubuntu/hirsute64&#39; version &#39;20210820.0.0&#39; is up to date...
==&gt; default: Setting the name of the VM: a_default_1630204214778_76885
==&gt; default: Clearing any previously set network interfaces...
==&gt; default: Preparing network interfaces based on configuration...
    default: Adapter 1: nat
    default: Adapter 2: hostonly
==&gt; default: Forwarding ports...
    default: 22 (guest) =&gt; 2222 (host) (adapter 1)
==&gt; default: Running &#39;pre-boot&#39; VM customizations...
==&gt; default: Booting VM...
==&gt; default: Waiting for machine to boot. This may take a few minutes...
    default: SSH address: 127.0.0.1:2222
    default: SSH username: vagrant
    default: SSH auth method: private key
    default: Warning: Remote connection disconnect. Retrying...
    default: Warning: Connection reset. Retrying...
    default:
    default: Vagrant insecure key detected. Vagrant will automatically replace
    default: this with a newly generated keypair for better security.
    default:
    default: Inserting generated public key within guest...
    default: Removing insecure key from the guest if it&#39;s present...
    default: Key inserted! Disconnecting and reconnecting using new SSH key...
==&gt; default: Machine booted and ready!
</code></pre><p>此时，如果你打开你的 Vagrant 后端（如 VirtualBox 或 virt-manager），你会看到你的“盒子”已经有了。接下来，运行 <code>vagrant ssh</code> 登录到“盒子”。如果你能看到 Vagrant 的提示符，那么你就进入了！</p><pre tabindex=0><code>~ vagrant ssh
Welcome to Ubuntu 21.04 (GNU/Linux 5.11.0-31-generic x86_64)

* Documentation: &lt;https://help.ubuntu.com&gt;
* Management:   &lt;https://landscape.canonical.com&gt;
* Support:    &lt;https://ubuntu.com/advantage&gt;

 System information as of Sun Aug 29 02:33:51 UTC 2021

 System load: 0.01       Processes:        110
 Usage of /:  4.1% of 38.71GB  Users logged in:     0
 Memory usage: 17%        IPv4 address for enp0s3: 10.0.2.15
 Swap usage:  0%        IPv4 address for enp0s8: 192.168.1.20

0 updates can be applied immediately.

vagrant@ubuntu-hirsute:~$
</code></pre><p>Vagrant 使用“基础盒子”来建立你的本地机器。在我们的例子中，Vagrant 从 <a href=https://app.vagrantup.com/boxes/search>Hashicorp 的 Vagrant 目录</a>下载 <code>ubuntu/hirsuite64</code> 镜像，并插入 VirtualBox 来创建实际的“盒子”。</p><h3 id=共享文件夹>共享文件夹</h3><p>Vagrant 将你的当前文件夹映射到 Vagrant “盒子”中的 <code>/vagrant</code>。这允许你在你的系统和“盒子”里保持文件同步。这很适合测试 Nginx 网站，通过将你的文件根目录指向 <code>/vagrant</code>。你可以使用 IDE 进行修改，“盒子”里的 Nginx 会提供这些修改。</p><h3 id=vagrant-命令>Vagrant 命令</h3><p>有几个 Vagrant 命令，你可以用它们来控制你的“盒子”。</p><p>其中一些重要的命令是：</p><ul><li><code>vagrant up</code>：启动一个“盒子”。</li><li><code>vagrant status</code>：显示当前“盒子”的状态。</li><li><code>vagrant suspend</code>：暂停当前的“盒子”。</li><li><code>vagrant resume</code>：恢复当前的“盒子”。</li><li><code>vagrant halt</code>：关闭当前的“盒子”。</li><li><code>vagrant destroy</code>：销毁当前的“盒子”。通过运行此命令，你将失去存储在“盒子”上的任何数据。</li><li><code>vagrant snapshot</code>：对当前的“盒子”进行快照。</li></ul><h3 id=试试-vagrant>试试 Vagrant</h3><p>Vagrant 是一个使用 DevOps 原则进行虚拟机管理的工具，久经时间考验。配置你的测试机，与你的团队分享配置，并在一个可预测和可重复的环境中测试你的项目。如果你正在开发软件，那么通过使用 Vagrant 进行测试，你将为你的用户提供良好的服务。如果你不开发软件，但你喜欢尝试新版本的操作系统，那么没有比这更简单的方法了。今天就试试 Vagrant 吧！</p><p>这篇文章最初发表在 <a href=https://notes.ayushsharma.in/2021/08/introduction-to-vagrant>作者的个人博客</a> 上，经许可后被改编。</p><hr><p>via: <a href=https://opensource.com/article/21/9/test-vagrant>https://opensource.com/article/21/9/test-vagrant</a></p><p>作者：<a href=https://opensource.com/users/ayushsharma>Ayush Sharma</a> 选题：<a href=https://github.com/lujun9972>lujun9972</a> 译者：<a href=https://github.com/geekpi>geekpi</a> 校对：<a href=https://github.com/wxy>wxy</a></p><p>本文由 <a href=https://github.com/LCTT/TranslateProject>LCTT</a> 原创编译，<a href=https://linux.cn/>Linux中国</a> 荣誉推出</p></div><footer class=post__footer><div class="post__tags tags clearfix"><svg class="tags__badge icon icon-tag" width="16" height="16" viewBox="0 0 32 32"><path d="M32 19c0 1-1 2-1 2L21 31s-1 1-2 1-2-1-2-1L2 16c-1-1-1.4-2-1.4-2S0 12.5.0 11V3C0 1.5.8.8.8.8S1.5.0 3 0h8c1.5.0 3 .6 3 .6S15 1 16 2l15 15s1 1 1 2zM7 10a3 3 0 100-6 3 3 0 000 6z"/></svg><ul class=tags__list><li class=tags__item><a class="tags__link btn" href=/tags/vagrant/ rel=tag>Vagrant</a></li><li class=tags__item><a class="tags__link btn" href=/tags/%E8%99%9A%E6%8B%9F%E6%9C%BA/ rel=tag>虚拟机</a></li></ul></div></footer></article></main></div></div><footer class=footer><div class="container footer__container flex"><div class=footer__copyright>&copy; 2025 Linux.cn Archive.
<span class=footer__copyright-credits>Generated with <a href=https://gohugo.io/ rel="nofollow noopener" target=_blank>Hugo</a> and <a href=https://github.com/Vimux/Mainroad/ rel="nofollow noopener" target=_blank>Mainroad</a> theme.</span></div></div></footer></div><script async defer src=/js/menu.js></script></body></html>