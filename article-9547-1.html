<!doctype html><html class=no-js lang=en><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><title>Google Kubernetes Engine（GKE）使用初探 - Linux.cn Archive</title>
<script>(function(e,t){e[t]=e[t].replace("no-js","js")})(document.documentElement,"className")</script><meta name=description content><meta property="og:title" content="Google Kubernetes Engine（GKE）使用初探"><meta property="og:description" content="本文只是一个入门指南，主要指导能快速开始上手基于 Google Cloud Platform 的 GKE 服务（k8s 托管服务）。"><meta property="og:type" content="article"><meta property="og:url" content="/article-9547-1.html"><meta property="article:section" content="posts"><meta property="article:published_time" content="2018-04-15T09:52:00+00:00"><meta property="article:modified_time" content="2018-04-15T09:52:00+00:00"><meta itemprop=name content="Google Kubernetes Engine（GKE）使用初探"><meta itemprop=description content="本文只是一个入门指南，主要指导能快速开始上手基于 Google Cloud Platform 的 GKE 服务（k8s 托管服务）。"><meta itemprop=datePublished content="2018-04-15T09:52:00+00:00"><meta itemprop=dateModified content="2018-04-15T09:52:00+00:00"><meta itemprop=wordCount content="271"><meta itemprop=keywords content="容器,GKE,k8s,"><link rel=preconnect href=https://fonts.bunny.net crossorigin><link rel=dns-prefetch href=//fonts.bunny.net><link rel=dns-prefetch href=//fonts.bunny.net><link rel=stylesheet href="https://fonts.bunny.net/css?family=Open+Sans:400,400i,700"><link rel=stylesheet href=/css/style.css><link rel="shortcut icon" href=/favicon.ico></head><body class=body><div class="container container--outer"><header class=header><div class="container header__container"><div class=logo><a class=logo__link href=/ title="Linux.cn Archive" rel=home><div class="logo__item logo__text"><div class=logo__title>Linux.cn Archive</div></div></a></div><nav class=menu><button class=menu__btn aria-haspopup=true aria-expanded=false tabindex=0>
<span class=menu__btn-title tabindex=-1>Menu</span></button><ul class=menu__list><li class=menu__item><a class=menu__link href=/><span class=menu__text>Home</span></a></li><li class=menu__item><a class=menu__link href=/categories/><span class=menu__text>Categories</span></a></li><li class=menu__item><a class=menu__link href=/tags/><span class=menu__text>Tags</span></a></li><li class=menu__item><a class=menu__link href><span class=menu__text>RSS</span></a></li></ul></nav></div></header><div class="wrapper flex"><div class=primary><main class=main role=main><article class=post><header class=post__header><h1 class=post__title>Google Kubernetes Engine（GKE）使用初探</h1><div class="post__meta meta"><div class="meta__item-datetime meta__item"><svg class="meta__icon icon icon-time" width="16" height="14" viewBox="0 0 30 28"><path d="M15 0C7 0 1 6 1 14s6 14 14 14 14-6 14-14S23 0 15 0zm0 25C9 25 4 20 4 14S9 3 15 3s11 5 11 11-5 11-11 11zm1-18h-2v8.4l6.8 4.4L22 18l-6-3.8V7z"/></svg><time class=meta__text datetime=2018-04-15T09:52:00Z>April 15, 2018</time></div></div></header><div class="content post__content clearfix"><p><img src=/data/attachment/album/201804/15/095240l1oiz1oo1t14vjig.jpg alt></p><h3 id=概述>概述</h3><p>Google 的 k8s 在 2017 年已经从容器编排领域的竞争中取得主导地位，从 <a href=https://www.docker.com/>Docker</a> 之前的一度排挤到最终完全拥抱 k8s，显然 k8s 已经成了目前业界的标准。</p><p>但是到目前为止能提供 k8s 完全托管服务的云服务商少之又少，即便是目前在云提供商有统治力的 AWS 也没有完全提供 k8s 托管服务，仅仅提供有限的定制服务，在这一方面并不成熟。</p><p>然而 Google 的 k8s 托管服务，即 GKE，却将 k8s 托管服务做到了极致（至少目前看来），不仅提供了全套的 k8s 托管服务，更引人注目的是 Google 已然将 Autoscaler 和 k8s 集成，实现了 k8s 节点的自动伸缩机制，能根据 pod 的需求自动化添加或删除节点，当现有节点无法承载新的服务时会自动添加节点来满足需求，当现有节点足够空闲时会启用调节机制自动化收缩节点，从某种意义上来说这几乎做到了无服务器的理念。</p><p>然而这也许只是冰山一角，更多强大的功能还需要进一步探索，本文只是一个入门指南，主要指导能快速开始上手基于 Google Cloud Platform 的 <a href="https://cloud.google.com/kubernetes-engine/?hl=zh-cn">GKE</a> 服务（k8s 托管服务）。</p><h3 id=gke-入门指南>GKE 入门指南</h3><p>接下来我们一步步指引如何使用 GKE 来部署服务，前提是对 k8s 有所了解，能简单使用 kubectl 命令。</p><h4 id=1-安装并配置-google-cloud-sdk>1. 安装并配置 Google Cloud SDK</h4><p>Google Cloud SDK 是 访问 GCP（Google Cloud Platform）平台各种资源的命令行工具集，类似 aws 的 aws 命令行工具。</p><p>安装和配置就不多说了，点击下面链接选择相应操作系统版本的 tar 包下载，然后解压，在 PATH 环境变量中添加 <code>google-cloud-sdk/bin</code> 即可：</p><p><a href="https://cloud.google.com/sdk/?hl=zh-cn">https://cloud.google.com/sdk/?hl=zh-cn</a></p><h4 id=2-初始化-google-cloud-sdk>2. 初始化 Google Cloud SDK</h4><p>初始化 Google Cloud SDK 是将 <code>gcloud</code> 命令和 Google 账号绑定起来并设置一些其他的默认值，比如区域，代理，账号，项目（Google 账号中新建的项目）之类的。</p><p>在执行 <code>gcloud init</code> 初始化之前得先给 <code>gcloud</code> 配置 HTTP 代理（GFW 你懂得），具体配置见我之前<a href=https://blog.csdn.net/qianghaohao/article/details/79942485>这篇文章</a>。然后执行 <code>gcloud init</code> 完成初始化，直接根据向导来即可。</p><h4 id=3-到-google-cloud-platform-控制台建一个-k8s-集群记住名称>3. 到 Google Cloud Platform 控制台建一个 k8s 集群，记住名称</h4><p><img src=/data/attachment/album/201804/15/095255zryhrknfhfjqu5fd.png alt></p><h4 id=4-安装-gcloud-kubectl-组件>4. 安装 gcloud kubectl 组件</h4><pre tabindex=0><code>gcloud components install kubectl 
</code></pre><h4 id=5-获取群集的身份验证凭据>5. 获取群集的身份验证凭据</h4><p>创建群集后，您需要获取身份验证凭据以与群集进行交互。要为集群进行身份验证，请运行以下命令：</p><pre tabindex=0><code>gcloud container clusters get-credentials &lt;上一步创建的集群名称&gt; 
</code></pre><h4 id=6-接下来部署一个简单的-hello-server-服务到-gke>6. 接下来部署一个简单的 hello-server 服务到 GKE</h4><pre tabindex=0><code>kubectl run hello-server --image gcr.io/google-samples/hello-app:1.0 --port 8080
</code></pre><h3 id=相关链接>相关链接</h3><ul><li><a href=https://cloud.google.com/kubernetes-engine/docs/quickstart>https://cloud.google.com/kubernetes-engine/docs/quickstart</a></li><li><a href="https://cloud.google.com/sdk/docs/quickstart-macos?hl=zh-cn">https://cloud.google.com/sdk/docs/quickstart-macos?hl=zh-cn</a></li></ul><h3 id=附录>附录</h3><h4 id=gloud-常用命令>gloud 常用命令</h4><pre tabindex=0><code>gcloud auth login --no-launch-browser # gcloud 登录认证
gcloud config set compute/zone [COMPUTE_ZONE] # 设置默认区域
gcloud components list # 列出可安装组件
gcloud components install [组件名称] # 安装组件
gcloud components update  # 更新所有已安装组件
gcloud components remove [组件名称] # 卸载已安装组件
</code></pre><h4 id=设置-gcloud-http-代理>设置 gcloud http 代理</h4><pre tabindex=0><code>gcloud config set proxy/type http
gcloud config set proxy/address 127.0.0.1
gcloud config set proxy/port 1087
</code></pre><h4 id=设置集群-docker-私服认证>设置集群 docker 私服认证</h4><pre tabindex=0><code>kubectl create secret docker-registry regcred --docker-server=&lt;your-registry-server&gt; --docker-username=&lt;your-name&gt; --docker-password=&lt;your-pword&gt; --docker-email=&lt;your-email&gt;
</code></pre><p><strong>注意</strong>：设置 docker 私服后，要在 GKE 部署 k8s 服务，必须得在 k8s 资源文件（yaml 格式）中的 container<br>同一级指定 imagePullSecrets 键，要不然仍然无法拉取配置的私服的镜像，示例资源文件如下：</p><pre tabindex=0><code>apiVersion: v1
kind: Pod
metadata:
  name: private-reg
spec:
  containers:
  - name: private-reg-container
    image: &lt;your-private-image&gt;
  imagePullSecrets:
  - name: regcred
</code></pre><h4 id=查看集群-docker-私服配置>查看集群 docker 私服配置</h4><pre tabindex=0><code>kubectl get secret regcred --output=yaml      #base64 格式 显示
kubectl get secret regcred --output=&#34;jsonpath={.data.\.dockerconfigjson}&#34; | base64 -d # base64
</code></pre></div><footer class=post__footer><div class="post__tags tags clearfix"><svg class="tags__badge icon icon-tag" width="16" height="16" viewBox="0 0 32 32"><path d="M32 19c0 1-1 2-1 2L21 31s-1 1-2 1-2-1-2-1L2 16c-1-1-1.4-2-1.4-2S0 12.5.0 11V3C0 1.5.8.8.8.8S1.5.0 3 0h8c1.5.0 3 .6 3 .6S15 1 16 2l15 15s1 1 1 2zM7 10a3 3 0 100-6 3 3 0 000 6z"/></svg><ul class=tags__list><li class=tags__item><a class="tags__link btn" href=/tags/%E5%AE%B9%E5%99%A8/ rel=tag>容器</a></li><li class=tags__item><a class="tags__link btn" href=/tags/gke/ rel=tag>GKE</a></li><li class=tags__item><a class="tags__link btn" href=/tags/k8s/ rel=tag>k8s</a></li></ul></div></footer></article></main></div></div><footer class=footer><div class="container footer__container flex"><div class=footer__copyright>&copy; 2025 Linux.cn Archive.
<span class=footer__copyright-credits>Generated with <a href=https://gohugo.io/ rel="nofollow noopener" target=_blank>Hugo</a> and <a href=https://github.com/Vimux/Mainroad/ rel="nofollow noopener" target=_blank>Mainroad</a> theme.</span></div></div></footer></div><script async defer src=/js/menu.js></script></body></html>