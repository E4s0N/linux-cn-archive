<!doctype html><html class=no-js lang=en><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><title>如何在 Ubuntu 安装 Go 语言编写的 Git 服务器 Gogs - Linux.cn Archive</title>
<script>(function(e,t){e[t]=e[t].replace("no-js","js")})(document.documentElement,"className")</script><meta name=description content><meta property="og:title" content="如何在 Ubuntu 安装 Go 语言编写的 Git 服务器 Gogs"><meta property="og:description" content="Gogs 的网页界面和 GitHub 十分相近，且提供 MySQL、PostgreSQL 和 SQLite 数据库支持。"><meta property="og:type" content="article"><meta property="og:url" content="/article-9391-1.html"><meta property="article:section" content="posts"><meta property="article:published_time" content="2018-02-27T22:31:57+00:00"><meta property="article:modified_time" content="2018-02-27T22:31:57+00:00"><meta itemprop=name content="如何在 Ubuntu 安装 Go 语言编写的 Git 服务器 Gogs"><meta itemprop=description content="Gogs 的网页界面和 GitHub 十分相近，且提供 MySQL、PostgreSQL 和 SQLite 数据库支持。"><meta itemprop=datePublished content="2018-02-27T22:31:57+00:00"><meta itemprop=dateModified content="2018-02-27T22:31:57+00:00"><meta itemprop=wordCount content="636"><meta itemprop=keywords content="Gogs,Go,Git,"><link rel=preconnect href=https://fonts.bunny.net crossorigin><link rel=dns-prefetch href=//fonts.bunny.net><link rel=dns-prefetch href=//fonts.bunny.net><link rel=stylesheet href="https://fonts.bunny.net/css?family=Open+Sans:400,400i,700"><link rel=stylesheet href=/css/style.css><link rel="shortcut icon" href=/favicon.ico></head><body class=body><div class="container container--outer"><header class=header><div class="container header__container"><div class=logo><a class=logo__link href=/ title="Linux.cn Archive" rel=home><div class="logo__item logo__text"><div class=logo__title>Linux.cn Archive</div></div></a></div><nav class=menu><button class=menu__btn aria-haspopup=true aria-expanded=false tabindex=0>
<span class=menu__btn-title tabindex=-1>Menu</span></button><ul class=menu__list><li class=menu__item><a class=menu__link href=/><span class=menu__text>Home</span></a></li><li class=menu__item><a class=menu__link href=/categories/><span class=menu__text>Categories</span></a></li><li class=menu__item><a class=menu__link href=/tags/><span class=menu__text>Tags</span></a></li><li class=menu__item><a class=menu__link href><span class=menu__text>RSS</span></a></li></ul></nav></div></header><div class="wrapper flex"><div class=primary><main class=main role=main><article class=post><header class=post__header><h1 class=post__title>如何在 Ubuntu 安装 Go 语言编写的 Git 服务器 Gogs</h1><div class="post__meta meta"><div class="meta__item-datetime meta__item"><svg class="meta__icon icon icon-time" width="16" height="14" viewBox="0 0 30 28"><path d="M15 0C7 0 1 6 1 14s6 14 14 14 14-6 14-14S23 0 15 0zm0 25C9 25 4 20 4 14S9 3 15 3s11 5 11 11-5 11-11 11zm1-18h-2v8.4l6.8 4.4L22 18l-6-3.8V7z"/></svg><time class=meta__text datetime=2018-02-27T22:31:57Z>February 27, 2018</time></div></div></header><div class="content post__content clearfix"><p><img src=/data/attachment/album/201802/27/223159q909jj7vij99pv37.png alt></p><p>Gogs 是由 Go 语言编写的，自由开源的 Git 服务。Gogs 是一款无痛式自托管的 Git 服务器，能在尽可能小的硬件资源开销上搭建并运行您的私有 Git 服务器。Gogs 的网页界面和 GitHub 十分相近，且提供 MySQL、PostgreSQL 和 SQLite 数据库支持。</p><p>在本教程中，我们将使用 Gogs 在 Ununtu 16.04 上按步骤指导您安装和配置您的私有 Git 服务器。这篇教程中涵盖了如何在 Ubuntu 上安装 Go 语言、PostgreSQL 和安装并且配置 Nginx 网页服务器作为 Go 应用的反向代理的细节内容。</p><h3 id=搭建环境>搭建环境</h3><ul><li>Ubuntu 16.04</li><li>Root 权限</li></ul><h3 id=我们将会接触到的事物>我们将会接触到的事物</h3><ol><li>更新和升级系统</li><li>安装和配置 PostgreSQL</li><li>安装 Go 和 Git</li><li>安装 Gogs</li><li>配置 Gogs</li><li>运行 Gogs 服务器</li><li>安装和配置 Nginx 反向代理</li><li>测试</li></ol><h3 id=步骤-1---更新和升级系统>步骤 1 - 更新和升级系统</h3><p>继续之前，更新 Ubuntu 所有的库，升级所有包。</p><p>运行下面的 <code>apt</code> 命令：</p><pre tabindex=0><code>sudo apt update
sudo apt upgrade
</code></pre><h3 id=步骤-2---安装和配置-postgresql>步骤 2 - 安装和配置 PostgreSQL</h3><p>Gogs 提供 MySQL、PostgreSQL、SQLite 和 TiDB 数据库系统支持。</p><p>此步骤中，我们将使用 PostgreSQL 作为 Gogs 程序的数据库。</p><p>使用下面的 <code>apt</code> 命令安装 PostgreSQL。</p><pre tabindex=0><code>sudo apt install -y postgresql postgresql-client libpq-dev
</code></pre><p>安装完成之后，启动 PostgreSQL 服务并设置为开机启动。</p><pre tabindex=0><code>systemctl start postgresql
systemctl enable postgresql
</code></pre><p>此时 PostgreSQL 数据库在 Ubuntu 系统上完成安装了。</p><p>之后，我们需要为 Gogs 创建数据库和用户。</p><p>使用 <code>postgres</code> 用户登录并运行 <code>psql</code> 命令以访问 PostgreSQL 操作界面。</p><pre tabindex=0><code>su - postgres
psql
</code></pre><p>创建一个名为 <code>git</code> 的新用户，给予此用户 <code>CREATEDB</code> 权限。</p><pre tabindex=0><code>CREATE USER git CREATEDB;
\password git
</code></pre><p>创建名为 <code>gogs_production</code> 的数据库，设置 <code>git</code> 用户作为其所有者。</p><pre tabindex=0><code>CREATE DATABASE gogs_production OWNER git;
</code></pre><p><a href=https://www.howtoforge.com/images/how_to_install_gogs_go_git_service_on_ubuntu_1604/big/1.png><img src=/data/attachment/album/201802/27/223159jqqr7s19q73z0sm7.png alt="创建 Gogs 数据库"></a></p><p>用于 Gogs 的 <code>gogs_production</code> PostgreSQL 数据库和 <code>git</code> 用户已经创建完毕。</p><h3 id=步骤-3---安装-go-和-git>步骤 3 - 安装 Go 和 Git</h3><p>使用下面的 <code>apt</code> 命令从库中安装 Git。</p><pre tabindex=0><code>sudo apt install git
</code></pre><p>此时，为系统创建名为 <code>git</code> 的新用户。</p><pre tabindex=0><code>sudo adduser --disabled-login --gecos &#39;Gogs&#39; git
</code></pre><p>登录 <code>git</code> 账户并且创建名为 <code>local</code> 的目录。</p><pre tabindex=0><code>su - git
mkdir -p /home/git/local
</code></pre><p>切换到 <code>local</code> 目录，依照下方所展示的内容，使用 <code>wget</code> 命令下载 Go（最新版）。</p><pre tabindex=0><code>cd ~/local
wget https://dl.google.com/go/go1.9.2.linux-amd64.tar.gz
</code></pre><p><a href=https://www.howtoforge.com/images/how_to_install_gogs_go_git_service_on_ubuntu_1604/big/2.png><img src=/data/attachment/album/201802/27/223159nkm316t8ag938tab.png alt="安装 Go 和 Git"></a></p><p>解压并且删除 go 的压缩文件。</p><pre tabindex=0><code>tar -xf go1.9.2.linux-amd64.tar.gz
rm -f go1.9.2.linux-amd64.tar.gz
</code></pre><p>Go 二进制文件已经被下载到 <code>~/local/go</code> 目录。此时我们需要设置环境变量 - 设置 <code>GOROOT</code> 和 <code>GOPATH</code> 目录到系统环境，这样，我们就可以在 <code>git</code> 用户下执行 <code>go</code> 命令。</p><p>执行下方的命令。</p><pre tabindex=0><code>cd ~/
echo &#39;export GOROOT=$HOME/local/go&#39; &gt;&gt; $HOME/.bashrc
echo &#39;export GOPATH=$HOME/go&#39; &gt;&gt; $HOME/.bashrc
echo &#39;export PATH=$PATH:$GOROOT/bin:$GOPATH/bin&#39; &gt;&gt; $HOME/.bashrc
</code></pre><p>之后通过运行 <code>source ~/.bashrc</code> 重载 Bash，如下：</p><pre tabindex=0><code>source ~/.bashrc
</code></pre><p>确定您使用的 Bash 是默认的 shell。</p><p><a href=https://www.howtoforge.com/images/how_to_install_gogs_go_git_service_on_ubuntu_1604/big/3.png><img src=/data/attachment/album/201802/27/223200hxqze1qxafakktee.png alt="安装 Go 编程语言"></a></p><p>现在运行 <code>go</code> 的版本查看命令。</p><pre tabindex=0><code>go version
</code></pre><p>之后确保您得到下图所示的结果。</p><p><a href=https://www.howtoforge.com/images/how_to_install_gogs_go_git_service_on_ubuntu_1604/big/4.png><img src=/data/attachment/album/201802/27/223200mqf4zjbbj83wsq6b.png alt="检查 go 版本"></a></p><p>现在，Go 已经安装在系统的 <code>git</code> 用户下了。</p><h3 id=步骤-4---使用-gogs-安装-git-服务>步骤 4 - 使用 Gogs 安装 Git 服务</h3><p>使用 <code>git</code> 用户登录并且使用 <code>go</code> 命令从 GitHub 下载 Gogs。</p><pre tabindex=0><code>su - git
go get -u github.com/gogits/gogs
</code></pre><p>此命令将在 <code>GOPATH/src</code> 目录下载 Gogs 的所有源代码。</p><p>切换至 <code>$GOPATH/src/github.com/gogits/gogs</code> 目录，并且使用下列命令搭建 Gogs。</p><pre tabindex=0><code>cd $GOPATH/src/github.com/gogits/gogs
go build
</code></pre><p>确保您没有遇到错误。</p><p>现在使用下面的命令运行 Gogs Go Git 服务器。</p><pre tabindex=0><code>./gogs web
</code></pre><p>此命令将会默认运行 Gogs 在 3000 端口上。</p><p><a href=https://www.howtoforge.com/images/how_to_install_gogs_go_git_service_on_ubuntu_1604/big/5.png><img src=/data/attachment/album/201802/27/223201rx1trettt6ax9r6a.png alt="安装 Gogs Go Git 服务"></a></p><p>打开网页浏览器，键入您的 IP 地址和端口号，我的是 <a href=http://192.168.33.10:3000/>http://192.168.33.10:3000/</a> 。</p><p>您应该会得到与下方一致的反馈。</p><p><a href=https://www.howtoforge.com/images/how_to_install_gogs_go_git_service_on_ubuntu_1604/big/6.png><img src=/data/attachment/album/201802/27/223201w3wjl2zto9mj9q0j.png alt="Gogs 网页服务器"></a></p><p>Gogs 已经在您的 Ubuntu 系统上安装完毕。现在返回到您的终端，并且键入 <code>Ctrl + C</code> 中止服务。</p><h3 id=步骤-5---配置-gogs-go-git-服务器>步骤 5 - 配置 Gogs Go Git 服务器</h3><p>本步骤中，我们将为 Gogs 创建惯例配置。</p><p>进入 Gogs 安装目录并新建 <code>custom/conf</code> 目录。</p><pre tabindex=0><code>cd $GOPATH/src/github.com/gogits/gogs
mkdir -p custom/conf/
</code></pre><p>复制默认的配置文件到 <code>custom</code> 目录，并使用 <a href=https://www.howtoforge.com/vim-basics>vim</a> 修改。</p><pre tabindex=0><code>cp conf/app.ini custom/conf/app.ini
vim custom/conf/app.ini
</code></pre><p>在 <code>[server]</code> 小节中，修改 <code>HOST_ADDR</code> 为 <code>127.0.0.1</code>。</p><pre tabindex=0><code>[server]
 PROTOCOL = http
 DOMAIN = localhost
 ROOT_URL = %(PROTOCOL)s://%(DOMAIN)s:%(HTTP_PORT)s/
 HTTP_ADDR = 127.0.0.1
 HTTP_PORT = 3000
</code></pre><p>在 <code>[database]</code> 选项中，按照您的数据库信息修改。</p><pre tabindex=0><code>[database]
 DB_TYPE = postgres
 HOST = 127.0.0.1:5432
 NAME = gogs_production
 USER = git
 PASSWD = aqwe123@#
</code></pre><p>保存并退出。</p><p>运行下面的命令验证配置项。</p><pre tabindex=0><code>./gogs web
</code></pre><p>并且确保您得到如下的结果。</p><p><a href=https://www.howtoforge.com/images/how_to_install_gogs_go_git_service_on_ubuntu_1604/big/7.png><img src=/data/attachment/album/201802/27/223201tkks2z4rrwkpc4yp.png alt=配置服务器></a></p><p>Gogs 现在已经按照自定义配置下运行在 <code>localhost</code> 的 3000 端口上了。</p><h3 id=步骤-6---运行-gogs-服务器>步骤 6 - 运行 Gogs 服务器</h3><p>这一步，我们将在 Ubuntu 系统上配置 Gogs 服务器。我们会在 <code>/etc/systemd/system</code> 目录下创建一个新的服务器配置文件 <code>gogs.service</code>。</p><p>切换到 <code>/etc/systemd/system</code> 目录，使用 <a href=https://www.howtoforge.com/vim-basics>vim</a> 创建服务器配置文件 <code>gogs.service</code>。</p><pre tabindex=0><code>cd /etc/systemd/system
vim gogs.service
</code></pre><p>粘贴下面的代码到 Gogs 服务器配置文件中。</p><pre tabindex=0><code>[Unit]
Description=Gogs
After=syslog.target
After=network.target
After=mariadb.service mysqld.service postgresql.service memcached.service redis.service

[Service]
# Modify these two values and uncomment them if you have
# repos with lots of files and get an HTTP error 500 because
# of that
###
#LimitMEMLOCK=infinity
#LimitNOFILE=65535
Type=simple
User=git
Group=git
WorkingDirectory=/home/git/go/src/github.com/gogits/gogs
ExecStart=/home/git/go/src/github.com/gogits/gogs/gogs web
Restart=always
Environment=USER=git HOME=/home/git

[Install]
WantedBy=multi-user.target
</code></pre><p>之后保存并且退出。</p><p>现在可以重载系统服务器。</p><pre tabindex=0><code>systemctl daemon-reload
</code></pre><p>使用下面的命令开启 Gogs 服务器并设置为开机启动。</p><pre tabindex=0><code>systemctl start gogs
systemctl enable gogs
</code></pre><p><a href=https://www.howtoforge.com/images/how_to_install_gogs_go_git_service_on_ubuntu_1604/big/8.png><img src=/data/attachment/album/201802/27/223201d3322eer2e7ea4rr.png alt="运行 Gogs 服务器"></a></p><p>Gogs 服务器现在已经运行在 Ubuntu 系统上了。</p><p>使用下面的命令检测：</p><pre tabindex=0><code>netstat -plntu
systemctl status gogs
</code></pre><p>您应该会得到下图所示的结果。</p><p><a href=https://www.howtoforge.com/images/how_to_install_gogs_go_git_service_on_ubuntu_1604/big/9.png><img src=/data/attachment/album/201802/27/223201a2sdd7ozsmydkku2.png alt="Gogs is listening on the network interface"></a></p><h3 id=步骤-7---为-gogs-安装和配置-nginx-反向代理>步骤 7 - 为 Gogs 安装和配置 Nginx 反向代理</h3><p>在本步中，我们将为 Gogs 安装和配置 Nginx 反向代理。我们会在自己的库中调用 Nginx 包。</p><p>使用下面的命令添加 Nginx 库。</p><pre tabindex=0><code>sudo add-apt-repository -y ppa:nginx/stable
</code></pre><p>此时更新所有的库并且使用下面的命令安装 Nginx。</p><pre tabindex=0><code>sudo apt update
sudo apt install nginx -y
</code></pre><p>之后，进入 <code>/etc/nginx/sites-available</code> 目录并且创建虚拟主机文件 <code>gogs</code>。</p><pre tabindex=0><code>cd /etc/nginx/sites-available
vim gogs
</code></pre><p>粘贴下面的代码到配置文件。</p><pre tabindex=0><code>server {
     listen 80;
     server_name git.hakase-labs.co;

     location / {
         proxy_pass http://localhost:3000;
     }
 }
</code></pre><p>保存退出。</p><p><strong>注意:</strong> 请使用您的域名修改 <code>server_name</code> 项。</p><p>现在激活虚拟主机并且测试 nginx 配置。</p><pre tabindex=0><code>ln -s /etc/nginx/sites-available/gogs /etc/nginx/sites-enabled/
nginx -t
</code></pre><p>确保没有遇到错误，重启 Nginx 服务器。</p><pre tabindex=0><code>systemctl restart nginx
</code></pre><p><a href=https://www.howtoforge.com/images/how_to_install_gogs_go_git_service_on_ubuntu_1604/big/10.png><img src=/data/attachment/album/201802/27/223202zpfjdwgygat1gvtd.png alt="安装和配置 Nginx 反向代理"></a></p><h3 id=步骤-8---测试>步骤 8 - 测试</h3><p>打开您的网页浏览器并且输入您的 Gogs URL，我的是 <a href=http://git.hakase-labs.co>http://git.hakase-labs.co</a></p><p>现在您将进入安装界面。在页面的顶部，输入您所有的 PostgreSQL 数据库信息。</p><p><a href=https://www.howtoforge.com/images/how_to_install_gogs_go_git_service_on_ubuntu_1604/big/11.png><img src=/data/attachment/album/201802/27/223202dssuqkgcv3w2qd1s.png alt="Gogs 安装"></a></p><p>之后，滚动到底部，点击 “Admin account settings” 下拉选项。</p><p>输入您的管理者用户名和邮箱。</p><p><a href=https://www.howtoforge.com/images/how_to_install_gogs_go_git_service_on_ubuntu_1604/big/12.png><img src=/data/attachment/album/201802/27/223202xzkzagatnkdmgk2a.png alt="键入 gogs 安装设置"></a></p><p>之后点击 “Install Gogs” 按钮。</p><p>然后您将会被重定向到下图显示的 Gogs 用户面板。</p><p><a href=https://www.howtoforge.com/images/how_to_install_gogs_go_git_service_on_ubuntu_1604/big/13.png><img src=/data/attachment/album/201802/27/223202r5romro1ypx8mojx.png alt="Gogs 面板"></a></p><p>下面是 Gogs 的 “Admin Dashboard（管理员面板）”。</p><p><a href=https://www.howtoforge.com/images/how_to_install_gogs_go_git_service_on_ubuntu_1604/big/14.png><img src=/data/attachment/album/201802/27/223202ip2hycq88mmiqmkk.png alt="浏览 Gogs 面板"></a></p><p>现在，Gogs 已经通过 PostgreSQL 数据库和 Nginx 网页服务器在您的 Ubuntu 16.04 上完成安装。</p><hr><p>via: <a href=https://www.howtoforge.com/tutorial/how-to-install-gogs-go-git-service-on-ubuntu-1604/>https://www.howtoforge.com/tutorial/how-to-install-gogs-go-git-service-on-ubuntu-1604/</a></p><p>作者：<a href=https://www.howtoforge.com/tutorial/server-monitoring-with-shinken-on-ubuntu-16-04/>Muhammad Arul</a> 译者：<a href=https://github.com/CYLeft>CYLeft</a> 校对：<a href=https://github.com/wxy>wxy</a></p><p>本文由 <a href=https://github.com/LCTT/TranslateProject>LCTT</a> 原创编译，<a href=https://linux.cn/>Linux中国</a> 荣誉推出</p></div><footer class=post__footer><div class="post__tags tags clearfix"><svg class="tags__badge icon icon-tag" width="16" height="16" viewBox="0 0 32 32"><path d="M32 19c0 1-1 2-1 2L21 31s-1 1-2 1-2-1-2-1L2 16c-1-1-1.4-2-1.4-2S0 12.5.0 11V3C0 1.5.8.8.8.8S1.5.0 3 0h8c1.5.0 3 .6 3 .6S15 1 16 2l15 15s1 1 1 2zM7 10a3 3 0 100-6 3 3 0 000 6z"/></svg><ul class=tags__list><li class=tags__item><a class="tags__link btn" href=/tags/gogs/ rel=tag>Gogs</a></li><li class=tags__item><a class="tags__link btn" href=/tags/go/ rel=tag>Go</a></li><li class=tags__item><a class="tags__link btn" href=/tags/git/ rel=tag>Git</a></li></ul></div></footer></article></main></div></div><footer class=footer><div class="container footer__container flex"><div class=footer__copyright>&copy; 2025 Linux.cn Archive.
<span class=footer__copyright-credits>Generated with <a href=https://gohugo.io/ rel="nofollow noopener" target=_blank>Hugo</a> and <a href=https://github.com/Vimux/Mainroad/ rel="nofollow noopener" target=_blank>Mainroad</a> theme.</span></div></div></footer></div><script async defer src=/js/menu.js></script></body></html>