<!doctype html><html class=no-js lang=en><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><title>在 Ubuntu 15.04 中如何安装和使用 Snort - Linux.cn Archive</title>
<script>(function(e,t){e[t]=e[t].replace("no-js","js")})(document.documentElement,"className")</script><meta name=description content><meta property="og:title" content="在 Ubuntu 15.04 中如何安装和使用 Snort"><meta property="og:description" content="对于网络安全而言入侵检测是一件非常重要的事。入侵检测系统（IDS）用于检测网络中非法与恶意的请求。Snort是一款知名的开源的入侵检测系统。其 Web界面（Snorby）可以用于更好地分析警告。Snort使用iptables/pf防火墙来作为入侵检测系统。本篇中，我们会安装并配置一个开源的入侵检测系统snort。  Snort 安装 要求 snort所使用的数据采集库（DAQ）用于一个调用包捕获库的抽象层。这个在snort上就有。下载过程如下截图所示。  解压并运行./configure、make、make install来安装DAQ。然而，DAQ要求其他的工具，因此，./configure脚本会生成"><meta property="og:type" content="article"><meta property="og:url" content="/article-6135-1.html"><meta property="article:section" content="posts"><meta property="article:published_time" content="2015-09-03T09:07:00+00:00"><meta property="article:modified_time" content="2015-09-03T09:07:00+00:00"><meta itemprop=name content="在 Ubuntu 15.04 中如何安装和使用 Snort"><meta itemprop=description content="对于网络安全而言入侵检测是一件非常重要的事。入侵检测系统（IDS）用于检测网络中非法与恶意的请求。Snort是一款知名的开源的入侵检测系统。其 Web界面（Snorby）可以用于更好地分析警告。Snort使用iptables/pf防火墙来作为入侵检测系统。本篇中，我们会安装并配置一个开源的入侵检测系统snort。  Snort 安装 要求 snort所使用的数据采集库（DAQ）用于一个调用包捕获库的抽象层。这个在snort上就有。下载过程如下截图所示。  解压并运行./configure、make、make install来安装DAQ。然而，DAQ要求其他的工具，因此，./configure脚本会生成"><meta itemprop=datePublished content="2015-09-03T09:07:00+00:00"><meta itemprop=dateModified content="2015-09-03T09:07:00+00:00"><meta itemprop=wordCount content="248"><meta itemprop=keywords content="snort,IDS,入侵检测,"><link rel=preconnect href=https://fonts.bunny.net crossorigin><link rel=dns-prefetch href=//fonts.bunny.net><link rel=dns-prefetch href=//fonts.bunny.net><link rel=stylesheet href="https://fonts.bunny.net/css?family=Open+Sans:400,400i,700"><link rel=stylesheet href=/css/style.css><link rel="shortcut icon" href=/favicon.ico></head><body class=body><div class="container container--outer"><header class=header><div class="container header__container"><div class=logo><a class=logo__link href=/ title="Linux.cn Archive" rel=home><div class="logo__item logo__text"><div class=logo__title>Linux.cn Archive</div></div></a></div><nav class=menu><button class=menu__btn aria-haspopup=true aria-expanded=false tabindex=0>
<span class=menu__btn-title tabindex=-1>Menu</span></button><ul class=menu__list><li class=menu__item><a class=menu__link href=/><span class=menu__text>Home</span></a></li><li class=menu__item><a class=menu__link href=/categories/><span class=menu__text>Categories</span></a></li><li class=menu__item><a class=menu__link href=/tags/><span class=menu__text>Tags</span></a></li><li class=menu__item><a class=menu__link href><span class=menu__text>RSS</span></a></li></ul></nav></div></header><div class="wrapper flex"><div class=primary><main class=main role=main><article class=post><header class=post__header><h1 class=post__title>在 Ubuntu 15.04 中如何安装和使用 Snort</h1><div class="post__meta meta"><div class="meta__item-datetime meta__item"><svg class="meta__icon icon icon-time" width="16" height="14" viewBox="0 0 30 28"><path d="M15 0C7 0 1 6 1 14s6 14 14 14 14-6 14-14S23 0 15 0zm0 25C9 25 4 20 4 14S9 3 15 3s11 5 11 11-5 11-11 11zm1-18h-2v8.4l6.8 4.4L22 18l-6-3.8V7z"/></svg><time class=meta__text datetime=2015-09-03T09:07:00Z>September 03, 2015</time></div></div></header><div class="content post__content clearfix"><p>对于网络安全而言入侵检测是一件非常重要的事。入侵检测系统（IDS）用于检测网络中非法与恶意的请求。Snort是一款知名的开源的入侵检测系统。其 Web界面（Snorby）可以用于更好地分析警告。Snort使用iptables/pf防火墙来作为入侵检测系统。本篇中，我们会安装并配置一个开源的入侵检测系统snort。</p><p><img src=/data/attachment/album/201509/02/151041uh7tc80xcqszccqe.jpg alt></p><h3 id=snort-安装>Snort 安装</h3><h4 id=要求>要求</h4><p>snort所使用的数据采集库（DAQ）用于一个调用包捕获库的抽象层。这个在snort上就有。下载过程如下截图所示。</p><p><img src=/data/attachment/album/201509/02/151043oghfgthfzihuzkhz.png alt=downloading_daq></p><p>解压并运行./configure、make、make install来安装DAQ。然而，DAQ要求其他的工具，因此，./configure脚本会生成下面的错误。</p><p>flex和bison错误</p><p><img src=/data/attachment/album/201509/02/151044x378scchjc8hon00.png alt=flexandbison_error></p><p>libpcap错误</p><p><img src=/data/attachment/album/201509/02/151044uvt4v4mmq4qwyjxz.png alt="libpcap error"></p><p>因此在安装DAQ之前先安装flex/bison和libcap。</p><p><img src=/data/attachment/album/201509/02/151045woeaaebqdeoroeaw.png alt=install_flex></p><p>如下所示安装libpcap开发库</p><p><img src=/data/attachment/album/201509/02/151046u4rrvgjhhgr5rjr8.png alt="libpcap-dev installation"></p><p>安装完必要的工具后，再次运行./configure脚本，将会显示下面的输出。</p><p><img src=/data/attachment/album/201509/02/151046kfy57iz59ziwwokz.png alt=without_error_configure></p><p>make和make install 命令的结果如下所示。</p><p><img src=/data/attachment/album/201509/02/151047oc3jjsvmjxbia3ws.png alt="make install"></p><p><img src=/data/attachment/album/201509/02/151047laa8ayvh3vawqiqo.png alt=make></p><p>成功安装DAQ之后，我们现在安装snort。如下图使用wget下载它。</p><p><img src=/data/attachment/album/201509/02/151048d01qeqxilz8xw8qq.png alt=downloading_snort></p><p>使用下面的命令解压安装包。</p><pre tabindex=0><code>#tar -xvzf  snort-2.9.7.3.tar.gz
</code></pre><p><img src=/data/attachment/album/201509/02/151049zag9kuyaeofvboia.png alt=snort_extraction></p><p>创建安装目录并在脚本中设置prefix参数。同样也建议启用包性能监控（PPM）的sourcefire标志。</p><pre tabindex=0><code>#mkdir /usr/local/snort

#./configure --prefix=/usr/local/snort/ --enable-sourcefire
</code></pre><p><img src=/data/attachment/album/201509/02/151050x7juhpv7zqqrrjhh.png alt=snort_installation></p><p>配置脚本会由于缺少libpcre-dev、libdumbnet-dev 和zlib开发库而报错。</p><p>配置脚本由于缺少libpcre库报错。</p><p><img src=/data/attachment/album/201509/02/151051zjb7sjqz3bjzmo27.png alt=pcre-error></p><p>配置脚本由于缺少dnet（libdumbnet）库而报错。</p><p><img src=/data/attachment/album/201509/02/151051bkvkqdvkvkahkip0.png alt="libdnt error"></p><p>配置脚本由于缺少zlib库而报错</p><p><img src=/data/attachment/album/201509/02/151052g3tztyn495sh6n4i.png alt="zlib error"></p><p>如下所示，安装所有需要的开发库。</p><pre tabindex=0><code># aptitude install libpcre3-dev
</code></pre><p><img src=/data/attachment/album/201509/02/151052wmiu8i50dqtp7ezb.png alt="libpcre3-dev install"></p><pre tabindex=0><code># aptitude install libdumbnet-dev
</code></pre><p><img src=/data/attachment/album/201509/02/151052l3zv9ojoo7zo31it.png alt="libdumnet-dev installation"></p><pre tabindex=0><code># aptitude install zlib1g-dev
</code></pre><p><img src=/data/attachment/album/201509/02/151053hs1dgnnnk3fzbw3b.png alt="zlibg-dev installation"></p><p>安装完snort需要的库之后，再次运行配置脚本就不会报错了。</p><p>运行make和make install命令在/usr/local/snort目录下完成安装。</p><pre tabindex=0><code># make
</code></pre><p><img src=/data/attachment/album/201509/02/151054r3henrs708frnv6s.png alt="make snort"></p><pre tabindex=0><code># make install
</code></pre><p><img src=/data/attachment/album/201509/02/151054oxbrar9w78watt7x.png alt="make install snort"></p><p>最后，从/usr/local/snort/bin中运行snort。现在它对eth0的所有流量都处在promisc模式（包转储模式）。</p><p><img src=/data/attachment/album/201509/02/151055lnd7r6kdwk86wmy8.png alt="snort running"></p><p>如下图所示snort转储流量。</p><p><img src=/data/attachment/album/201509/02/151056mrl8olsjhnjtxgnh.png alt=traffic></p><h4 id=snort的规则和配置>Snort的规则和配置</h4><p>从源码安装的snort还需要设置规则和配置，因此我们需要复制规则和配置到/etc/snort下面。我们已经创建了单独的bash脚本来用于设置规则和配置。它会设置下面这些snort设置。</p><ul><li>在linux中创建用于snort IDS服务的snort用户。</li><li>在/etc下面创建snort的配置文件和文件夹。</li><li>权限设置并从源代码的etc目录中复制数据。</li><li>从snort文件中移除规则中的#(注释符号)。</li></ul><pre tabindex=0><code>#!/bin/bash#
# snort源代码的路径
snort_src=&#34;/home/test/Downloads/snort-2.9.7.3&#34;
echo &#34;adding group and user for snort...&#34;
groupadd snort &amp;&gt; /dev/null
useradd snort -r -s /sbin/nologin -d /var/log/snort -c snort_idps -g snort &amp;&gt; /dev/null#snort configuration
echo &#34;Configuring snort...&#34;mkdir -p /etc/snort
mkdir -p /etc/snort/rules
touch /etc/snort/rules/black_list.rules
touch /etc/snort/rules/white_list.rules
touch /etc/snort/rules/local.rules
mkdir /etc/snort/preproc_rules
mkdir /var/log/snort
mkdir -p /usr/local/lib/snort_dynamicrules
chmod -R 775 /etc/snort
chmod -R 775 /var/log/snort
chmod -R 775 /usr/local/lib/snort_dynamicrules
chown -R snort:snort /etc/snort
chown -R snort:snort /var/log/snort
chown -R snort:snort /usr/local/lib/snort_dynamicrules
###copy  configuration and rules from  etc directory under source code of snort
echo &#34;copying from snort source to /etc/snort .....&#34;
echo $snort_src
echo &#34;-------------&#34;
cp $snort_src/etc/*.conf* /etc/snort
cp $snort_src/etc/*.map /etc/snort##enable rules
sed -i &#39;s/include \$RULE\_PATH/#include \$RULE\_PATH/&#39; /etc/snort/snort.conf
echo &#34;---DONE---&#34;
</code></pre><p>改变脚本中的snort源目录路径并运行。下面是成功的输出。</p><p><img src=/data/attachment/album/201509/02/151057vhvjntoiqko9osv4.png alt="running script"></p><p>上面的脚本从snort源中复制下面的文件和文件夹到/etc/snort配置文件中</p><p><img src=/data/attachment/album/201509/02/151057ssbf8btsttutskdx.png alt="files copied"></p><p>snort的配置非常复杂，要让IDS能正常工作需要进行下面必要的修改。</p><pre tabindex=0><code>ipvar HOME_NET 192.168.1.0/24  # LAN side
</code></pre><hr><pre tabindex=0><code>ipvar EXTERNAL_NET !$HOME_NET   # WAN side
</code></pre><p><img src=/data/attachment/album/201509/02/151057x3853ll43z8l2532.png alt="veriable set"></p><pre tabindex=0><code>var RULE_PATH /etc/snort/rules     # snort signature path
var SO_RULE_PATH /etc/snort/so_rules        #rules in shared libraries
var PREPROC_RULE_PATH /etc/snort/preproc_rules  # Preproces path
var WHITE_LIST_PATH /etc/snort/rules        # dont scan
var BLACK_LIST_PATH /etc/snort/rules        #  Must scan
</code></pre><p><img src=/data/attachment/album/201509/02/151058a3jlqdk4vk3elhi6.png alt="main path"></p><pre tabindex=0><code>include $RULE_PATH/local.rules   # file for custom rules
</code></pre><p>移除ftp.rules、exploit.rules前面的注释符号(#)。</p><p><img src=/data/attachment/album/201509/02/151059fepyx4z1e74jh81e.png alt="path rules"></p><p>现在<a href=https://www.snort.org/downloads/community/community-rules.tar.gz>下载社区规则</a>并解压到/etc/snort/rules。启用snort.conf中的社区及紧急威胁规则。</p><p><img src=/data/attachment/album/201509/02/151059jlddq9adz2bz9u28.png alt=wget_rules></p><p><img src=/data/attachment/album/201509/02/151059xx0k8nbyqb1feyjz.png alt="community rules"></p><p>进行了上面的更改后，运行下面的命令来检验配置文件。</p><pre tabindex=0><code># snort -T -c /etc/snort/snort.conf
</code></pre><p><img src=/data/attachment/album/201509/02/151100qrddrt6gg6kxxml4.png alt="snort running"></p><h3 id=总结>总结</h3><p>本篇中，我们关注了开源IDPS系统snort在Ubuntu上的安装和配置。通常它用于监控事件，然而它可以被配置成用于网络保护的在线模式。snort规则可以在离线模式中可以使用pcap捕获文件进行测试和分析</p><hr><p>via: <a href=http://linoxide.com/security/install-snort-usage-ubuntu-15-04/>http://linoxide.com/security/install-snort-usage-ubuntu-15-04/</a></p><p>作者：<a href=http://linoxide.com/author/naveeda/>nido</a> 译者：<a href=https://github.com/geekpi>geekpi</a> 校对：<a href=https://github.com/wxy>wxy</a></p><p>本文由 <a href=https://github.com/LCTT/TranslateProject>LCTT</a> 原创翻译，<a href=https://linux.cn/>Linux中国</a> 荣誉推出</p></div><footer class=post__footer><div class="post__tags tags clearfix"><svg class="tags__badge icon icon-tag" width="16" height="16" viewBox="0 0 32 32"><path d="M32 19c0 1-1 2-1 2L21 31s-1 1-2 1-2-1-2-1L2 16c-1-1-1.4-2-1.4-2S0 12.5.0 11V3C0 1.5.8.8.8.8S1.5.0 3 0h8c1.5.0 3 .6 3 .6S15 1 16 2l15 15s1 1 1 2zM7 10a3 3 0 100-6 3 3 0 000 6z"/></svg><ul class=tags__list><li class=tags__item><a class="tags__link btn" href=/tags/snort/ rel=tag>snort</a></li><li class=tags__item><a class="tags__link btn" href=/tags/ids/ rel=tag>IDS</a></li><li class=tags__item><a class="tags__link btn" href=/tags/%E5%85%A5%E4%BE%B5%E6%A3%80%E6%B5%8B/ rel=tag>入侵检测</a></li></ul></div></footer></article></main></div></div><footer class=footer><div class="container footer__container flex"><div class=footer__copyright>&copy; 2025 Linux.cn Archive.
<span class=footer__copyright-credits>Generated with <a href=https://gohugo.io/ rel="nofollow noopener" target=_blank>Hugo</a> and <a href=https://github.com/Vimux/Mainroad/ rel="nofollow noopener" target=_blank>Mainroad</a> theme.</span></div></div></footer></div><script async defer src=/js/menu.js></script></body></html>