<!doctype html><html class=no-js lang=en><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><title>何时需要关注 Linux 的内存用量？ - Linux.cn Archive</title>
<script>(function(e,t){e[t]=e[t].replace("no-js","js")})(document.documentElement,"className")</script><meta name=description content><meta property="og:title" content="何时需要关注 Linux 的内存用量？"><meta property="og:description" content="Linux 上的内存管理很复杂。尽管使用率高但未必存在问题。你也应当关注一些其他的事情。"><meta property="og:type" content="article"><meta property="og:url" content="/article-11067-1.html"><meta property="article:section" content="posts"><meta property="article:published_time" content="2019-07-06T17:39:37+00:00"><meta property="article:modified_time" content="2019-07-06T17:39:37+00:00"><meta itemprop=name content="何时需要关注 Linux 的内存用量？"><meta itemprop=description content="Linux 上的内存管理很复杂。尽管使用率高但未必存在问题。你也应当关注一些其他的事情。"><meta itemprop=datePublished content="2019-07-06T17:39:37+00:00"><meta itemprop=dateModified content="2019-07-06T17:39:37+00:00"><meta itemprop=wordCount content="212"><meta itemprop=keywords content="内存,"><link rel=preconnect href=https://fonts.bunny.net crossorigin><link rel=dns-prefetch href=//fonts.bunny.net><link rel=dns-prefetch href=//fonts.bunny.net><link rel=stylesheet href="https://fonts.bunny.net/css?family=Open+Sans:400,400i,700"><link rel=stylesheet href=/css/style.css><link rel="shortcut icon" href=/favicon.ico></head><body class=body><div class="container container--outer"><header class=header><div class="container header__container"><div class=logo><a class=logo__link href=/ title="Linux.cn Archive" rel=home><div class="logo__item logo__text"><div class=logo__title>Linux.cn Archive</div></div></a></div><nav class=menu><button class=menu__btn aria-haspopup=true aria-expanded=false tabindex=0>
<span class=menu__btn-title tabindex=-1>Menu</span></button><ul class=menu__list><li class=menu__item><a class=menu__link href=/><span class=menu__text>Home</span></a></li><li class=menu__item><a class=menu__link href=/categories/><span class=menu__text>Categories</span></a></li><li class=menu__item><a class=menu__link href=/tags/><span class=menu__text>Tags</span></a></li><li class=menu__item><a class=menu__link href><span class=menu__text>RSS</span></a></li></ul></nav></div></header><div class="wrapper flex"><div class=primary><main class=main role=main><article class=post><header class=post__header><h1 class=post__title>何时需要关注 Linux 的内存用量？</h1><div class="post__meta meta"><div class="meta__item-datetime meta__item"><svg class="meta__icon icon icon-time" width="16" height="14" viewBox="0 0 30 28"><path d="M15 0C7 0 1 6 1 14s6 14 14 14 14-6 14-14S23 0 15 0zm0 25C9 25 4 20 4 14S9 3 15 3s11 5 11 11-5 11-11 11zm1-18h-2v8.4l6.8 4.4L22 18l-6-3.8V7z"/></svg><time class=meta__text datetime=2019-07-06T17:39:37Z>July 06, 2019</time></div></div></header><div class="content post__content clearfix"><blockquote><p>Linux 上的内存管理很复杂。尽管使用率高但未必存在问题。你也应当关注一些其他的事情。</p></blockquote><p><img src=/data/attachment/album/201907/06/173913n6rjbxwj6bfrjxwx.jpg alt></p><p>在 Linux 上用光内存通常并不意味着存在严重的问题。为什么？因为健康的 Linux 系统会在内存中缓存磁盘活动，基本上占用掉了未被使用的内存，这显然是一件好事情。</p><p>换句话说，它不让内存浪费掉。使用空闲的内存增加磁盘访问速度，并且不占用运行中应用程序的内存。你也能够想到，使用这种内存缓存比起直接访问硬盘驱动器（HDD）快上数百倍，也比明显快于直接访问固态硬盘驱动。内存占满或几乎占满通常意味着系统正在尽可能高效地运行当中 —— 并不是运行中遇到了问题。</p><h3 id=缓存如何工作>缓存如何工作</h3><p>磁盘缓存简单地意味着系统充分利用未使用的资源（空闲内存）来加速磁盘读取与写入。应用程序不会失去任何东西，并且大多数时间里能够按需求获得更多的内存。此外，磁盘缓存不会导致应用程序转而使用交换分区。反而，用作磁盘缓存的内存空间当被需要时会立即归还，并且磁盘内容会被更新。</p><h3 id=主要和次要的页故障>主要和次要的页故障</h3><p>Linux 系统通过分割物理内存来为进程分配空间，将分割成的块称为“页”，并且映射这些页到每个进程的虚拟内存上。不再会用到的页也许会从内存中移除，尽管相关的进程还在运行。当进程需要一个没有被映射或没在内存中页时，故障便会产生。所以，这个“ 故障 fault ”并不意味着“ 错误 error ”而是“ 不可用 unavailables ”，并且故障在内存管理中扮演者一个重要的角色。</p><p>次要故障意味着在内存中的页未分配给请求的进程，或未在内存管理单元中标记为出现。主要故障意味着页没有保留在内存中。</p><p>如果你想切身感受一下次要页故障和主要页故障出现的频率，像这样试一下 <code>ps</code> 命令。注意我们要的是与页故障和产生它的命令相关的项。输出中省略了很多行。<code>MINFL</code> 显示出次要故障的数目，而 <code>MAJFL</code> 表示了主要故障的数目。</p><pre tabindex=0><code>$ ps -eo min_flt,maj_flt,cmd
 MINFL  MAJFL CMD
230760    150 /usr/lib/systemd/systemd --switched-root --system --deserialize 18
     0      0 [kthreadd]
     0      0 [rcu_gp]
     0      0 [rcu_par_gp]
     0      0 [kworker/0:0H-kblockd]
   ...
   166     20 gpg-agent --homedir /var/lib/fwupd/gnupg --use-standard-socket --daemon
   525      1 /usr/libexec/gvfsd-trash --spawner :1.16 /org/gtk/gvfs/exec_spaw/0
  4966      4 /usr/libexec/gnome-terminal-server
  3617      0 bash
     0      0 [kworker/1:0H-kblockd]
   927      0 gdm-session-worker [pam/gdm-password]
</code></pre><p>汇报单一进程，你可以尝试这样的命令（LCTT 译注：参数里面的 <code>1</code> 是要查看的进程的 PID）：</p><pre tabindex=0><code>$ ps -o min_flt,maj_flt 1
 MINFL  MAJFL
230064    150
</code></pre><p>你也可以添加其他的显示字段，例如进程所有者的 UID 和 GID。</p><pre tabindex=0><code>$ ps -o min_flt,maj_flt,cmd,args,uid,gid 1
 MINFL  MAJFL CMD                         COMMAND                       UID   GID
230064    150 /usr/lib/systemd/systemd -- /usr/lib/systemd/systemd --     0     0
</code></pre><h3 id=多少才算满>多少才算满？</h3><p>一种较好的方法来掌握内存究竟使用了多少是用 <code>free -m</code> 命令。<code>-m</code> 选项指定了数字的单位是 MiB mebibyte 而不是字节。</p><pre tabindex=0><code>$ free -m
              total        used        free      shared  buff/cache   available
Mem:           3244        3069          35          49         140         667
Swap:          3535           0        3535
</code></pre><p>注意 <code>free</code>（未使用）的内存可能会不足，而 <code>available</code>（可用于启动新的应用）会显示更大的数量。这两者的区别值得我们去关注。 可用 available 意味着它可以在需要时恢复使用，而 空闲 free 意味着现在就能够使用。</p><h3 id=什么时候要担心>什么时候要担心</h3><p>如果 Linux 系统上的性能表现良好 —— 应用程序响应度高，命令行没有显示出问题 —— 很可能系统状况良好。记住，一些应用也许会出于某种原因而变慢，但它不影响整个系统。</p><p>过多的硬故障也许表明确实存在问题，但要将其与观察到的性能相比较。</p><p>一个好的方法是当可用内存接近 0 或者“ 用作交换 swap used ”项显著增长或波动时开始担心。如果“可用”项占总内存可用量的百分比合理，那么就无需担心，就像下面的例子那样：</p><pre tabindex=0><code>$ free -m
              total        used        free      shared  buff/cache   available
Mem:           3244        3069          35          49         140         667
Swap:          3535           0        3535
</code></pre><h3 id=linux-性能很复杂>Linux 性能很复杂</h3><p>抛开这些不说，Linux 系统上的内存可能会变满，并且性能可能会降低。当系统出现问题时不要仅将单一的内存使用报告作为指标。</p><p>Linux 系统的内存管理很复杂，因为它采取的措施需要确保系统资源得到最好的利用。不要受到一开始内存占满的欺骗，使你认为系统存在问题，但实际上并没有。</p><hr><p>via: <a href=https://www.networkworld.com/article/3394603/when-to-be-concerned-about-memory-levels-on-linux.html>https://www.networkworld.com/article/3394603/when-to-be-concerned-about-memory-levels-on-linux.html</a></p><p>作者：<a href=https://www.networkworld.com/author/Sandra-Henry_Stocker/>Sandra Henry-Stocker</a> 选题：<a href=https://github.com/lujun9972>lujun9972</a> 译者：<a href=https://github.com/LuuMing>LuuMing</a> 校对：<a href=https://github.com/wxy>wxy</a></p><p>本文由 <a href=https://github.com/LCTT/TranslateProject>LCTT</a> 原创编译，<a href=https://linux.cn/>Linux中国</a> 荣誉推出</p></div><footer class=post__footer><div class="post__tags tags clearfix"><svg class="tags__badge icon icon-tag" width="16" height="16" viewBox="0 0 32 32"><path d="M32 19c0 1-1 2-1 2L21 31s-1 1-2 1-2-1-2-1L2 16c-1-1-1.4-2-1.4-2S0 12.5.0 11V3C0 1.5.8.8.8.8S1.5.0 3 0h8c1.5.0 3 .6 3 .6S15 1 16 2l15 15s1 1 1 2zM7 10a3 3 0 100-6 3 3 0 000 6z"/></svg><ul class=tags__list><li class=tags__item><a class="tags__link btn" href=/tags/%E5%86%85%E5%AD%98/ rel=tag>内存</a></li></ul></div></footer></article></main></div></div><footer class=footer><div class="container footer__container flex"><div class=footer__copyright>&copy; 2025 Linux.cn Archive.
<span class=footer__copyright-credits>Generated with <a href=https://gohugo.io/ rel="nofollow noopener" target=_blank>Hugo</a> and <a href=https://github.com/Vimux/Mainroad/ rel="nofollow noopener" target=_blank>Mainroad</a> theme.</span></div></div></footer></div><script async defer src=/js/menu.js></script></body></html>