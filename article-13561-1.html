<!doctype html><html class=no-js lang=en><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><title>如何解析 Bash 程序的配置文件 - Linux.cn Archive</title>
<script>(function(e,t){e[t]=e[t].replace("no-js","js")})(document.documentElement,"className")</script><meta name=description content><meta property="og:title" content="如何解析 Bash 程序的配置文件"><meta property="og:description" content="将配置文件与代码分离，使任何人都可以改变他们的配置，而不需要任何特殊的编程技巧。"><meta property="og:type" content="article"><meta property="og:url" content="/article-13561-1.html"><meta property="article:section" content="posts"><meta property="article:published_time" content="2021-07-08T16:36:38+00:00"><meta property="article:modified_time" content="2021-07-08T16:36:38+00:00"><meta itemprop=name content="如何解析 Bash 程序的配置文件"><meta itemprop=description content="将配置文件与代码分离，使任何人都可以改变他们的配置，而不需要任何特殊的编程技巧。"><meta itemprop=datePublished content="2021-07-08T16:36:38+00:00"><meta itemprop=dateModified content="2021-07-08T16:36:38+00:00"><meta itemprop=wordCount content="220"><meta itemprop=keywords content="配置,"><link rel=preconnect href=https://fonts.bunny.net crossorigin><link rel=dns-prefetch href=//fonts.bunny.net><link rel=dns-prefetch href=//fonts.bunny.net><link rel=stylesheet href="https://fonts.bunny.net/css?family=Open+Sans:400,400i,700"><link rel=stylesheet href=/css/style.css><link rel="shortcut icon" href=/favicon.ico></head><body class=body><div class="container container--outer"><header class=header><div class="container header__container"><div class=logo><a class=logo__link href=/ title="Linux.cn Archive" rel=home><div class="logo__item logo__text"><div class=logo__title>Linux.cn Archive</div></div></a></div><nav class=menu><button class=menu__btn aria-haspopup=true aria-expanded=false tabindex=0>
<span class=menu__btn-title tabindex=-1>Menu</span></button><ul class=menu__list><li class=menu__item><a class=menu__link href=/><span class=menu__text>Home</span></a></li><li class=menu__item><a class=menu__link href=/categories/><span class=menu__text>Categories</span></a></li><li class=menu__item><a class=menu__link href=/tags/><span class=menu__text>Tags</span></a></li><li class=menu__item><a class=menu__link href><span class=menu__text>RSS</span></a></li></ul></nav></div></header><div class="wrapper flex"><div class=primary><main class=main role=main><article class=post><header class=post__header><h1 class=post__title>如何解析 Bash 程序的配置文件</h1><div class="post__meta meta"><div class="meta__item-datetime meta__item"><svg class="meta__icon icon icon-time" width="16" height="14" viewBox="0 0 30 28"><path d="M15 0C7 0 1 6 1 14s6 14 14 14 14-6 14-14S23 0 15 0zm0 25C9 25 4 20 4 14S9 3 15 3s11 5 11 11-5 11-11 11zm1-18h-2v8.4l6.8 4.4L22 18l-6-3.8V7z"/></svg><time class=meta__text datetime=2021-07-08T16:36:38Z>July 08, 2021</time></div></div></header><div class="content post__content clearfix"><blockquote><p>将配置文件与代码分离，使任何人都可以改变他们的配置，而不需要任何特殊的编程技巧。</p></blockquote><p><img src=https://img.linux.net.cn/data/attachment/album/202107/08/163606y3287i6c7dqq0223.jpg alt title="bash logo on green background"></p><p>将程序配置与代码分离是很重要的。它使非程序员能够改变配置而不需要修改程序的代码。如果是编译好的二进制可执行文件，这对非程序员来说是不可能的，因为它不仅需要访问源文件（我们在开源程序中会这样），而且还需要程序员的技能组合。很少有人有这种能力，而且大多数人都不想学习它。</p><p>对于像 Bash 这样的 shell 语言，由于 shell 脚本没有被编译成二进制格式，所以从定义上讲，源码是可以访问的。尽管有这种开放性，但对于非程序员来说，在 shell 脚本中钻研和修改它们并不是一个特别好的主意。即使是经验丰富的开发人员和系统管理员，也会意外地做出一些导致错误或更糟的改变。</p><p>因此，将配置项放在容易维护的文本文件中，提供了分离，并允许非程序员编辑配置，而不会有对代码进行意外修改的危险。许多开发者对用编译语言编写的程序都是这样做的，因为他们并不期望用户是开发者。由于许多相同的原因，对解释型 shell 语言这样做也是有意义的。</p><h3 id=通常的方式>通常的方式</h3><p>和其他许多语言一样, 你可以为 Bash 程序编写代码，来读取并解析 ASCII 文本的配置文件、读取变量名称并在程序代码执行时设置值。例如，一个配置文件可能看起来像这样：</p><pre tabindex=0><code>var1=LinuxGeek46
var2=Opensource.com
</code></pre><p>程序将读取文件，解析每一行，并将值设置到每个变量中。</p><h3 id=源引>源引</h3><p>Bash 使用一种更简单的方法来解析和设置变量, 叫做 源引 sourcing 。从一个可执行的 shell 程序中获取一个外部文件是一种简单的方法，可以将该文件的内容完整地引入 shell 程序中。在某种意义上，这很像编译语言的 <code>include</code> 语句，在运行时包括库文件。这样的文件可以包括任何类型的 Bash 代码，包括变量赋值。</p><p>（LCTT 译注：对于使用 <code>source</code> 或 <code>.</code> 命令引入另外一个文件的行为，我们首倡翻译为“源引”。）</p><p>像往常一样，演示比解释更容易。</p><p>首先，创建一个 <code>~/bin</code> 目录（如果它还不存在的话），并将其作为当前工作目录（PWD）。<a href=http://refspecs.linuxfoundation.org/fhs.shtml>Linux 文件系统分层标准</a> 将 <code>~/bin</code> 定义为用户存储可执行文件的适当位置。</p><p>在这个目录下创建一个新文件。将其命名为 <code>main</code>，并使其可执行：</p><pre tabindex=0><code>[dboth@david bin]$ touch main
[dboth@david bin]$ chmod +x main
[dboth@david bin]$
</code></pre><p>在这个可执行文件中添加以下内容：</p><pre tabindex=0><code>#!/bin/bash
Name=&#34;LinuxGeek&#34;
echo $Name
</code></pre><p>并执行这个 Bash 程序：</p><pre tabindex=0><code>[dboth@david bin]$ ./main
LinuxGeek
[dboth@david bin]$
</code></pre><p>创建一个新的文件并命名为 <code>~/bin/data</code>。这个文件不需要是可执行的。在其中添加以下信息：</p><pre tabindex=0><code># Sourced code and variables
echo &#34;This is the sourced code from the data file.&#34;
FirstName=&#34;David&#34;
LastName=&#34;Both&#34;
</code></pre><p>在 <code>main</code> 程序中增加三行，看起来像这样：</p><pre tabindex=0><code>#!/bin/bash
Name=&#34;LinuxGeek&#34;
echo $Name
source ~/bin/data
echo &#34;First name: $FirstName&#34;
echo &#34;LastName: $LastName&#34;
</code></pre><p>重新运行该程序：</p><pre tabindex=0><code>[dboth@david bin]$ ./main
LinuxGeek
This is the sourced code from the data file.
First name: David
LastName: Both
[dboth@david bin]$
</code></pre><p>关于源引还有一件非常酷的事情要知道。你可以使用一个单点（<code>.</code>）作为 <code>source</code> 命令的快捷方式。改变 <code>main</code> 文件，用 <code>.</code> 代替 <code>source</code>。</p><pre tabindex=0><code>#!/bin/bash
Name=&#34;LinuxGeek&#34;
echo $Name
. ~/bin/data
echo &#34;First name: $FirstName&#34;
echo &#34;LastName: $LastName&#34;
</code></pre><p>并再次运行该程序。其结果应该与之前的运行完全相同。</p><h3 id=运行-bash>运行 Bash</h3><p>每一台使用 Bash 的 Linux 主机（几乎所有主机都是，因为 Bash 是所有发行版的默认 shell），都包括一些优秀的、内置的源引示例。</p><p>每当 Bash shell 运行时，它的环境必须被配置成可以使用的样子。有五个主要文件和一个目录用于配置 Bash 环境。它们和它们的主要功能如下：</p><ul><li><code>/etc/profile</code>: 系统级的环境和启动程序</li><li><code>/etc/bashrc</code>: 系统级的函数和别名</li><li><code>/etc/profile.d/</code>: 包含系统级的脚本的目录，用于配置各种命令行工具，如 <code>vim</code> 和 <code>mc</code> 以及系统管理员创建的任何自定义配置脚本</li><li><code>~/.bash_profile</code>: 用户特定的环境和启动程序</li><li><code>~/.bashrc</code>: 用户特定的别名和函数</li><li><code>~/.bash_logout</code>: 用户特定的命令，在用户注销时执行</li></ul><p>试着通过这些文件追踪执行顺序，确定它在非登录 Bash 初始化和登录 Bash 初始化中使用的顺序。我在我的 Linux 培训系列《<a href="http://www.both.org/?page_id=1183">使用和管理 Linux：从零到系统管理员</a>》的第一卷第 17 章中这样做过。</p><p>给你一个提示。这一切都从 <code>~/.bashrc</code> 脚本开始。</p><h3 id=总结>总结</h3><p>这篇文章探讨了在 Bash 程序中引用代码和变量的方法。这种从配置文件中解析变量的方法是快速、简单和灵活的。它提供了一种将 Bash 代码与变量赋值分开的方法，以使非程序员能够设置这些变量的值。</p><hr><p>via: <a href=https://opensource.com/article/21/6/bash-config>https://opensource.com/article/21/6/bash-config</a></p><p>作者：<a href=https://opensource.com/users/dboth>David Both</a> 选题：<a href=https://github.com/lujun9972>lujun9972</a> 译者：<a href=https://github.com/geekpi>geekpi</a> 校对：<a href=https://github.com/wxy>wxy</a></p><p>本文由 <a href=https://github.com/LCTT/TranslateProject>LCTT</a> 原创编译，<a href=https://linux.cn/>Linux中国</a> 荣誉推出</p></div><footer class=post__footer><div class="post__tags tags clearfix"><svg class="tags__badge icon icon-tag" width="16" height="16" viewBox="0 0 32 32"><path d="M32 19c0 1-1 2-1 2L21 31s-1 1-2 1-2-1-2-1L2 16c-1-1-1.4-2-1.4-2S0 12.5.0 11V3C0 1.5.8.8.8.8S1.5.0 3 0h8c1.5.0 3 .6 3 .6S15 1 16 2l15 15s1 1 1 2zM7 10a3 3 0 100-6 3 3 0 000 6z"/></svg><ul class=tags__list><li class=tags__item><a class="tags__link btn" href=/tags/%E9%85%8D%E7%BD%AE/ rel=tag>配置</a></li></ul></div></footer></article></main></div></div><footer class=footer><div class="container footer__container flex"><div class=footer__copyright>&copy; 2025 Linux.cn Archive.
<span class=footer__copyright-credits>Generated with <a href=https://gohugo.io/ rel="nofollow noopener" target=_blank>Hugo</a> and <a href=https://github.com/Vimux/Mainroad/ rel="nofollow noopener" target=_blank>Mainroad</a> theme.</span></div></div></footer></div><script async defer src=/js/menu.js></script></body></html>