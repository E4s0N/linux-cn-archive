<!doctype html><html class=no-js lang=en><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><title>服务器支持 IPv6 的原因 - Linux.cn Archive</title>
<script>(function(e,t){e[t]=e[t].replace("no-js","js")})(document.documentElement,"className")</script><meta name=description content><meta property="og:title" content="服务器支持 IPv6 的原因"><meta property="og:description" content="假设，网站不支持 IPv6 并不会造成很多困难，那么为什么网站需要支持 IPv6 呢？"><meta property="og:type" content="article"><meta property="og:url" content="/article-15142-1.html"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-10-15T15:51:14+00:00"><meta property="article:modified_time" content="2022-10-15T15:51:14+00:00"><meta itemprop=name content="服务器支持 IPv6 的原因"><meta itemprop=description content="假设，网站不支持 IPv6 并不会造成很多困难，那么为什么网站需要支持 IPv6 呢？"><meta itemprop=datePublished content="2022-10-15T15:51:14+00:00"><meta itemprop=dateModified content="2022-10-15T15:51:14+00:00"><meta itemprop=wordCount content="420"><meta itemprop=keywords content="IPv6,"><link rel=preconnect href=https://fonts.bunny.net crossorigin><link rel=dns-prefetch href=//fonts.bunny.net><link rel=dns-prefetch href=//fonts.bunny.net><link rel=stylesheet href="https://fonts.bunny.net/css?family=Open+Sans:400,400i,700"><link rel=stylesheet href=/css/style.css><link rel="shortcut icon" href=/favicon.ico></head><body class=body><div class="container container--outer"><header class=header><div class="container header__container"><div class=logo><a class=logo__link href=/ title="Linux.cn Archive" rel=home><div class="logo__item logo__text"><div class=logo__title>Linux.cn Archive</div></div></a></div><nav class=menu><button class=menu__btn aria-haspopup=true aria-expanded=false tabindex=0>
<span class=menu__btn-title tabindex=-1>Menu</span></button><ul class=menu__list><li class=menu__item><a class=menu__link href=/><span class=menu__text>Home</span></a></li><li class=menu__item><a class=menu__link href=/categories/><span class=menu__text>Categories</span></a></li><li class=menu__item><a class=menu__link href=/tags/><span class=menu__text>Tags</span></a></li><li class=menu__item><a class=menu__link href><span class=menu__text>RSS</span></a></li></ul></nav></div></header><div class="wrapper flex"><div class=primary><main class=main role=main><article class=post><header class=post__header><h1 class=post__title>服务器支持 IPv6 的原因</h1><div class="post__meta meta"><div class="meta__item-datetime meta__item"><svg class="meta__icon icon icon-time" width="16" height="14" viewBox="0 0 30 28"><path d="M15 0C7 0 1 6 1 14s6 14 14 14 14-6 14-14S23 0 15 0zm0 25C9 25 4 20 4 14S9 3 15 3s11 5 11 11-5 11-11 11zm1-18h-2v8.4l6.8 4.4L22 18l-6-3.8V7z"/></svg><time class=meta__text datetime=2022-10-15T15:51:14Z>October 15, 2022</time></div></div></header><div class="content post__content clearfix"><p><img src=/data/attachment/album/202210/15/155046v94vbmo5imykfkxz.jpg alt></p><p>我一直在努力学习关于 IPv6 的相关知识。一方面，IPv6 的基础概念是很简单的（没有足够的 IPv4 地址可以满足互联网上的所有设备，所以人们发明了 IPv6！每个人都能有足够的 IPv6 地址！）</p><p>但是当我试图进一步理解它时，我遇到了很多问题。其中一个问题是：为什么 <a href=http://twitter.com>twitter.com</a> 不支持 IPv6。假设，网站不支持 IPv6 并不会造成很多困难，那么为什么网站需要支持 IPv6 呢？</p><p>我在 Twitter 上询问了很多人 <a href=https://twitter.com/b0rk/status/1487156306884636672>为什么他们的服务器支持 IPv6</a>，我得到了很多很好的答案，我将在这里总结一下。事先说明一下，因为我对 IPv6 基本上毫无经验，所以下面所总结的理由中可能会有写得不准确的地方，请大家多多包涵。</p><p>首先，我想解释一下为什么 <a href=http://twitter.com>twitter.com</a> 可以不支持 IPv6，因为这是最先让我困惑的地方。</p><h3 id=怎么知道-twittercomhttptwittercom-不支持-ipv6-呢>怎么知道 <a href=http://twitter.com>twitter.com</a> 不支持 IPv6 呢？</h3><p>你可以使用 <code>dig</code> 命令以 <code>AAAA</code> 的选项查询某一个域名的 IPv6 地址记录，如果没有记录，则表明该域名不支持 IPv6。除了 <a href=http://twitter.com>twitter.com</a>，还有一些大型网站，如 <a href=http://github.com>github.com</a> 和 <a href=http://stripe.com>stripe.com</a> 也不支持 IPv6。</p><pre tabindex=0><code>$ dig AAAA twitter.com
(empty response)
$ dig AAAA github.com
(empty response)
$ dig AAAA stripe.com
(empty response)
</code></pre><h3 id=为什么-twittercomhttptwittercom-仍然适用于-ipv6-用户>为什么 <a href=http://twitter.com>twitter.com</a> 仍然适用于 IPv6 用户？</h3><p>我发现这真的很令人困惑。我一直听说因为 IPv4 地址已经用完了，从而很多互联网用户被迫要使用 IPv6 地址。但如果这是真的，<a href=http://twitter.com>twitter.com</a> 怎么能继续为那些没有 IPv6 支持的人提供服务呢？以下内容是我昨天从 Twitter 会话中学习到的。</p><p>互联网服务提供商（ISP）有两种：</p><ol><li>能为所有用户拥有足够 IPv4 地址的 ISP</li><li>不能为所有用户拥有足够 IPv4 地址的 ISP</li></ol><p>我的互联网服务提供商属于第 1 类，因此我的计算机有自己的 IPv4 地址，实际上我的互联网服务提供商甚至根本不支持 IPv6。</p><p>但是很多互联网服务提供商（尤其是北美以外的）都属于第 2 类：他们没有足够的 IPv4 地址供所有用户使用。这些互联网服务提供商通过以下方式处理问题：</p><ul><li>为所有用户提供唯一的 IPv6 地址，以便他们可以直接访问 IPv6 网站</li><li>让用户 <em>共享</em> IPv4 地址，这可以使用 CGNAT（“ 运营商级 NAT carrier-grade NAT ”）或者“464XLAT”或其他方式。</li></ul><p>所有互联网服务提供商都需要 <em>一些</em> IPv4 地址，否则他们的用户将无法访问 <a href=http://twitter.com>twitter.com</a> 等只能使用 IPv4 的网站。</p><h3 id=为什么网站要支持-ipv6>为什么网站要支持 IPv6？</h3><p>现在，我们已经解释了为什么可以 <em>不支持</em> IPv6。那为什么要支持 IPv6 呢？有下面这些原因。</p><h4 id=原因一cgnat-是一个性能瓶颈>原因一：CGNAT 是一个性能瓶颈</h4><p>对我而言，支持 IPv6 最有说服力的论点是：CGNAT 是一个瓶颈，它会导致性能问题，并且随着对 IPv4 地址的访问变得越来越受限，它的性能会变得更糟。</p><p>有人也提到：因为 CGNAT 是一个性能瓶颈，因此它成为了一个有吸引力的拒绝服务攻击（DDoS）的目标，因为你可以通过攻击一台服务器，影响其他用户对该服务器的网站的可用性。</p><p>支持 IPv6 的服务器减少了对 CGNAT 的需求（IPv6 用户可以直接连接！），这使得互联网对每个人的响应速度都更快了。</p><p>我认为这个论点很有趣，因为它需要各方的努力——仅仅你的网站支持 IPv6，并不会让你的网站更好地运行，而更重要的是如果 <em>几乎每个网站</em> 都支持 IPv6，那么它将使每个人的互联网体验更好，尤其对于那些无法轻松访问 IPv4 地址的国家/地区。</p><p>实际上，我不知道这在实践中会有多大的关系。</p><p>不过，使用 IPv6 还有很多更自私的论点，所以让我们继续探讨吧。</p><h4 id=原因二只能使用-ipv6-的服务器也能够访问你的网站>原因二：只能使用 IPv6 的服务器也能够访问你的网站</h4><p>我之前说过，大多数 IPv6 用户仍然可以通过 NAT 方式访问 IPv4 的网站。但是有些 IPv6 用户是不能访问 IPv4 网站的，因为他们发现他们运行的服务器只有 IPv6 地址，并且不能使用 NAT。因此，这些服务器完全无法访问只能使用 IPv4 的网站。</p><p>我想这些服务器并没有连接很多主机，也许它们只需要连接到一些支持 IPv6 的主机。</p><p>但对我来说，即使没有 IPv4 地址，一台主机也应该能够访问我的站点。</p><h4 id=原因三更好的性能>原因三：更好的性能</h4><p>对于同时使用 IPv4 和 IPv6（即具有专用 IPv6 地址和共享 IPv4 地址）的用户，IPv6 通常更快，因为它不需要经过额外的 NAT 地址转换。</p><p>因此，有时支持 IPv6 的网站可以为用户提供更快的响应。</p><p>在实际应用中，客户端使用一种称为“Happy Eyeballs”的算法，该算法能够从 IPv4 和 IPv6 中为用户选择一个最快的链接。</p><p>以下是网站支持 IPv6 的一些其他性能优势:</p><ul><li>使用 IPv6 可以提高搜索引擎优化（SEO），因为 IPv6 具有更好的性能。</li><li>使用 IPv6 可能会使你的数据包通过更好（更快）的网络硬件，因为相较于 IPv4，IPv6 是一个更新的协议。</li></ul><h4 id=原因四能够恢复-ipv4-互联网中断>原因四：能够恢复 IPv4 互联网中断</h4><p>有人说他碰到过由于意外的 BGP 中毒，而导致仅影响 IPv4 流量的互联网中断问题。</p><p>因此，支持 IPv6 的网站意味着在中断期间，网站仍然可以保持部分在线。</p><h4 id=原因五避免家庭服务器的-nat-问题>原因五：避免家庭服务器的 NAT 问题</h4><p>将 IPv6 与家庭服务器一起使用，会变得简单很多，因为数据包不必通过路由器进行端口转发，因此只需为每台服务器分配一个唯一的 IPv6 地址，然后直接访问服务器的 IPv6 地址即可。</p><p>当然，要实现这一点，客户端需要支持 IPv6，但如今越来越多的客户端也能支持 IPv6 了。</p><h4 id=原因六为了拥有自己的-ip-地址>原因六：为了拥有自己的 IP 地址</h4><p>你也可以自己购买 IPv6 地址，并将它们用于家庭网络的服务器上。如果你更换了互联网服务提供商，可以继续使用相同的 IP 地址。</p><p>我不太明白这是如何工作的，是如何让互联网上的计算机将这些 IP 地址路由转发给你的？我猜测你需要运行自己的自治系统（AS）或其他东西。</p><h4 id=原因七为了学习-ipv6>原因七：为了学习 IPv6</h4><p>有人说他们在安全领域中工作，为保证信息安全，了解互联网协议的工作原理非常重要（攻击者正在使用互联网协议进行攻击！）。因此，运行 IPv6 服务器有助于他们了解其工作原理。</p><h4 id=原因八为了推进-ipv6>原因八：为了推进 IPv6</h4><p>有人说因为 IPv6 是当前的标准，因此他们希望通过支持 IPv6 来为 IPv6 的成功做出贡献。</p><p>很多人还说他们的服务器支持 IPv6，是因为他们认为只能使用 IPv4 的网站已经太“落后”了。</p><h4 id=原因九ipv6-很简单>原因九：IPv6 很简单</h4><p>我还得到了一堆“使用 IPv6 很容易，为什么不用呢”的答案。在所有情况下添加 IPv6 支持并不容易，但在某些情况下添加 IPv6 支持会是很容易的，有以下的几个原因：</p><ul><li>你可以从托管公司自动地获得 IPv6 地址，因此你只需要做的就是添加指向该地址的 <code>AAAA</code> 记录</li><li>你的网站是基于支持 IPv6 的内容分发网络（CDN），因此你无需做任何额外的事情</li></ul><h4 id=原因十为了实施更安全的网络实验>原因十：为了实施更安全的网络实验</h4><p>因为 IPv6 的地址空间很大，所以如果你想在网络中尝试某些东西的时候，你可以使用 IPv6 子网进行实验，基本上你之后不会再用到这个子网了。</p><h4 id=原因十一为了运行自己的自治系统as>原因十一：为了运行自己的自治系统（AS）</h4><p>也有人说他们为了运行自己的自治系统（我在这篇 <a href=https://jvns.ca/blog/2021/10/05/tools-to-look-at-bgp-routes/>BGP 帖子</a> 中谈到了什么是 AS），因此在服务器中提供 IPv6。IPv4 地址太贵了，所以他们为运行自治系统而购买了 IPv6 地址。</p><h4 id=原因十二ipv6-更加安全>原因十二：IPv6 更加安全</h4><p>如果你的服务器 <em>只</em> 有公共的 IPv6 地址，那么攻击者扫描整个网络，也不能轻易地找出你的服务器地址，这是因为 IPv6 地址空间太大了以至于不能扫描出来！</p><p>这显然不能是你仅有的安全策略，但是这是安全上的一个大大的福利。每次我运行 IPv4 服务器时，我都会惊讶于 IPv4 地址一直能够被扫描出来的脆弱性，就像是老版本的 WordPress 博客系统那样。</p><h4 id=一个很傻的理由你可以在你的-ipv6-地址中放个小彩蛋>一个很傻的理由：你可以在你的 IPv6 地址中放个小彩蛋</h4><p>IPv6 地址中有很多额外的位，你可以用它们做一些不重要的事情。例如，Facebook 的 IPv6 地址之一是“2a03:2880:f10e:83:face:b00c:0:25de”（其中包含 <code>face:b00c</code>）。</p><h3 id=理由还有很多>理由还有很多</h3><p>这就是到目前为止我所了解的“为什么支持 IPv6？”的理由。</p><p>在我理解这些原因后，相较于以前，我在我的（非常小的）服务器上支持 IPv6 更有动力了。但那是因为我觉得支持 IPv6，对我来说只需要很少的努力。（现在我使用的是支持 IPv6 的 CDN，所以我基本上不用做什么额外的事情）</p><p>我仍然对 IPv6 知之甚少，但是在我的印象中，支持 IPv6 并不是不需要花费精力的，实际上可能需要大量工作。例如，我不知道 Twitter 在其边缘服务器上添加 IPv6 支持需要做多少繁杂的工作。</p><h3 id=其它关于-ipv6-的问题>其它关于 IPv6 的问题</h3><p>这里还有一些关于 IPv6 的问题，也许我之后再会探讨：</p><ul><li>支持 IPv6 的缺点是什么？什么会出错呢？</li><li>对于拥有了足够 IPv4 地址的 ISP 来说，有什么让他们提供 IPv6 的激励措施？（另一种问法是：我的 ISP 是否有可能在未来几年内转为支持 IPv6？或者他们可能不会支持 IPv6？）</li><li><a href=https://docs.digitalocean.com/products/networking/floating-ips/>Digital Ocean</a> （LCTT 译注：一家建立于美国的云基础架构提供商，面向软件开发人员提供虚拟专用服务器（VPS））只提供 IPv4 的浮动地址，不提供 IPv6 的浮动地址。为什么不提供呢？有更多 IPv6 地址，那提供 IPv6 的浮动地址不是变得更 <em>便捷</em> 吗？</li><li>当我尝试 ping IPv6 地址时（例如 <a href=http://example.com>example.com</a> 的 IP 地址<code>2606:2800:220:1:248:1893:25c8:1946</code>），我得到一个报错信息 <code>ping: connect: Network is unreachable</code>。这是为什么呢？（回答：因为我的 ISP 不支持 IPv6，所以我的电脑没有公共 IPv6 地址）</li></ul><p>这篇 <a href=https://tailscale.com/kb/1134/ipv6-faq/>来自 Tailscale 的 IPv4 与 IPv6 文章</a> 非常有意思，并回答了上述的一些问题。</p><hr><p>via: <a href=https://jvns.ca/blog/2022/01/29/reasons-for-servers-to-support-ipv6/>https://jvns.ca/blog/2022/01/29/reasons-for-servers-to-support-ipv6/</a></p><p>作者：<a href=https://jvns.ca/>Julia Evans</a> 选题：<a href=https://github.com/lujun9972>lujun9972</a> 译者：<a href=https://github.com/chai001125>chai001125</a> 校对：<a href=https://github.com/wxy>wxy</a></p><p>本文由 <a href=https://github.com/LCTT/TranslateProject>LCTT</a> 原创编译，<a href=https://linux.cn/>Linux中国</a> 荣誉推出</p></div><footer class=post__footer><div class="post__tags tags clearfix"><svg class="tags__badge icon icon-tag" width="16" height="16" viewBox="0 0 32 32"><path d="M32 19c0 1-1 2-1 2L21 31s-1 1-2 1-2-1-2-1L2 16c-1-1-1.4-2-1.4-2S0 12.5.0 11V3C0 1.5.8.8.8.8S1.5.0 3 0h8c1.5.0 3 .6 3 .6S15 1 16 2l15 15s1 1 1 2zM7 10a3 3 0 100-6 3 3 0 000 6z"/></svg><ul class=tags__list><li class=tags__item><a class="tags__link btn" href=/tags/ipv6/ rel=tag>IPv6</a></li></ul></div></footer></article></main></div></div><footer class=footer><div class="container footer__container flex"><div class=footer__copyright>&copy; 2025 Linux.cn Archive.
<span class=footer__copyright-credits>Generated with <a href=https://gohugo.io/ rel="nofollow noopener" target=_blank>Hugo</a> and <a href=https://github.com/Vimux/Mainroad/ rel="nofollow noopener" target=_blank>Mainroad</a> theme.</span></div></div></footer></div><script async defer src=/js/menu.js></script></body></html>