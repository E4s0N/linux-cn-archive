<!doctype html><html class=no-js lang=en><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><title>监控 Linux 容器性能的命令行神器 - Linux.cn Archive</title>
<script>(function(e,t){e[t]=e[t].replace("no-js","js")})(document.documentElement,"className")</script><meta name=description content><meta property="og:title" content="监控 Linux 容器性能的命令行神器"><meta property="og:description" content="ctop是一个新的基于命令行的工具，它可用于在容器层级监控进程。容器通过利用控制器组（cgroup）的资源管理功能，提供了操作系统层级的虚拟化环境。该工具从cgroup收集与内存、CPU、块输入输出的相关数据，以及拥有者、开机时间等元数据，并以人性化的格式呈现给用户，这样就可以快速对系统健康状况进行评估。基于所获得的数据，它可以尝试推测下层的容器技术。ctop也有助于在低内存环境中检测出谁在消耗大量的内存。 功能 ctop的一些功能如下：  收集CPU、内存和块输入输出的度量值 收集与拥有者、容器技术和任务统计相关的信息 通过任意"><meta property="og:type" content="article"><meta property="og:url" content="/article-5429-1.html"><meta property="article:section" content="posts"><meta property="article:published_time" content="2015-05-11T15:54:43+00:00"><meta property="article:modified_time" content="2015-05-11T15:54:43+00:00"><meta itemprop=name content="监控 Linux 容器性能的命令行神器"><meta itemprop=description content="ctop是一个新的基于命令行的工具，它可用于在容器层级监控进程。容器通过利用控制器组（cgroup）的资源管理功能，提供了操作系统层级的虚拟化环境。该工具从cgroup收集与内存、CPU、块输入输出的相关数据，以及拥有者、开机时间等元数据，并以人性化的格式呈现给用户，这样就可以快速对系统健康状况进行评估。基于所获得的数据，它可以尝试推测下层的容器技术。ctop也有助于在低内存环境中检测出谁在消耗大量的内存。 功能 ctop的一些功能如下：  收集CPU、内存和块输入输出的度量值 收集与拥有者、容器技术和任务统计相关的信息 通过任意"><meta itemprop=datePublished content="2015-05-11T15:54:43+00:00"><meta itemprop=dateModified content="2015-05-11T15:54:43+00:00"><meta itemprop=wordCount content="310"><meta itemprop=keywords content="Docker,容器,ctop,"><link rel=preconnect href=https://fonts.bunny.net crossorigin><link rel=dns-prefetch href=//fonts.bunny.net><link rel=dns-prefetch href=//fonts.bunny.net><link rel=stylesheet href="https://fonts.bunny.net/css?family=Open+Sans:400,400i,700"><link rel=stylesheet href=/css/style.css><link rel="shortcut icon" href=/favicon.ico></head><body class=body><div class="container container--outer"><header class=header><div class="container header__container"><div class=logo><a class=logo__link href=/ title="Linux.cn Archive" rel=home><div class="logo__item logo__text"><div class=logo__title>Linux.cn Archive</div></div></a></div><nav class=menu><button class=menu__btn aria-haspopup=true aria-expanded=false tabindex=0>
<span class=menu__btn-title tabindex=-1>Menu</span></button><ul class=menu__list><li class=menu__item><a class=menu__link href=/><span class=menu__text>Home</span></a></li><li class=menu__item><a class=menu__link href=/categories/><span class=menu__text>Categories</span></a></li><li class=menu__item><a class=menu__link href=/tags/><span class=menu__text>Tags</span></a></li><li class=menu__item><a class=menu__link href><span class=menu__text>RSS</span></a></li></ul></nav></div></header><div class="wrapper flex"><div class=primary><main class=main role=main><article class=post><header class=post__header><h1 class=post__title>监控 Linux 容器性能的命令行神器</h1><div class="post__meta meta"><div class="meta__item-datetime meta__item"><svg class="meta__icon icon icon-time" width="16" height="14" viewBox="0 0 30 28"><path d="M15 0C7 0 1 6 1 14s6 14 14 14 14-6 14-14S23 0 15 0zm0 25C9 25 4 20 4 14S9 3 15 3s11 5 11 11-5 11-11 11zm1-18h-2v8.4l6.8 4.4L22 18l-6-3.8V7z"/></svg><time class=meta__text datetime=2015-05-11T15:54:43Z>May 11, 2015</time></div></div></header><div class="content post__content clearfix"><p>ctop是一个新的基于命令行的工具，它可用于在容器层级监控进程。容器通过利用控制器组（cgroup）的资源管理功能，提供了操作系统层级的虚拟化环境。该工具从cgroup收集与内存、CPU、块输入输出的相关数据，以及拥有者、开机时间等元数据，并以人性化的格式呈现给用户，这样就可以快速对系统健康状况进行评估。基于所获得的数据，它可以尝试推测下层的容器技术。ctop也有助于在低内存环境中检测出谁在消耗大量的内存。</p><h3 id=功能>功能</h3><p>ctop的一些功能如下：</p><ul><li>收集CPU、内存和块输入输出的度量值</li><li>收集与拥有者、容器技术和任务统计相关的信息</li><li>通过任意栏对信息排序</li><li>以树状视图显示信息</li><li>折叠/展开cgroup树</li><li>选择并跟踪cgroup/容器</li><li>选择显示数据刷新的时间窗口</li><li>暂停刷新数据</li><li>检测基于systemd、Docker和LXC的容器</li><li>基于Docker和LXC的容器的高级特性<ul><li>打开/连接shell以进行深度诊断</li><li>停止/杀死容器类型</li></ul></li></ul><h3 id=安装>安装</h3><p><strong>ctop</strong>是由Python写成的，因此，除了需要Python 2.6或其更高版本外（带有内建的光标支持），别无其它外部依赖。推荐使用Python的pip进行安装，如果还没有安装pip，请先安装，然后使用pip安装ctop。</p><p><em>注意：本文样例来自Ubuntu（14.10）系统</em></p><pre tabindex=0><code>$ sudo apt-get install python-pip
</code></pre><p>使用pip安装ctop：</p><pre tabindex=0><code>poornima@poornima-Lenovo:~$ sudo pip install ctop

[sudo] password for poornima:

Downloading/unpacking ctop

Downloading ctop-0.4.0.tar.gz

Running setup.py (path:/tmp/pip_build_root/ctop/setup.py) egg_info for package ctop

Installing collected packages: ctop

Running setup.py install for ctop

changing mode of build/scripts-2.7/ctop from 644 to 755

changing mode of /usr/local/bin/ctop to 755

Successfully installed ctop

Cleaning up...
</code></pre><p>如果不选择使用pip安装，你也可以使用wget直接从github安装：</p><pre tabindex=0><code>poornima@poornima-Lenovo:~$ wget https://raw.githubusercontent.com/yadutaf/ctop/master/cgroup_top.py -O ctop

--2015-04-29 19:32:53-- https://raw.githubusercontent.com/yadutaf/ctop/master/cgroup_top.py

Resolving raw.githubusercontent.com (raw.githubusercontent.com)... 199.27.78.133

Connecting to raw.githubusercontent.com (raw.githubusercontent.com)|199.27.78.133|:443... connected.

HTTP request sent, awaiting response... 200 OK Length: 27314 (27K) [text/plain]

Saving to: ctop

100%[======================================&gt;] 27,314 --.-K/s in 0s

2015-04-29 19:32:59 (61.0 MB/s) - ctop saved [27314/27314]
</code></pre><hr><pre tabindex=0><code>poornima@poornima-Lenovo:~$ chmod +x ctop
</code></pre><p>如果cgroup-bin包没有安装，你可能会碰到一个错误消息，你可以通过安装需要的包来解决。</p><pre tabindex=0><code>poornima@poornima-Lenovo:~$ ./ctop

[ERROR] Failed to locate cgroup mountpoints.

poornima@poornima-Lenovo:~$ sudo apt-get install cgroup-bin
</code></pre><p>下面是ctop的输出样例：</p><p><img src=/data/attachment/album/201505/11/155445sj0ir9xdtx3cwfr9.png alt="ctop screen"></p><p><em>ctop屏幕</em></p><h3 id=用法选项>用法选项</h3><pre tabindex=0><code>ctop [--tree] [--refresh=] [--columns=] [--sort-col=] [--follow=] [--fold=, ...] ctop (-h | --help)
</code></pre><p>当你进入ctop屏幕，可使用上（↑）和下（↓）箭头键在容器间导航。点击某个容器就选定了该容器，按q或Ctrl+C退出该容器。</p><p>现在，让我们来看看上面列出的那一堆选项究竟是怎么用的吧。</p><p><strong>-h / &ndash;help - 显示帮助信息</strong></p><pre tabindex=0><code>poornima@poornima-Lenovo:~$ ctop -h
Usage: ctop [options]

Options:
-h, --help show this help message and exit
--tree show tree view by default
--refresh=REFRESH Refresh display every &lt;seconds&gt;
--follow=FOLLOW Follow cgroup path
--columns=COLUMNS List of optional columns to display. Always includes
&#39;name&#39;
--sort-col=SORT_COL Select column to sort by initially. Can be changed
dynamically.
</code></pre><p><strong>&ndash;tree - 显示容器的树形视图</strong></p><p>默认情况下，会显示列表视图</p><p>当你进入ctop窗口，你可以使用F5按钮在树状/列表视图间切换。</p><p><strong>&ndash;fold= - 在树形视图中折叠名为 的 cgroup 路径</strong></p><p>该选项需要与 &ndash;tree 选项组合使用。</p><p>例子: ctop &ndash;tree &ndash;fold=/user.slice</p><p><img src=/data/attachment/album/201505/11/155445wibankkerjy2iee2.png alt="Output of &lsquo;ctop &ndash;fold&rsquo;"></p><p><em>&lsquo;ctop &ndash;fold&rsquo;的输出</em></p><p>在ctop窗口中，使用+/-键来展开或折叠子cgroup。</p><p>注意：在写本文时，pip仓库中还没有最新版的ctop，还不支持命令行的‘&ndash;fold’选项</p><p><strong>&ndash;follow= - 跟踪/高亮 cgroup 路径</strong></p><p>例子: ctop &ndash;follow=/user.slice/user-1000.slice</p><p>正如你在下面屏幕中所见到的那样，带有“/user.slice/user-1000.slice”路径的cgroup被高亮显示，这让用户易于跟踪，就算显示位置变了也一样。</p><p><img src=/data/attachment/album/201505/11/155446sldaxvluru2xbzwl.png alt="Output of &lsquo;ctop &ndash;follow&rsquo;"></p><p><em>&lsquo;ctop &ndash;follow&rsquo;的输出</em></p><p>你也可以使用‘f’按钮来让高亮的行跟踪选定的容器。默认情况下，跟踪是关闭的。</p><p><strong>&ndash;refresh= - 按指定频率刷新显示，默认1秒</strong></p><p>这对于按每用户需求来显示改变刷新率时很有用。使用‘p’按钮可以暂停刷新并选择文本。</p><p><strong>&ndash;columns= - 限定只显示选定的列。&rsquo;name&rsquo; 需要是第一个字段，其后跟着其它字段。默认情况下，字段包括：owner, processes,memory, cpu-sys, cpu-user, blkio, cpu-time</strong></p><p>例子: ctop &ndash;columns=name,owner,type,memory</p><p><img src=/data/attachment/album/201505/11/155447eljdiaz27t0jt7az.png alt="Output of &lsquo;ctop &ndash;column&rsquo;"></p><p><em>&lsquo;ctop &ndash;column&rsquo;的输出</em></p><p><strong>-sort-col= - 按指定的列排序。默认使用 cpu-user 排序</strong></p><p>例子: ctop &ndash;sort-col=blkio</p><p>如果有Docker和LXC支持的额外容器，跟踪选项也是可用的：</p><pre tabindex=0><code>press &#39;a&#39; - 接驳到终端输出

press &#39;e&#39; - 打开容器中的一个 shell

press &#39;s&#39; - 停止容器 (SIGTERM)

press &#39;k&#39; - 杀死容器 (SIGKILL)
</code></pre><p>目前 Jean-Tiare Le Bigot 还在积极开发 <a href=https://github.com/yadutaf/ctop>ctop</a> 中，希望我们能在该工具中见到像本地 top 命令一样的特性 :-)</p><hr><p>via: <a href=http://linoxide.com/how-tos/monitor-linux-containers-performance/>http://linoxide.com/how-tos/monitor-linux-containers-performance/</a></p><p>作者：<a href=http://linoxide.com/author/bnpoornima/>B N Poornima</a> 译者：<a href=https://github.com/GOLinux>GOLinux</a> 校对：<a href=https://github.com/wxy>wxy</a></p><p>本文由 <a href=https://github.com/LCTT/TranslateProject>LCTT</a> 原创翻译，<a href=https://linux.cn/>Linux中国</a> 荣誉推出</p></div><footer class=post__footer><div class="post__tags tags clearfix"><svg class="tags__badge icon icon-tag" width="16" height="16" viewBox="0 0 32 32"><path d="M32 19c0 1-1 2-1 2L21 31s-1 1-2 1-2-1-2-1L2 16c-1-1-1.4-2-1.4-2S0 12.5.0 11V3C0 1.5.8.8.8.8S1.5.0 3 0h8c1.5.0 3 .6 3 .6S15 1 16 2l15 15s1 1 1 2zM7 10a3 3 0 100-6 3 3 0 000 6z"/></svg><ul class=tags__list><li class=tags__item><a class="tags__link btn" href=/tags/docker/ rel=tag>Docker</a></li><li class=tags__item><a class="tags__link btn" href=/tags/%E5%AE%B9%E5%99%A8/ rel=tag>容器</a></li><li class=tags__item><a class="tags__link btn" href=/tags/ctop/ rel=tag>ctop</a></li></ul></div></footer></article></main></div></div><footer class=footer><div class="container footer__container flex"><div class=footer__copyright>&copy; 2025 Linux.cn Archive.
<span class=footer__copyright-credits>Generated with <a href=https://gohugo.io/ rel="nofollow noopener" target=_blank>Hugo</a> and <a href=https://github.com/Vimux/Mainroad/ rel="nofollow noopener" target=_blank>Mainroad</a> theme.</span></div></div></footer></div><script async defer src=/js/menu.js></script></body></html>