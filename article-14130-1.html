<!doctype html><html class=no-js lang=en><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><title>一个小时内创建一个 CentOS 家庭实验室 - Linux.cn Archive</title>
<script>(function(e,t){e[t]=e[t].replace("no-js","js")})(document.documentElement,"className")</script><meta name=description content><meta property="og:title" content="一个小时内创建一个 CentOS 家庭实验室"><meta property="og:description" content="用一个带有虚拟化软件的系统（CentOS ISO），花费一个小时左右来设置一套自给自足的基本 Linux 服务器。"><meta property="og:type" content="article"><meta property="og:url" content="/article-14130-1.html"><meta property="article:section" content="posts"><meta property="article:published_time" content="2021-12-30T09:37:46+00:00"><meta property="article:modified_time" content="2021-12-30T09:37:46+00:00"><meta itemprop=name content="一个小时内创建一个 CentOS 家庭实验室"><meta itemprop=description content="用一个带有虚拟化软件的系统（CentOS ISO），花费一个小时左右来设置一套自给自足的基本 Linux 服务器。"><meta itemprop=datePublished content="2021-12-30T09:37:46+00:00"><meta itemprop=dateModified content="2021-12-30T09:37:46+00:00"><meta itemprop=wordCount content="255"><meta itemprop=keywords content="家庭实验室,"><link rel=preconnect href=https://fonts.bunny.net crossorigin><link rel=dns-prefetch href=//fonts.bunny.net><link rel=dns-prefetch href=//fonts.bunny.net><link rel=stylesheet href="https://fonts.bunny.net/css?family=Open+Sans:400,400i,700"><link rel=stylesheet href=/css/style.css><link rel="shortcut icon" href=/favicon.ico></head><body class=body><div class="container container--outer"><header class=header><div class="container header__container"><div class=logo><a class=logo__link href=/ title="Linux.cn Archive" rel=home><div class="logo__item logo__text"><div class=logo__title>Linux.cn Archive</div></div></a></div><nav class=menu><button class=menu__btn aria-haspopup=true aria-expanded=false tabindex=0>
<span class=menu__btn-title tabindex=-1>Menu</span></button><ul class=menu__list><li class=menu__item><a class=menu__link href=/><span class=menu__text>Home</span></a></li><li class=menu__item><a class=menu__link href=/categories/><span class=menu__text>Categories</span></a></li><li class=menu__item><a class=menu__link href=/tags/><span class=menu__text>Tags</span></a></li><li class=menu__item><a class=menu__link href><span class=menu__text>RSS</span></a></li></ul></nav></div></header><div class="wrapper flex"><div class=primary><main class=main role=main><article class=post><header class=post__header><h1 class=post__title>一个小时内创建一个 CentOS 家庭实验室</h1><div class="post__meta meta"><div class="meta__item-datetime meta__item"><svg class="meta__icon icon icon-time" width="16" height="14" viewBox="0 0 30 28"><path d="M15 0C7 0 1 6 1 14s6 14 14 14 14-6 14-14S23 0 15 0zm0 25C9 25 4 20 4 14S9 3 15 3s11 5 11 11-5 11-11 11zm1-18h-2v8.4l6.8 4.4L22 18l-6-3.8V7z"/></svg><time class=meta__text datetime=2021-12-30T09:37:46Z>December 30, 2021</time></div></div></header><div class="content post__content clearfix"><blockquote><p>用一个带有虚拟化软件的系统（CentOS ISO），花费一个小时左右来设置一套自给自足的基本 Linux 服务器。</p></blockquote><p><img src=https://img.linux.net.cn/data/attachment/album/202112/30/093738krqqc3c5mc35lu36.jpg alt title="metrics and data shown on a computer screen"></p><p>当学习新的 Linux 技能时（或像我一样学习 Linux 认证），在笔记本电脑上有一些可用的虚拟机（VM）是很有帮助的，这样你就可以在上面学习。</p><p>但是，如果在没有良好互联网连接的地方，你却想在一个 Web 服务器上工作，该怎么办? 想要使用没有安装过的其他软件，该怎么办? 如果需要从发行版的存储库中下载它，那么你可能会碰壁。只要做一点准备，你就可以设置一个 <a href=https://opensource.com/article/19/3/home-lab>家庭实验室</a>，你就在任何地方安装所需的任何东西，无论是否有网络连接。</p><p>要求如下：</p><ul><li>一个你打算使用的已下载的 Linux 发行版（例如，CentOS、Red Hat 等）ISO 文件</li><li>一台具有虚拟化功能的主机。这里使用带有 <a href=https://en.wikipedia.org/wiki/Kernel-based_Virtual_Machine>KVM</a> 和 <a href=https://virt-manager.org/>virt-manager</a> 的 <a href=https://getfedora.org/>Fedora</a>，但其它 Linux 也可以类似工作。你甚至可以使用 Windows 或 Mac 进行虚拟化，但在实现方面存在一些差异</li><li>大约一个小时</li></ul><h3 id=1为存储主机创建一个虚拟机>1、为存储主机创建一个虚拟机</h3><p>使用 <code>virt-manager</code> 创建一个中等规格的虚拟机：1GB RAM、一个 CPU 和 16GB 磁盘空间就足够。</p><p>在虚拟机上安装 <a href=https://www.centos.org/download/>CentOS 7</a>。</p><p><img src=https://img.linux.net.cn/data/attachment/album/202112/30/093749xz3sahijwwgxojw4.png alt="Installing a CentOS homelab" title="Installing a CentOS homelab"></p><p>选择你的语言并继续。</p><p>单击 “ 安装位置 Installation Destination ”，选择本地磁盘，勾选 “ 自动配置分区 Automatically Configure Partitioning ” 复选框，然后单击左上角的 “ 完成 Done ”。</p><p>在 “ 软件选择 Software Selection ” 下，选中 “ 基础设施服务器 Infrastructure Server ” ，选中 “ FTP 服务器 FTP Server ” 复选框，然后单击 “ 完成 Done ”。</p><p><img src=https://img.linux.net.cn/data/attachment/album/202112/30/093749f6r777pgrekz9yy1.png alt="Installing a CentOS homelab" title="Installing a CentOS homelab"></p><p>选择 “ 网络和主机名 Network and Host Name ”，启用右上方的 “ 以太网 Ethernet ” ，然后单击左上角的 “ 完成 Done ”。</p><p>单击 “ 开始安装 Begin Installation ” 开始安装操作系统。</p><p>在安装时务必设置一个 root 密码，就可以创建一个带有密码的用户。</p><h3 id=2启动-ftp-服务>2、启动 FTP 服务</h3><p>下一步是启动并设置 FTP 服务以运行并允许它通过防火墙。</p><p>用 root 密码登录，然后启动 FTP 服务器：</p><pre tabindex=0><code>systemctl start vsftpd
</code></pre><p>允许它在每次启动时都能工作：</p><pre tabindex=0><code>systemctl enable vsftpd
</code></pre><p>设置防火墙允许通过的端口：</p><pre tabindex=0><code>firewall-cmd --add-service=ftp --perm
</code></pre><p>立即启用此更改：</p><pre tabindex=0><code>firewall-cmd --reload
</code></pre><p>获取你的 IP 地址：</p><pre tabindex=0><code>ip a
</code></pre><p>（可能是 <code>eth0</code>），在之后会用到。</p><h3 id=3复制本地存储库中的文件>3、复制本地存储库中的文件</h3><p>通过虚拟化软件将安装 CD 挂载到虚拟机。</p><p>创建待挂载光盘的临时目录:</p><pre tabindex=0><code>mkdir /root/temp
</code></pre><p>挂载安装 CD：</p><pre tabindex=0><code>mount /dev/cdrom /root/temp
</code></pre><p>将所有文件复制到 FTP 服务器目录下:</p><pre tabindex=0><code>rsync -avhP /root/temp/ /var/ftp/pub/
</code></pre><h3 id=4将服务器指向本地存储库>4、将服务器指向本地存储库</h3><p>基于 Red hat 的系统使用以 <code>repo</code> 结尾的文件来确定从哪里获得软件更新和新的软件。这些文件在以下路径</p><pre tabindex=0><code>cd /etc/yum.repos.d
</code></pre><p>你需要摆脱那些使你的服务器在互联网上寻找 CentOS 存储库的存储库文件。可以把它们复制到根目录下保存起来：</p><pre tabindex=0><code>mv * ~
</code></pre><p>然后创建一个新的存储库文件来指向你的服务器。使用常用的文本编辑器创建一个名为 <code>network.repo</code> 文件，输入以下内容（将 <code>&lt;your IP></code> 替换为在步骤 2 中获得的 IP 地址），然后保存：</p><pre tabindex=0><code>[network]
name=network
baseurl=ftp://192.168.122.&lt;your ip&gt;/pub
gpgcheck=0
</code></pre><p>完成后，可以用下面的命令来测试：</p><pre tabindex=0><code>yum clean all; yum install ftp
</code></pre><p>如果 FTP 客户端按照预期从 “network” 存储库安装，那么本地仓库就已经设置好了！</p><p><img src=https://img.linux.net.cn/data/attachment/album/202112/30/093749oin3xj5nkjtq5qrk.png alt="Installing a CentOS homelab" title="Installing a CentOS homelab"></p><h3 id=5使用你设置的存储库安装一个新的虚拟机>5、使用你设置的存储库安装一个新的虚拟机</h3><p>回到虚拟机管理器，并创建另一个虚拟机。但这一次，选择 “ 网络安装 Network Install ”， URL 为：</p><pre tabindex=0><code>ftp://192.168.122.&lt;your IP&gt;/pub
</code></pre><p>如果你使用的是不同的宿主机操作系统或虚拟管理器，像前面一样安装虚拟机，并进行下一步。</p><h3 id=6将新的虚拟机设置为使用现有的network存储库>6、将新的虚拟机设置为使用现有的“network”存储库</h3><p>你可以从现有服务器复制存储库文件到这里使用。</p><p>和第一个服务器示例一样，输入：</p><pre tabindex=0><code>cd /etc/yum.repos.d
mv * ~
</code></pre><p>然后：</p><pre tabindex=0><code>scp root@192.168.122.&lt;your IP&gt;:/etc/yum.repos.d/network.repo /etc/yum.repos.d
</code></pre><p>现在可以使用新的虚拟机并从本地存储库获取所有软件了。</p><p>再测试一遍：</p><pre tabindex=0><code>yum clean all; yum install screen
</code></pre><p>这将从本地存储服务器安装软件。</p><p>这种设置，让你能够脱离网络安装软件，创建一个更可靠的环境，扩展你的技能。</p><hr><p>via: <a href=https://opensource.com/article/19/6/create-centos-homelab-hour>https://opensource.com/article/19/6/create-centos-homelab-hour</a></p><p>作者：<a href=https://opensource.com/users/murph>Bob Murphy</a> 选题：<a href=https://github.com/lujun9972>lujun9972</a> 译者：<a href=https://github.com/JaphiaChen>JaphiaChen</a> 校对：<a href=https://github.com/wxy>wxy</a></p><p>本文由 <a href=https://github.com/LCTT/TranslateProject>LCTT</a> 原创编译，<a href=https://linux.cn/>Linux中国</a> 荣誉推出</p></div><footer class=post__footer><div class="post__tags tags clearfix"><svg class="tags__badge icon icon-tag" width="16" height="16" viewBox="0 0 32 32"><path d="M32 19c0 1-1 2-1 2L21 31s-1 1-2 1-2-1-2-1L2 16c-1-1-1.4-2-1.4-2S0 12.5.0 11V3C0 1.5.8.8.8.8S1.5.0 3 0h8c1.5.0 3 .6 3 .6S15 1 16 2l15 15s1 1 1 2zM7 10a3 3 0 100-6 3 3 0 000 6z"/></svg><ul class=tags__list><li class=tags__item><a class="tags__link btn" href=/tags/%E5%AE%B6%E5%BA%AD%E5%AE%9E%E9%AA%8C%E5%AE%A4/ rel=tag>家庭实验室</a></li></ul></div></footer></article></main></div></div><footer class=footer><div class="container footer__container flex"><div class=footer__copyright>&copy; 2025 Linux.cn Archive.
<span class=footer__copyright-credits>Generated with <a href=https://gohugo.io/ rel="nofollow noopener" target=_blank>Hugo</a> and <a href=https://github.com/Vimux/Mainroad/ rel="nofollow noopener" target=_blank>Mainroad</a> theme.</span></div></div></footer></div><script async defer src=/js/menu.js></script></body></html>