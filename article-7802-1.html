<!doctype html><html class=no-js lang=en><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><title>17 个 tar 命令实用示例 - Linux.cn Archive</title>
<script>(function(e,t){e[t]=e[t].replace("no-js","js")})(document.documentElement,"className")</script><meta name=description content><meta property="og:title" content="17 个 tar 命令实用示例"><meta property="og:description" content="Tar 是类 Unix 系统中使用最广泛的命令，用于归档多个文件或目录到单个归档文件中，并且归档文件可以进一步使用 gzip 或者 bzip2 等技术进行压缩。"><meta property="og:type" content="article"><meta property="og:url" content="/article-7802-1.html"><meta property="article:section" content="posts"><meta property="article:published_time" content="2016-09-24T08:59:00+00:00"><meta property="article:modified_time" content="2016-09-24T08:59:00+00:00"><meta itemprop=name content="17 个 tar 命令实用示例"><meta itemprop=description content="Tar 是类 Unix 系统中使用最广泛的命令，用于归档多个文件或目录到单个归档文件中，并且归档文件可以进一步使用 gzip 或者 bzip2 等技术进行压缩。"><meta itemprop=datePublished content="2016-09-24T08:59:00+00:00"><meta itemprop=dateModified content="2016-09-24T08:59:00+00:00"><meta itemprop=wordCount content="917"><meta itemprop=keywords content="tar,压缩,归档,"><link rel=preconnect href=https://fonts.bunny.net crossorigin><link rel=dns-prefetch href=//fonts.bunny.net><link rel=dns-prefetch href=//fonts.bunny.net><link rel=stylesheet href="https://fonts.bunny.net/css?family=Open+Sans:400,400i,700"><link rel=stylesheet href=/css/style.css><link rel="shortcut icon" href=/favicon.ico></head><body class=body><div class="container container--outer"><header class=header><div class="container header__container"><div class=logo><a class=logo__link href=/ title="Linux.cn Archive" rel=home><div class="logo__item logo__text"><div class=logo__title>Linux.cn Archive</div></div></a></div><nav class=menu><button class=menu__btn aria-haspopup=true aria-expanded=false tabindex=0>
<span class=menu__btn-title tabindex=-1>Menu</span></button><ul class=menu__list><li class=menu__item><a class=menu__link href=/><span class=menu__text>Home</span></a></li><li class=menu__item><a class=menu__link href=/categories/><span class=menu__text>Categories</span></a></li><li class=menu__item><a class=menu__link href=/tags/><span class=menu__text>Tags</span></a></li><li class=menu__item><a class=menu__link href><span class=menu__text>RSS</span></a></li></ul></nav></div></header><div class="wrapper flex"><div class=primary><main class=main role=main><article class=post><header class=post__header><h1 class=post__title>17 个 tar 命令实用示例</h1><div class="post__meta meta"><div class="meta__item-datetime meta__item"><svg class="meta__icon icon icon-time" width="16" height="14" viewBox="0 0 30 28"><path d="M15 0C7 0 1 6 1 14s6 14 14 14 14-6 14-14S23 0 15 0zm0 25C9 25 4 20 4 14S9 3 15 3s11 5 11 11-5 11-11 11zm1-18h-2v8.4l6.8 4.4L22 18l-6-3.8V7z"/></svg><time class=meta__text datetime=2016-09-24T08:59:00Z>September 24, 2016</time></div></div></header><div class="content post__content clearfix"><p>Tar（Tape ARchive，磁带归档的缩写，LCTT 译注：最初设计用于将文件打包到磁带上，现在我们大都使用它来实现备份某个分区或者某些重要的目录）是类 Unix 系统中使用最广泛的命令，用于归档多个文件或目录到单个归档文件中，并且归档文件可以进一步使用 gzip 或者 bzip2 等技术进行压缩。换言之，tar 命令也可以用于备份：先是归档多个文件和目录到一个单独的 tar 文件或归档文件，然后在需要之时将 tar 文件中的文件和目录释放出来。</p><p><img src=/data/attachment/album/201609/24/070653f5wz5iaaj9ywjfyt.jpg alt></p><p>本文将介绍 tar 的 17 个实用示例。</p><p>tar 命令语法如下：</p><pre tabindex=0><code># tar &lt;选项&gt; &lt;文件&gt;
</code></pre><p>下面列举 tar 命令中一些常用的选项：</p><blockquote><p>&ndash;delete : 从归档文件 (而非磁带) 中删除</p><p>-r, &ndash;append : 将文件追加到归档文件中</p><p>-t, &ndash;list : 列出归档文件中包含的内容</p><p>&ndash;test-label : 测试归档文件卷标并退出</p><p>-u, &ndash;update : 将已更新的文件追加到归档文件中</p><p>-x, &ndash;extract, &ndash;get : 释放归档文件中文件及目录</p><p>-C, &ndash;directory=DIR : 执行归档动作前变更工作目录到 DIR</p><p>-f, &ndash;file=ARCHIVE : 指定 (将要创建或已存在的) 归档文件名</p><p>-j, &ndash;bip2 : 对归档文件使用 bzip2 压缩</p><p>-J, &ndash;xz : 对归档文件使用 xz 压缩</p><p>-p, &ndash;preserve-permissions : 保留原文件的访问权限</p><p>-v, &ndash;verbose : 显示命令整个执行过程</p><p>-z, gzip : 对归档文件使用 gzip 压缩</p></blockquote><p>注 : 在 tar 命令选项中的连接符 <code>-</code> 是可选的（LCTT 译注：不用 <code>-</code> 也没事。这在 GNU 软件里面很罕见，大概是由于 tar 命令更多受到古老的 UNIX 风格影响）。</p><h3 id=示例-1创建一个-tar-归档文件>示例 1：创建一个 tar 归档文件</h3><p>现在来创建一个 tar 文件，将 /etc/ 目录和 /root/anaconda-ks.cfg 文件打包进去。</p><pre tabindex=0><code>[root@linuxtechi ~]# tar -cvf myarchive.tar /etc /root/anaconda-ks.cfg
</code></pre><p>以上命令会在当前目录创建一个名为 &ldquo;myarchive&rdquo; 的 tar 文件，内含 /etc/ 目录和 /root/anaconda-ks.cfg 文件。</p><p>其中，<code>-c</code> 选项表示要创建 tar 文件，<code>-v</code> 选项用于输出 tar 的详细过程到屏幕上，<code>-f</code> 选项则是指定归档文件名称。</p><pre tabindex=0><code>[root@linuxtechi ~]# ls -l myarchive.tar
-rw-r--r--. 1 root root 22947840 Sep 7 00:24 myarchive.tar
[root@linuxtechi ~]#
</code></pre><h3 id=示例-2列出归档文件中的内容>示例 2：列出归档文件中的内容</h3><p>在 tar 命令中使用 <code>–t</code> 选项可以不用释放其中的文件就可以快速列出文件中包含的内容。</p><pre tabindex=0><code>[root@linuxtechi ~]# tar -tvf myarchive.tar
</code></pre><p>列出 tar 文件中的指定的文件和目录。下列命令尝试查看 anaconda-ks.cfg 文件是否存在于 tar 文件中。</p><pre tabindex=0><code>[root@linuxtechi ~]# tar -tvf myarchive.tar root/anaconda-ks.cfg
-rw------- root/root 953 2016-08-24 01:33 root/anaconda-ks.cfg
[root@linuxtechi ~]#
</code></pre><h3 id=示例-3追加文件到归档tar文件中>示例 3：追加文件到归档（tar）文件中</h3><p><code>-r</code> 选项用于向已有的 tar 文件中追加文件。下面来将 /etc/fstab 添加到 data.tar 中。</p><pre tabindex=0><code>[root@linuxtechi ~]# tar -rvf data.tar /etc/fstab
</code></pre><p>注：在压缩过的 tar 文件中无法进行追加文件操作。</p><h3 id=示例-4从-tar-文件中释放文件以及目录>示例 4：从 tar 文件中释放文件以及目录</h3><p><code>-x</code> 选项用于释放出 tar 文件中的文件和目录。下面来释放上边创建的 tar 文件中的内容。</p><pre tabindex=0><code>[root@linuxtechi ~]# tar -xvf myarchive.tar
</code></pre><p>这个命令会在当前目录中释放出 myarchive.tar 文件中的内容。</p><h3 id=示例-5释放-tar-文件到指定目录>示例 5：释放 tar 文件到指定目录</h3><p>假如你想要释放 tar 文件中的内容到指定的文件夹或者目录，使用 <code>-C</code> 选项后边加上指定的文件的路径。</p><pre tabindex=0><code>[root@linuxtechi ~]# tar -xvf myarchive.tar -C /tmp/
</code></pre><h3 id=示例-6释放-tar-文件中的指定文件或目录>示例 6：释放 tar 文件中的指定文件或目录</h3><p>假设你只要释放 tar 文件中的 anaconda-ks.cfg 到 /tmp 目录。</p><p>语法如下：</p><pre tabindex=0><code># tar –xvf {tar-file } {file-to-be-extracted } -C {path-where-to-extract}

[root@linuxtechi tmp]# tar -xvf /root/myarchive.tar root/anaconda-ks.cfg -C /tmp/
root/anaconda-ks.cfg
[root@linuxtechi tmp]# ls -l /tmp/root/anaconda-ks.cfg
-rw-------. 1 root root 953 Aug 24 01:33 /tmp/root/anaconda-ks.cfg
[root@linuxtechi tmp]#
</code></pre><h3 id=示例-7创建并压缩归档文件targz-或-tgz>示例 7：创建并压缩归档文件（.tar.gz 或 .tgz）</h3><p>假设我们需要打包 /etc 和 /opt 文件夹，并用 gzip 工具将其压缩。可以在 tar 命令中使用 <code>-z</code> 选项来实现。这种 tar 文件的扩展名可以是 .tar.gz 或者 .tgz。</p><pre tabindex=0><code>[root@linuxtechi ~]# tar -zcpvf myarchive.tar.gz /etc/ /opt/
</code></pre><p>或</p><pre tabindex=0><code>[root@linuxtechi ~]# tar -zcpvf myarchive.tgz /etc/ /opt/
</code></pre><h3 id=示例-8创建并压缩归档文件tarbz2-或-tbz2>示例 8：创建并压缩归档文件（.tar.bz2 或 .tbz2）</h3><p>假设我们需要打包 /etc 和 /opt 文件夹，并使用 bzip2 压缩。可以在 tar 命令中使用 <code>-j</code> 选项来实现。这种 tar 文件的扩展名可以是 .tar.bz2 或者 .tbz。</p><pre tabindex=0><code>[root@linuxtechi ~]# tar -jcpvf myarchive.tar.bz2 /etc/ /opt/
</code></pre><p>或</p><pre tabindex=0><code>[root@linuxtechi ~]# tar -jcpvf myarchive.tbz2 /etc/ /opt/
</code></pre><h3 id=示例-9排除指定文件或类型后创建-tar-文件>示例 9：排除指定文件或类型后创建 tar 文件</h3><p>创建 tar 文件时在 tar 命令中使用 <code>–exclude</code> 选项来排除指定文件或者类型。假设在创建压缩的 tar 文件时要排除 .html 文件。</p><pre tabindex=0><code>[root@linuxtechi ~]# tar -zcpvf myarchive.tgz /etc/ /opt/ --exclude=*.html
</code></pre><h3 id=示例-10列出-targz-或-tgz-文件中的内容>示例 10：列出 .tar.gz 或 .tgz 文件中的内容</h3><p>使用 <code>-t</code> 选项可以查看 .tar.gz 或 .tgz 文件中内容。如下：</p><pre tabindex=0><code>[root@linuxtechi ~]# tar -tvf myarchive.tgz  | more
.............................................
drwxr-xr-x root/root         0 2016-09-07 08:41 etc/
-rw-r--r-- root/root       541 2016-08-24 01:23 etc/fstab
-rw------- root/root         0 2016-08-24 01:23 etc/crypttab
lrwxrwxrwx root/root         0 2016-08-24 01:23 etc/mtab -&gt; /proc/self/mounts
-rw-r--r-- root/root       149 2016-09-07 08:41 etc/resolv.conf
drwxr-xr-x root/root         0 2016-09-06 03:55 etc/pki/
drwxr-xr-x root/root         0 2016-09-06 03:15 etc/pki/rpm-gpg/
-rw-r--r-- root/root      1690 2015-12-09 04:59 etc/pki/rpm-gpg/RPM-GPG-KEY-CentOS-7
-rw-r--r-- root/root      1004 2015-12-09 04:59 etc/pki/rpm-gpg/RPM-GPG-KEY-CentOS-Debug-7
-rw-r--r-- root/root      1690 2015-12-09 04:59 etc/pki/rpm-gpg/RPM-GPG-KEY-CentOS-Testing-7
-rw-r--r-- root/root      3140 2015-09-15 06:53 etc/pki/rpm-gpg/RPM-GPG-KEY-foreman
..........................................................
</code></pre><h3 id=示例-11列出-tarbz2-或-tbz2-文件中的内容>示例 11：列出 .tar.bz2 或 .tbz2 文件中的内容</h3><p>使用 <code>-t</code> 选项可以查看 .tar.bz2 或 .tbz2 文件中内容。如下：</p><pre tabindex=0><code>[root@linuxtechi ~]# tar -tvf myarchive.tbz2  | more
........................................................
rwxr-xr-x root/root         0 2016-08-24 01:25 etc/pki/java/
lrwxrwxrwx root/root         0 2016-08-24 01:25 etc/pki/java/cacerts -&gt; /etc/pki/ca-trust/extracted/java/cacerts
drwxr-xr-x root/root         0 2016-09-06 02:54 etc/pki/nssdb/
-rw-r--r-- root/root     65536 2010-01-12 15:09 etc/pki/nssdb/cert8.db
-rw-r--r-- root/root      9216 2016-09-06 02:54 etc/pki/nssdb/cert9.db
-rw-r--r-- root/root     16384 2010-01-12 16:21 etc/pki/nssdb/key3.db
-rw-r--r-- root/root     11264 2016-09-06 02:54 etc/pki/nssdb/key4.db
-rw-r--r-- root/root       451 2015-10-21 09:42 etc/pki/nssdb/pkcs11.txt
-rw-r--r-- root/root     16384 2010-01-12 15:45 etc/pki/nssdb/secmod.db
drwxr-xr-x root/root         0 2016-08-24 01:26 etc/pki/CA/
drwxr-xr-x root/root         0 2015-06-29 08:48 etc/pki/CA/certs/
drwxr-xr-x root/root         0 2015-06-29 08:48 etc/pki/CA/crl/
drwxr-xr-x root/root         0 2015-06-29 08:48 etc/pki/CA/newcerts/
drwx------ root/root         0 2015-06-29 08:48 etc/pki/CA/private/
drwx------ root/root         0 2015-11-20 06:34 etc/pki/rsyslog/
drwxr-xr-x root/root         0 2016-09-06 03:44 etc/pki/pulp/
..............................................................
</code></pre><h3 id=示例-12解压-targz-或-tgz-文件>示例 12：解压 .tar.gz 或 .tgz 文件</h3><p>使用 <code>-x</code> 和 <code>-z</code> 选项来解压 .tar.gz 或 .tgz 文件。如下：</p><pre tabindex=0><code>[root@linuxtechi ~]# tar -zxpvf myarchive.tgz -C /tmp/
</code></pre><p>以上命令将 tar 文件解压到 /tmp 目录。</p><p>注：现今的 tar 命令会在执行解压动作前自动检查文件的压缩类型，这意味着我们在使用 tar 命令是可以不用指定文件的压缩类型。如下：</p><pre tabindex=0><code>[root@linuxtechi ~]# tar -xpvf myarchive.tgz -C /tmp/
</code></pre><h3 id=示例-13解压-tarbz2-或-tbz2-文件>示例 13：解压 .tar.bz2 或 .tbz2 文件</h3><p>使用 <code>-j</code> 和 <code>-x</code> 选项来解压 .tar.bz2 或 .tbz2 文件。如下：</p><pre tabindex=0><code>[root@linuxtechi ~]# tar -jxpvf myarchive.tbz2 -C /tmp/
</code></pre><p>或</p><pre tabindex=0><code>[root@linuxtechi ~]# tar xpvf myarchive.tbz2 -C /tmp/
</code></pre><h3 id=示例-14使用-tar-命令进行定时备份>示例 14：使用 tar 命令进行定时备份</h3><p>总有一些实时场景需要我们对指定的文件和目录进行打包，已达到日常备份的目的。假设需要每天备份整个 /opt 目录，可以创建一个带 tar 命令的 cron 任务来完成。如下：</p><pre tabindex=0><code>[root@linuxtechi ~]# tar -zcvf optbackup-$(date +%Y-%m-%d).tgz /opt/
</code></pre><p>为以上命令创建一个 cron 任务即可。</p><h3 id=示例-15使用--t-及--x-创建压缩归档文件>示例 15：使用 -T 及 -X 创建压缩归档文件</h3><p>想像这样一个场景：把想要归档和压缩的文件及目录记录到到一个文件，然后把这个文件当做 tar 命令的传入参数来完成归档任务；而有时候则是需要排除上面提到的这个文件里面记录的特定路径后进行归档和压缩。</p><p>在 tar 命令中使用 <code>-T</code> 选项来指定该输入文件，使用 <code>-X</code> 选项来指定包含要排除的文件列表。</p><p>假设要归档 /etc、/opt、/home 目录，并排除 /etc/sysconfig/kdump 和 /etc/sysconfig/foreman 文件，可以创建 /root/tar-include 和 /root/tar-exclude 然后分别输入以下内容：</p><pre tabindex=0><code>[root@linuxtechi ~]# cat /root/tar-include
/etc
/opt
/home
[root@linuxtechi ~]#
[root@linuxtechi ~]# cat /root/tar-exclude
/etc/sysconfig/kdump
/etc/sysconfig/foreman
[root@linuxtechi ~]#
</code></pre><p>运行以下命令来创建一个压缩归档文件。</p><pre tabindex=0><code>[root@linuxtechi ~]# tar zcpvf mybackup-$(date +%Y-%m-%d).tgz -T /root/tar-include -X /root/tar-exclude
</code></pre><h3 id=示例-16查看-tartgz-和-tbz2-文件的大小>示例 16：查看 .tar、.tgz 和 .tbz2 文件的大小</h3><p>使用如下命令来查看 (压缩) tar 文件的体积。</p><pre tabindex=0><code>[root@linuxtechi ~]# tar -czf - data.tar | wc -c
427
[root@linuxtechi ~]# tar -czf - mybackup-2016-09-09.tgz | wc -c
37956009
[root@linuxtechi ~]# tar -czf - myarchive.tbz2 | wc -c
30835317
[root@linuxtechi ~]#
</code></pre><h3 id=示例-17分割体积庞大的-tar-文件为多份小文件>示例 17：分割体积庞大的 tar 文件为多份小文件</h3><p>类 Unix 系统中使用 split 命令来将大体积文件分割成小体积文件。大体积的 tar 当然也可以使用这个命令来进行分割。</p><p>假设需要将 &ldquo;mybackup-2016-09-09.tgz&rdquo; 分割成每份 6 MB 的小文件。</p><pre tabindex=0><code>Syntax :  split -b &lt;Size-in-MB&gt; &lt;tar-file-name&gt;.&lt;extension&gt; “prefix-name”
</code></pre><pre tabindex=0><code>[root@linuxtechi ~]# split -b 6M mybackup-2016-09-09.tgz mybackup-parts
</code></pre><p>以上命令会在当前目录分割 mybackup-2016-09-09.tgz 文件成为多个 6 MB 的小文件，文件名为 mybackup-partsaa ~ mybackup-partsag。如果在要在分割文件后以数字而非字母来区分，可以在以上的 split 命令使用 <code>-d</code> 选项。</p><pre tabindex=0><code>[root@linuxtechi ~]# ls -l mybackup-parts*
-rw-r--r--. 1 root root 6291456 Sep 10 03:05 mybackup-partsaa
-rw-r--r--. 1 root root 6291456 Sep 10 03:05 mybackup-partsab
-rw-r--r--. 1 root root 6291456 Sep 10 03:05 mybackup-partsac
-rw-r--r--. 1 root root 6291456 Sep 10 03:05 mybackup-partsad
-rw-r--r--. 1 root root 6291456 Sep 10 03:05 mybackup-partsae
-rw-r--r--. 1 root root 6291456 Sep 10 03:05 mybackup-partsaf
-rw-r--r--. 1 root root 637219  Sep 10 03:05 mybackup-partsag
[root@linuxtechi ~]#
</code></pre><p>然后通过网络将这些分割文件转移到其他服务器，就可以合并成为一个单独的 tar 文件了，如下：</p><pre tabindex=0><code>[root@linuxtechi ~]# cat mybackup-partsa* &gt; mybackup-2016-09-09.tgz
[root@linuxtechi ~]#
</code></pre><p>文毕，希望你喜欢 tar 命令的这几个不同的示例。随时评论并分享你的心得。</p><hr><p>via: <a href=http://www.linuxtechi.com/17-tar-command-examples-in-linux/>http://www.linuxtechi.com/17-tar-command-examples-in-linux/</a></p><p>作者：<a href=http://www.linuxtechi.com/author/pradeep/>Pradeep Kumar</a> 译者：<a href=https://github.com/GHLandy>GHLandy</a> 校对：<a href=https://github.com/wxy>wxy</a></p><p>本文由 <a href=https://github.com/LCTT/TranslateProject>LCTT</a> 原创编译，<a href=https://linux.cn/>Linux中国</a> 荣誉推出</p></div><footer class=post__footer><div class="post__tags tags clearfix"><svg class="tags__badge icon icon-tag" width="16" height="16" viewBox="0 0 32 32"><path d="M32 19c0 1-1 2-1 2L21 31s-1 1-2 1-2-1-2-1L2 16c-1-1-1.4-2-1.4-2S0 12.5.0 11V3C0 1.5.8.8.8.8S1.5.0 3 0h8c1.5.0 3 .6 3 .6S15 1 16 2l15 15s1 1 1 2zM7 10a3 3 0 100-6 3 3 0 000 6z"/></svg><ul class=tags__list><li class=tags__item><a class="tags__link btn" href=/tags/tar/ rel=tag>tar</a></li><li class=tags__item><a class="tags__link btn" href=/tags/%E5%8E%8B%E7%BC%A9/ rel=tag>压缩</a></li><li class=tags__item><a class="tags__link btn" href=/tags/%E5%BD%92%E6%A1%A3/ rel=tag>归档</a></li></ul></div></footer></article></main></div></div><footer class=footer><div class="container footer__container flex"><div class=footer__copyright>&copy; 2025 Linux.cn Archive.
<span class=footer__copyright-credits>Generated with <a href=https://gohugo.io/ rel="nofollow noopener" target=_blank>Hugo</a> and <a href=https://github.com/Vimux/Mainroad/ rel="nofollow noopener" target=_blank>Mainroad</a> theme.</span></div></div></footer></div><script async defer src=/js/menu.js></script></body></html>