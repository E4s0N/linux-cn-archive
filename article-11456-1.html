<!doctype html><html class=no-js lang=en><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><title>7 个实用的操作 Bash 历史记录的快捷方式 - Linux.cn Archive</title>
<script>(function(e,t){e[t]=e[t].replace("no-js","js")})(document.documentElement,"className")</script><meta name=description content><meta property="og:title" content="7 个实用的操作 Bash 历史记录的快捷方式"><meta property="og:description" content="这些必不可少的 Bash 快捷键可在命令行上节省时间。"><meta property="og:type" content="article"><meta property="og:url" content="/article-11456-1.html"><meta property="article:section" content="posts"><meta property="article:published_time" content="2019-10-14T11:16:27+00:00"><meta property="article:modified_time" content="2019-10-14T11:16:27+00:00"><meta itemprop=name content="7 个实用的操作 Bash 历史记录的快捷方式"><meta itemprop=description content="这些必不可少的 Bash 快捷键可在命令行上节省时间。"><meta itemprop=datePublished content="2019-10-14T11:16:27+00:00"><meta itemprop=dateModified content="2019-10-14T11:16:27+00:00"><meta itemprop=wordCount content="313"><meta itemprop=keywords content="Bash,历史记录,"><link rel=preconnect href=https://fonts.bunny.net crossorigin><link rel=dns-prefetch href=//fonts.bunny.net><link rel=dns-prefetch href=//fonts.bunny.net><link rel=stylesheet href="https://fonts.bunny.net/css?family=Open+Sans:400,400i,700"><link rel=stylesheet href=/css/style.css><link rel="shortcut icon" href=/favicon.ico></head><body class=body><div class="container container--outer"><header class=header><div class="container header__container"><div class=logo><a class=logo__link href=/ title="Linux.cn Archive" rel=home><div class="logo__item logo__text"><div class=logo__title>Linux.cn Archive</div></div></a></div><nav class=menu><button class=menu__btn aria-haspopup=true aria-expanded=false tabindex=0>
<span class=menu__btn-title tabindex=-1>Menu</span></button><ul class=menu__list><li class=menu__item><a class=menu__link href=/><span class=menu__text>Home</span></a></li><li class=menu__item><a class=menu__link href=/categories/><span class=menu__text>Categories</span></a></li><li class=menu__item><a class=menu__link href=/tags/><span class=menu__text>Tags</span></a></li><li class=menu__item><a class=menu__link href><span class=menu__text>RSS</span></a></li></ul></nav></div></header><div class="wrapper flex"><div class=primary><main class=main role=main><article class=post><header class=post__header><h1 class=post__title>7 个实用的操作 Bash 历史记录的快捷方式</h1><div class="post__meta meta"><div class="meta__item-datetime meta__item"><svg class="meta__icon icon icon-time" width="16" height="14" viewBox="0 0 30 28"><path d="M15 0C7 0 1 6 1 14s6 14 14 14 14-6 14-14S23 0 15 0zm0 25C9 25 4 20 4 14S9 3 15 3s11 5 11 11-5 11-11 11zm1-18h-2v8.4l6.8 4.4L22 18l-6-3.8V7z"/></svg><time class=meta__text datetime=2019-10-14T11:16:27Z>October 14, 2019</time></div></div></header><div class="content post__content clearfix"><blockquote><p>这些必不可少的 Bash 快捷键可在命令行上节省时间。</p></blockquote><p><img src=/data/attachment/album/201910/14/111601gdu73c29o283acs1.jpg alt></p><p>大多数介绍 Bash 历史记录的指南都详尽地列出了全部可用的快捷方式。这样做的问题是，你会对每个快捷方式都浅尝辄止，然后在尝试了那么多的快捷方式后就搞得目不暇接。而在开始工作时它们就全被丢在脑后，只记住了刚开始使用 Bash 时学到的 <a href=https://opensource.com/article/18/5/bash-tricks>!! 技巧</a>。这些技巧大多数从未进入记忆当中。</p><p>本文概述了我每天实际使用的快捷方式。它基于我的书《<a href=https://leanpub.com/learnbashthehardway>Bash 学习，艰难之旅</a>》中的某些内容（你可以阅读其中的<a href=https://leanpub.com/learnbashthehardway/read_sample>样章</a>以了解更多信息）。</p><p>当人们看到我使用这些快捷方式时，他们经常问我：“你做了什么！？” 学习它们只需付出很少的精力或智力，但是要真正的学习它们，我建议每周用一天学一个，然后下次再继续学习一个。值得花时间让它们落在你的指尖下，因为从长远来看，节省的时间将很重要。</p><h3 id=1最后一个参数>1、最后一个参数：<code>!$</code></h3><p>如果你仅想从本文中学习一种快捷方式，那就是这个。它会将最后一个命令的最后一个参数替换到你的命令行中。</p><p>看看这种情况：</p><pre tabindex=0><code>$ mv /path/to/wrongfile /some/other/place
mv: cannot stat &#39;/path/to/wrongfile&#39;: No such file or directory
</code></pre><p>啊哈，我在命令中写了错误的文件名 “wrongfile”，我应该用正确的文件名 “rightfile” 代替。</p><p>你可以重新键入上一个命令，并用 “rightfile” 完全替换 “wrongfile”。但是，你也可以键入：</p><pre tabindex=0><code>$ mv /path/to/rightfile !$
mv /path/to/rightfile /some/other/place
</code></pre><p>这个命令也可以奏效。</p><p>在 Bash 中还有其他方法可以通过快捷方式实现相同的目的，但是重用上一个命令的最后一个参数的这种技巧是我最常使用的。</p><h3 id=2第-n-个参数2>2、第 n 个参数：<code>!:2</code></h3><p>是不是干过像这样的事情：</p><pre tabindex=0><code>$ tar -cvf afolder afolder.tar
tar: failed to open
</code></pre><p>像许多其他人一样，我也经常搞错 <code>tar</code>（和 <code>ln</code>）的参数顺序。</p><p><img src=/data/attachment/album/201910/14/111630abb4xexy4t1fiq5y.png alt="xkcd comic" title="xkcd comic"></p><p>当你搞混了参数，你可以这样：</p><pre tabindex=0><code>$ !:0 !:1 !:3 !:2
tar -cvf afolder.tar afolder
</code></pre><p>这样就不会出丑了。</p><p>上一个命令的各个参数的索引是从零开始的，并且可以用 <code>!:</code> 之后跟上该索引数字代表各个参数。</p><p>显然，你也可以使用它来重用上一个命令中的特定参数，而不是所有参数。</p><h3 id=3全部参数1->3、全部参数：<code>!:1-$</code></h3><p>假设我运行了类似这样的命令：</p><pre tabindex=0><code>$ grep &#39;(ping|pong)&#39; afile
</code></pre><p>参数是正确的。然而，我想在文件中匹配 “ping” 或 “pong”，但我使用的是 <code>grep</code> 而不是 <code>egrep</code>。</p><p>我开始输入 <code>egrep</code>，但是我不想重新输入其他参数。因此，我可以使用 <code>!:1-$</code> 快捷方式来调取上一个命令的所有参数，从第二个（记住它们的索引从零开始，因此是 <code>1</code>）到最后一个（由 <code>$</code> 表示）。</p><pre tabindex=0><code>$ egrep !:1-$
egrep &#39;(ping|pong)&#39; afile
ping
</code></pre><p>你不用必须用 <code>1-$</code> 选择全部参数；你也可以选择一个子集，例如 <code>1-2</code> 或 <code>3-9</code> （如果上一个命令中有那么多参数的话）。</p><h3 id=4倒数第-n-行的最后一个参数-2>4、倒数第 n 行的最后一个参数：<code>!-2:$</code></h3><p>当我输错之后马上就知道该如何更正我的命令时，上面的快捷键非常有用，但是我经常在原来的命令之后运行别的命令，这意味着上一个命令不再是我所要引用的命令。</p><p>例如，还是用之前的 <code>mv</code> 例子，如果我通过 <code>ls</code> 检查文件夹的内容来纠正我的错误：</p><pre tabindex=0><code>$ mv /path/to/wrongfile /some/other/place
mv: cannot stat &#39;/path/to/wrongfile&#39;: No such file or directory
$ ls /path/to/
rightfile
</code></pre><p>我就不能再使用 <code>!$</code> 快捷方式了。</p><p>在这些情况下，我可以在 <code>!</code> 之后插入 <code>-n</code>：（其中 <code>n</code> 是要在历史记录中回溯的命令条数），以从较旧的命令取得最后的参数：</p><pre tabindex=0><code>$ mv /path/to/rightfile !-2:$
mv /path/to/rightfile /some/other/place
</code></pre><p>同样，一旦你学会了它，你可能会惊讶于你需要使用它的频率。</p><h3 id=5进入文件夹h>5、进入文件夹：<code>!$:h</code></h3><p>从表面上看，这个看起来不太有用，但我每天要用它几十次。</p><p>想象一下，我运行的命令如下所示：</p><pre tabindex=0><code>$ tar -cvf system.tar /etc/system
 tar: /etc/system: Cannot stat: No such file or directory
 tar: Error exit delayed from previous errors.
</code></pre><p>我可能要做的第一件事是转到 <code>/etc</code> 文件夹，查看其中的内容并找出我做错了什么。</p><p>我可以通过以下方法来做到这一点：</p><pre tabindex=0><code>$ cd !$:h
cd /etc
</code></pre><p>这是说：“获取上一个命令的最后一个参数（<code>/etc/system</code>），并删除其最后的文件名部分，仅保留 <code>/ etc</code>。”</p><h3 id=6当前行1>6、当前行：<code>!#:1</code></h3><p>多年以来，在我最终找到并学会之前，我有时候想知道是否可以在当前行引用一个参数。我多希望我能早早学会这个快捷方式。我经常常使用它制作备份文件：</p><pre tabindex=0><code>$ cp /path/to/some/file !#:1.bak
cp /path/to/some/file /path/to/some/file.bak
</code></pre><p>但当我学会之后，它很快就被下面的快捷方式替代了……</p><h3 id=7搜索并替换gs>7、搜索并替换：<code>!!:gs</code></h3><p>这将搜索所引用的命令，并将前两个 <code>/</code> 之间的字符替换为后两个 <code>/</code> 之间的字符。</p><p>假设我想告诉别人我的 <code>s</code> 键不起作用，而是输出了 <code>f</code>：</p><pre tabindex=0><code>$ echo my f key doef not work
my f key doef not work
</code></pre><p>然后我意识到这里出现的 <code>f</code> 键都是错的。要将所有 <code>f</code> 替换为 <code>s</code>，我可以输入：</p><pre tabindex=0><code>$ !!:gs/f /s /
echo my s key does not work
my s key does not work
</code></pre><p>它不只对单个字符起作用。我也可以替换单词或句子：</p><pre tabindex=0><code>$ !!:gs/does/did/
echo my s key did not work
my s key did not work
</code></pre><h3 id=测试一下>测试一下</h3><p>为了向你展示如何组合这些快捷方式，你知道这些命令片段将输出什么吗？</p><pre tabindex=0><code>$ ping !#:0:gs/i/o
$ vi /tmp/!:0.txt
$ ls !$:h
$ cd !-2:$:h
$ touch !$!-3:$ !! !$.txt
$ cat !:1-$
</code></pre><h3 id=总结>总结</h3><p>对于日常的命令行用户，Bash 可以作为快捷方式的优雅来源。虽然有成千上万的技巧要学习，但这些是我经常使用的最喜欢的技巧。</p><p>如果你想更深入地了解 Bash 可以教给你的全部知识，请买本我的书，《<a href=https://leanpub.com/learnbashthehardway>Bash 学习，艰难之旅</a>》，或查看我的在线课程《<a href=https://www.educative.io/courses/master-the-bash-shell>精通 Bash shell</a>》。</p><hr><p>本文最初发布在 Ian 的博客 <a href=https://zwischenzugs.com/2019/08/25/seven-god-like-bash-history-shortcuts-you-will-actually-use/>Zwischenzugs.com</a> 上，并经允许重复发布。</p><hr><p>via: <a href=https://opensource.com/article/19/10/bash-history-shortcuts>https://opensource.com/article/19/10/bash-history-shortcuts</a></p><p>作者：<a href=https://opensource.com/users/ianmiell>Ian Miell</a> 选题：<a href=https://github.com/lujun9972>lujun9972</a> 译者：<a href=https://github.com/wxy>wxy</a> 校对：<a href=https://github.com/wxy>wxy</a></p><p>本文由 <a href=https://github.com/LCTT/TranslateProject>LCTT</a> 原创编译，<a href=https://linux.cn/>Linux中国</a> 荣誉推出</p></div><footer class=post__footer><div class="post__tags tags clearfix"><svg class="tags__badge icon icon-tag" width="16" height="16" viewBox="0 0 32 32"><path d="M32 19c0 1-1 2-1 2L21 31s-1 1-2 1-2-1-2-1L2 16c-1-1-1.4-2-1.4-2S0 12.5.0 11V3C0 1.5.8.8.8.8S1.5.0 3 0h8c1.5.0 3 .6 3 .6S15 1 16 2l15 15s1 1 1 2zM7 10a3 3 0 100-6 3 3 0 000 6z"/></svg><ul class=tags__list><li class=tags__item><a class="tags__link btn" href=/tags/bash/ rel=tag>Bash</a></li><li class=tags__item><a class="tags__link btn" href=/tags/%E5%8E%86%E5%8F%B2%E8%AE%B0%E5%BD%95/ rel=tag>历史记录</a></li></ul></div></footer></article></main></div></div><footer class=footer><div class="container footer__container flex"><div class=footer__copyright>&copy; 2025 Linux.cn Archive.
<span class=footer__copyright-credits>Generated with <a href=https://gohugo.io/ rel="nofollow noopener" target=_blank>Hugo</a> and <a href=https://github.com/Vimux/Mainroad/ rel="nofollow noopener" target=_blank>Mainroad</a> theme.</span></div></div></footer></div><script async defer src=/js/menu.js></script></body></html>