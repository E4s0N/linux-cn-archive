<!doctype html><html class=no-js lang=en><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><title>使用 awk 统计字母频率 - Linux.cn Archive</title>
<script>(function(e,t){e[t]=e[t].replace("no-js","js")})(document.documentElement,"className")</script><meta name=description content><meta property="og:title" content="使用 awk 统计字母频率"><meta property="og:description" content="编写一个 awk 脚本来找到一组单词中出现次数最多（和最少）的单词。"><meta property="og:type" content="article"><meta property="og:url" content="/article-14375-1.html"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-03-20T08:51:01+00:00"><meta property="article:modified_time" content="2022-03-20T08:51:01+00:00"><meta itemprop=name content="使用 awk 统计字母频率"><meta itemprop=description content="编写一个 awk 脚本来找到一组单词中出现次数最多（和最少）的单词。"><meta itemprop=datePublished content="2022-03-20T08:51:01+00:00"><meta itemprop=dateModified content="2022-03-20T08:51:01+00:00"><meta itemprop=wordCount content="603"><meta itemprop=keywords content="awk,"><link rel=preconnect href=https://fonts.bunny.net crossorigin><link rel=dns-prefetch href=//fonts.bunny.net><link rel=dns-prefetch href=//fonts.bunny.net><link rel=stylesheet href="https://fonts.bunny.net/css?family=Open+Sans:400,400i,700"><link rel=stylesheet href=/css/style.css><link rel="shortcut icon" href=/favicon.ico></head><body class=body><div class="container container--outer"><header class=header><div class="container header__container"><div class=logo><a class=logo__link href=/ title="Linux.cn Archive" rel=home><div class="logo__item logo__text"><div class=logo__title>Linux.cn Archive</div></div></a></div><nav class=menu><button class=menu__btn aria-haspopup=true aria-expanded=false tabindex=0>
<span class=menu__btn-title tabindex=-1>Menu</span></button><ul class=menu__list><li class=menu__item><a class=menu__link href=/><span class=menu__text>Home</span></a></li><li class=menu__item><a class=menu__link href=/categories/><span class=menu__text>Categories</span></a></li><li class=menu__item><a class=menu__link href=/tags/><span class=menu__text>Tags</span></a></li><li class=menu__item><a class=menu__link href><span class=menu__text>RSS</span></a></li></ul></nav></div></header><div class="wrapper flex"><div class=primary><main class=main role=main><article class=post><header class=post__header><h1 class=post__title>使用 awk 统计字母频率</h1><div class="post__meta meta"><div class="meta__item-datetime meta__item"><svg class="meta__icon icon icon-time" width="16" height="14" viewBox="0 0 30 28"><path d="M15 0C7 0 1 6 1 14s6 14 14 14 14-6 14-14S23 0 15 0zm0 25C9 25 4 20 4 14S9 3 15 3s11 5 11 11-5 11-11 11zm1-18h-2v8.4l6.8 4.4L22 18l-6-3.8V7z"/></svg><time class=meta__text datetime=2022-03-20T08:51:01Z>March 20, 2022</time></div></div></header><div class="content post__content clearfix"><blockquote><p>编写一个 awk 脚本来找到一组单词中出现次数最多（和最少）的单词。</p></blockquote><p><img src=/data/attachment/album/202203/20/085052bajyoejnea8cpw5j.jpg alt title="Typewriter keys in multicolor"></p><p>近一段时间，我开始编写一个小游戏，在这个小游戏里，玩家使用一个个字母块来组成单词。编写这个游戏之前，我需要先知道常见英文单词中每个字母的使用频率，这样一来，我就可以找到一组更有用的字母块。字母频次统计在很多地方都有相关讨论，包括在 <a href=https://en.wikipedia.org/wiki/Letter_frequency>维基百科</a> 上，但我还是想要自己来实现。</p><p>Linux 系统在 <code>/usr/share/dict/words</code> 文件中提供了一个单词列表，所以我已经有了一个现成的单词列表。然而，尽管这个 <code>words</code> 文件包含了很多我想要的单词，却也包含了一些我不想要的。我想要的单词首先不能是复合词（即不包含连接符和空格的单词），也不能是专有名词（即不包含大写字母单词）。为了得到这个结果，我可以运行 <code>grep</code> 命令来取出只由小写字母组成的行：</p><pre tabindex=0><code>$ grep  &#39;^[a-z]*$&#39; /usr/share/dict/words
</code></pre><p>这个正则表达式的作用是让 <code>grep</code> 去匹配仅包含小写字母的行。表达式中的字符 <code>^</code> 和 <code>$</code> 分别代表了这一行的开始和结束。<code>[a-z]</code> 分组仅匹配从 “a” 到 “z” 的小写字母。</p><p>下面是一个输出示例：</p><pre tabindex=0><code>$ grep  &#39;^[a-z]*$&#39; /usr/share/dict/words | head
a
aa
aaa
aah
aahed
aahing
aahs
aal
aalii
aaliis
</code></pre><p>没错，这些都是合法的单词。比如，“aahed” 是 “aah” 的过去式，表示在放松时的感叹，而 “aalii” 是一种浓密的热带灌木。</p><p>现在我只需要编写一个 <code>gawk</code> 脚本来统计出单词中各个字母出现的次数，然后打印出每个字母的相对频率。</p><h3 id=字母计数>字母计数</h3><p>一种使用 <code>gawk</code> 来统计字母个数的方式是，遍历每行输入中的每一个字符，然后对 “a” 到 “z” 之间的每个字母进行计数。<code>substr</code> 函数会返回一个给定长度的子串，它可以只包含一个字符，也可以是更长的字符串。比如，下面的示例代码能够取到输入中的每一个字符 <code>c</code>：</p><pre tabindex=0><code>{
    len = length($0); for (i = 1; i &lt;= len; i++) {
        c = substr($0, i, 1);
    }
}
</code></pre><p>如果使用一个全局字符串变量 <code>LETTERS</code> 来存储字母表，我就可以借助 <code>index</code> 函数来找到某个字符在字母表中的位置。我将扩展 <code>gawk</code> 代码示例，让它在输入数据中只取范围在 “a” 到 “z” 的字母：</p><pre tabindex=0><code>BEGIN { LETTERS = &#34;abcdefghijklmnopqrstuvwxyz&#34; }
 
{
    len = length($0); for (i = 1; i &lt;= len; i++) {
        c = substr($0, i, 1);
        ltr = index(LETTERS, c);
    }
}
</code></pre><p>需要注意的是，<code>index</code> 函数将返回字母在 <code>LETTERS</code> 字符串中首次出现的位置，第一个位置返回 1，如果没有找到则返回 0。如果我有一个大小为 26 的数组，我就可以利用这个数组来统计每个字母出现的次数。我将在下面的示例代码中添加这个功能，每当一个字母出现在输入中，我就让它对应的数组元素值增加 1（使用 <code>++</code>）：</p><pre tabindex=0><code>BEGIN { LETTERS = &#34;abcdefghijklmnopqrstuvwxyz&#34; }
 
{
    len = length($0); for (i = 1; i &lt;= len; i++) {
        c = substr($0, i, 1);
        ltr = index(LETTERS, c);
 
        if (ltr &amp;gt; 0) {
            ++count[ltr];
        }
    }
}
</code></pre><h3 id=打印相对频率>打印相对频率</h3><p>当 <code>gawk</code> 脚本统计完所有的字母后，我希望它能输出每个字母的频率。毕竟，我对输入中各个字母的个数没有兴趣，我更关心它们的 <em>相对频率</em>。</p><p>我将先统计字母 “a” 的个数，然后把它和剩余 “b” 到 “z” 字母的个数比较：</p><pre tabindex=0><code>END {
    min = count[1]; for (ltr = 2; ltr &lt;= 26; ltr++) {
        if (count[ltr] &lt; min) {
            min = count[ltr];
        }
    }
}
</code></pre><p>在循环的最后，变量 <code>min</code> 会等于最少的出现次数，我可以把它为基准，为字母的个数设定一个参照值，然后计算打印出每个字母的相对频率。比如，如果出现次数最少的字母是 “q”，那么 <code>min</code> 就会等于 “q” 的出现次数。</p><p>接下来，我会遍历每个字母，打印出它和它的相对频率。我通过把每个字母的个数都除以 <code>min</code> 的方式来计算出它的相对频率，这意味着出现次数最少的字母的相对频率是 1。如果另一个字母出现的次数恰好是最少次数的两倍，那么这个字母的相对频率就是 2。我只关心整数，所以 2.1 和 2.9 对我来说是一样的（都是 2）。</p><pre tabindex=0><code>END {
    min = count[1]; for (ltr = 2; ltr &lt;= 26; ltr++) {
        if (count[ltr] &lt; min) {
            min = count[ltr];
        }
    }
 
    for (ltr = 1; ltr &lt;= 26; ltr++) {
        print substr(LETTERS, ltr, 1), int(count[ltr] / min);
    }
}
</code></pre><h3 id=最后的完整程序>最后的完整程序</h3><p>现在，我已经有了一个能够统计输入中各个字母的相对频率的 <code>gawk</code> 脚本：</p><pre tabindex=0><code>#!/usr/bin/gawk -f
 
# 只统计 a-z 的字符，忽略 A-Z 和其他的字符
 
BEGIN { LETTERS = &#34;abcdefghijklmnopqrstuvwxyz&#34; }
 
{
    len = length($0); for (i = 1; i &lt;= len; i++) {
        c = substr($0, i, 1);
        ltr = index(LETTERS, c);
 
        if (ltr &lt; 0) {
            ++count[ltr];
        }
    }
}
 
# 打印每个字符的相对频率
   
END {
    min = count[1]; for (ltr = 2; ltr &lt;= 26; ltr++) {
        if (count[ltr] &lt; min) {
            min = count[ltr];
        }
    }
 
    for (ltr = 1; ltr &lt;= 26; ltr++) {
        print substr(LETTERS, ltr, 1), int(count[ltr] / min);
    }
}
</code></pre><p>我将把这段程序保存到名为 <code>letter-freq.awk</code> 的文件中，这样一来，我就可以在命令行中更方便地使用它。</p><p>如果你愿意的话，你也可以使用 <code>chmod +x</code> 命令把这个文件设为可独立执行。第一行中的 <code>#!/usr/bin/gawk -f</code> 表示 Linux 会使用 <code>/usr/bin/gawk</code> 把这个文件当作一个脚本来运行。由于 <code>gawk</code> 命令行使用 <code>-f</code> 来指定它要运行的脚本文件名，你需要在末尾加上 <code>-f</code>。如此一来，当你在 shell 中执行 <code>letter-freq.awk</code>，它会被解释为 <code>/usr/bin/gawk -f letter-freq.awk</code>。</p><p>接下来我将用几个简单的输入来测试这个脚本。比如，如果我给我的 <code>gawk</code> 脚本输入整个字母表，每个字母的相对频率都应该是 1：</p><pre tabindex=0><code>$ echo abcdefghijklmnopqrstuvwxyz | gawk -f letter-freq.awk
a 1
b 1
c 1
d 1
e 1
f 1
g 1
h 1
i 1
j 1
k 1
l 1
m 1
n 1
o 1
p 1
q 1
r 1
s 1
t 1
u 1
v 1
w 1
x 1
y 1
z 1
</code></pre><p>还是使用上述例子，只不过这次我在输入中添加了一个字母 “e”，此时的输出结果中，“e” 的相对频率会是 2，而其他字母的相对频率仍然会是 1：</p><pre tabindex=0><code>$ echo abcdeefghijklmnopqrstuvwxyz | gawk -f letter-freq.awk
a 1
b 1
c 1
d 1
e 2
f 1
g 1
h 1
i 1
j 1
k 1
l 1
m 1
n 1
o 1
p 1
q 1
r 1
s 1
t 1
u 1
v 1
w 1
x 1
y 1
z 1
</code></pre><p>现在我可以跨出最大的一步了！我将使用 <code>grep</code> 命令和 <code>/usr/share/dict/words</code> 文件，统计所有仅由小写字母组成的单词中，各个字母的相对使用频率：</p><pre tabindex=0><code>$ grep  &#39;^[a-z]*$&#39; /usr/share/dict/words | gawk -f letter-freq.awk
a 53
b 12
c 28
d 21
e 72
f 7
g 15
h 17
i 58
j 1
k 5
l 36
m 19
n 47
o 47
p 21
q 1
r 46
s 48
t 44
u 25
v 6
w 4
x 1
y 13
z 2
</code></pre><p>在 <code>/usr/share/dict/words</code> 文件的所有小写单词中，字母 “j”、“q” 和 “x” 出现的相对频率最低，字母 “z” 也使用得很少。不出意料，字母 “e” 是使用频率最高的。</p><hr><p>via: <a href=https://opensource.com/article/21/4/gawk-letter-game>https://opensource.com/article/21/4/gawk-letter-game</a></p><p>作者：<a href=https://opensource.com/users/jim-hall>Jim Hall</a> 选题：<a href=https://github.com/lujun9972>lujun9972</a> 译者：<a href=https://github.com/lkxed>lkxed</a> 校对：<a href=https://github.com/wxy>wxy</a></p><p>本文由 <a href=https://github.com/LCTT/TranslateProject>LCTT</a> 原创编译，<a href=https://linux.cn/>Linux中国</a> 荣誉推出</p></div><footer class=post__footer><div class="post__tags tags clearfix"><svg class="tags__badge icon icon-tag" width="16" height="16" viewBox="0 0 32 32"><path d="M32 19c0 1-1 2-1 2L21 31s-1 1-2 1-2-1-2-1L2 16c-1-1-1.4-2-1.4-2S0 12.5.0 11V3C0 1.5.8.8.8.8S1.5.0 3 0h8c1.5.0 3 .6 3 .6S15 1 16 2l15 15s1 1 1 2zM7 10a3 3 0 100-6 3 3 0 000 6z"/></svg><ul class=tags__list><li class=tags__item><a class="tags__link btn" href=/tags/awk/ rel=tag>awk</a></li></ul></div></footer></article></main></div></div><footer class=footer><div class="container footer__container flex"><div class=footer__copyright>&copy; 2025 Linux.cn Archive.
<span class=footer__copyright-credits>Generated with <a href=https://gohugo.io/ rel="nofollow noopener" target=_blank>Hugo</a> and <a href=https://github.com/Vimux/Mainroad/ rel="nofollow noopener" target=_blank>Mainroad</a> theme.</span></div></div></footer></div><script async defer src=/js/menu.js></script></body></html>