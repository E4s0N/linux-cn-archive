<!doctype html><html class=no-js lang=en><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><title>在 Ubuntu 中用 Docker 管理 Linux Container 容器 - Linux.cn Archive</title>
<script>(function(e,t){e[t]=e[t].replace("no-js","js")})(document.documentElement,"className")</script><meta name=description content><meta property="og:title" content="在 Ubuntu 中用 Docker 管理 Linux Container 容器"><meta property="og:description" content="当前，完全硬件虚拟化技术（KVM、Xen、Hyper-V 等）能在一个物理主机上很好地运行多个互相独立的操作系统，但这也带来一些问题：性能不佳，资源浪费，系统反应迟缓等。有时候对用户来说，完全的硬件虚拟化并不是最好的选择。 一种替代方案是使用轻量级虚拟化技术  所谓的 LinuX Container 容器 (LXC)，它提供的是系统级虚拟化。与跑虚拟机相比，LXC 可以在一个轻量级沙箱容器里面跑多个 Linux 操作系统。当你需要设置一些易于克隆的开发环境、测试环境，或想在安全沙盒里安装应用时，LXC 就非常有用了。 Docker 是一个开源工具，可以让用"><meta property="og:type" content="article"><meta property="og:url" content="/article-3139-1.html"><meta property="article:section" content="posts"><meta property="article:published_time" content="2014-06-03T08:00:00+00:00"><meta property="article:modified_time" content="2014-06-03T08:00:00+00:00"><meta itemprop=name content="在 Ubuntu 中用 Docker 管理 Linux Container 容器"><meta itemprop=description content="当前，完全硬件虚拟化技术（KVM、Xen、Hyper-V 等）能在一个物理主机上很好地运行多个互相独立的操作系统，但这也带来一些问题：性能不佳，资源浪费，系统反应迟缓等。有时候对用户来说，完全的硬件虚拟化并不是最好的选择。 一种替代方案是使用轻量级虚拟化技术  所谓的 LinuX Container 容器 (LXC)，它提供的是系统级虚拟化。与跑虚拟机相比，LXC 可以在一个轻量级沙箱容器里面跑多个 Linux 操作系统。当你需要设置一些易于克隆的开发环境、测试环境，或想在安全沙盒里安装应用时，LXC 就非常有用了。 Docker 是一个开源工具，可以让用"><meta itemprop=datePublished content="2014-06-03T08:00:00+00:00"><meta itemprop=dateModified content="2014-06-03T08:00:00+00:00"><meta itemprop=wordCount content="265"><meta itemprop=keywords content><link rel=preconnect href=https://fonts.bunny.net crossorigin><link rel=dns-prefetch href=//fonts.bunny.net><link rel=dns-prefetch href=//fonts.bunny.net><link rel=stylesheet href="https://fonts.bunny.net/css?family=Open+Sans:400,400i,700"><link rel=stylesheet href=/css/style.css><link rel="shortcut icon" href=/favicon.ico></head><body class=body><div class="container container--outer"><header class=header><div class="container header__container"><div class=logo><a class=logo__link href=/ title="Linux.cn Archive" rel=home><div class="logo__item logo__text"><div class=logo__title>Linux.cn Archive</div></div></a></div><nav class=menu><button class=menu__btn aria-haspopup=true aria-expanded=false tabindex=0>
<span class=menu__btn-title tabindex=-1>Menu</span></button><ul class=menu__list><li class=menu__item><a class=menu__link href=/><span class=menu__text>Home</span></a></li><li class=menu__item><a class=menu__link href=/categories/><span class=menu__text>Categories</span></a></li><li class=menu__item><a class=menu__link href=/tags/><span class=menu__text>Tags</span></a></li><li class=menu__item><a class=menu__link href><span class=menu__text>RSS</span></a></li></ul></nav></div></header><div class="wrapper flex"><div class=primary><main class=main role=main><article class=post><header class=post__header><h1 class=post__title>在 Ubuntu 中用 Docker 管理 Linux Container 容器</h1><div class="post__meta meta"><div class="meta__item-datetime meta__item"><svg class="meta__icon icon icon-time" width="16" height="14" viewBox="0 0 30 28"><path d="M15 0C7 0 1 6 1 14s6 14 14 14 14-6 14-14S23 0 15 0zm0 25C9 25 4 20 4 14S9 3 15 3s11 5 11 11-5 11-11 11zm1-18h-2v8.4l6.8 4.4L22 18l-6-3.8V7z"/></svg><time class=meta__text datetime=2014-06-03T08:00:00Z>June 03, 2014</time></div></div></header><div class="content post__content clearfix"><p>当前，完全硬件虚拟化技术（KVM、Xen、Hyper-V 等）能在一个物理主机上很好地运行多个互相独立的操作系统，但这也带来一些问题：性能不佳，资源浪费，系统反应迟缓等。有时候对用户来说，完全的硬件虚拟化并不是最好的选择。</p><p>一种替代方案是使用轻量级虚拟化技术 —— 所谓的 <a href=https://linuxcontainers.org/>LinuX Container 容器</a> (LXC)，它提供的是系统级虚拟化。与跑虚拟机相比，LXC 可以在一个轻量级沙箱容器里面跑多个 Linux 操作系统。当你需要设置一些易于克隆的开发环境、测试环境，或想在安全沙盒里安装应用时，LXC 就非常有用了。</p><p><a href=https://www.docker.io/>Docker</a> 是一个开源工具，可以让用户方便地布署 Linux Container 容器。Docker 很快变成了 container 技术的非官方标准，从而被 <a href=http://blog.docker.io/2014/04/docker-in-ubuntu-ubuntu-in-docker/>Ubuntu</a> 和 <a href=http://www.redhat.com/about/news/press-archive/2014/4/red-hat-docker-expand-collaboration>Red Hat</a>等众多发行版吸收进去。</p><p><img src=/data/attachment/album/201406/03/003127q1lps3dscsf3s3dp.png alt></p><p>本教程中我会向你们演示如何在 Ubuntu 14.04 中使用 Docker 来管理 LXC。需要注意的是，本教程的一些内容可能会与其他 Ubuntu 版本下的操作会稍微有些出入。</p><p>当前Ubuntu 系统下的 Docker 的安装包只提供64位。如果你想运行32位的 Docker，你需要<a href=http://mwhiteley.com/linux-containers/2013/08/31/docker-on-i386.html>使用源码编译32位 Docker 工具</a>。</p><h3 id=安装-docker>安装 Docker</h3><p>通过 apt-get 安装 Docker 简直是小菜一碟。</p><pre tabindex=0><code>$ sudo apt-get install docker.io
</code></pre><p>如果你不是 root 组的用户，你可以把自己加入到 docker 用户组。下面的命令可以让没有 root 权限的用户使用 Docker：</p><pre tabindex=0><code>$ sudo usermod -a -G docker $USER
</code></pre><p>重新登录，以便让你的用户组权限生效。</p><p>下一步是编辑 Docker 配置文件，确定 Docker 可执行文件的路径：</p><pre tabindex=0><code>$ sudo vi /etc/default/docker.io

DOCKER=&#34;/usr/bin/docker.io&#34;
</code></pre><p>重启 Docker 服务：</p><pre tabindex=0><code>$ sudo service docker.io restart
</code></pre><h3 id=管理-docker-container-容器>管理 Docker Container 容器</h3><p>如果你想在新的 Docker 容器下创建一个新的 Ubuntu 操作系统，你首先需要 pull 一个 <a href=http://xmodulo.com/go/ubuntubook>Ubuntu</a> 的 Docker 镜像。下面的命令可以通过网络下载 Docker 镜像：</p><pre tabindex=0><code>$ docker pull ubuntu
</code></pre><p>你可以使用下面的命令启动 Docker 里面的 Ubuntu 系统。最后的参数“/bin/bash”表示一旦容器启动，首先会执行简单的 bash。</p><pre tabindex=0><code>$ docker run -i -t ubuntu /bin/bash
</code></pre><p>上面的命令会立即启动 Ubuntu container 容器（这是一个完美的容器！），然后它会提供一个 shell 提示符运行环境给你。现在开始你可以通过这个沙箱环境访问一个完整的 Ubuntu 系统了。</p><p><img src=/data/attachment/album/201406/03/003132klngw3ccw99xcorc.jpg alt></p><p>输入“exit”命令退出 Docker 容器。</p><p>你也可以用下面的命令进入不同的系统。比如 Fedora：</p><pre tabindex=0><code>$ docker.io run -i -t fedora /bin/bash
</code></pre><p>如果系统中还不存在 Fedora Docker 镜像，这个命令会自动下载它，然后启动这个 Fedora 的 Docker 容器。</p><p><img src=/data/attachment/album/201406/03/003135z8o245afznfbowcw.jpg alt></p><p>如果你想要开启指定版本的系统，比如 Ubuntu 13.04，你可以使用下面的命令：</p><pre tabindex=0><code>$ docker.io run -i -t ubuntu:13.04 /bin/bash
</code></pre><h3 id=container-容器网络设置>Container 容器网络设置</h3><p>Docker 使用 Linux 桥接技术与其他容器通信，以及连通外网。安装完 Docker 后你应该可以看到 docker0 这个网桥，这是 Docker 默认创建的。你创建的每个容器都会通过这个网桥连接到网络。</p><p><img src=/data/attachment/album/201406/03/003138botwnnpgmrw95wnr.jpg alt></p><h4 id=自定义-linux-网桥>自定义 Linux 网桥</h4><p>如果你想自定义网桥，你可以执行以下步骤。你可以在这个网桥后面分配一个子网，并为这个子网分配地址。下面的命令会为 Docker 子网分配 10.0.0.0/24 地址段：</p><pre tabindex=0><code>$ sudo apt-get install bridge-utils
$ sudo brctl addbr br0
$ sudo ifconfig br0 10.0.0.1 netmask 255.255.255.0
</code></pre><p>然后在 /etc/default/docker.io 文件的 DOCKER_OPTS 变量里添加“-b=br0”选项，并重启 Docker 服务：</p><pre tabindex=0><code>$ sudo service docker.io restart
</code></pre><p>到目前为止，任何创建的容器都会连上 br0 网桥，它们的 IP 地址会从 10.0.0.0/24 中自动分配（译注：在10.0.0.2到10.0.0.254之间随机分配）。</p><h4 id=其他自定义设置>其他自定义设置</h4><p>你可以通过 /etc/default/docker.io 文件的 DOCKER_OPTS 变量设置其他一些属性：</p><ul><li>&ldquo;-dns 8.8.8.8 -dns 8.8.4.4&rdquo;: 为容器指定 DNS 服务器。</li><li>&ldquo;-icc=false&rdquo;: 将容器与其他容器隔离出来</li></ul><h3 id=疑难解答>疑难解答</h3><p>1、当你运行 docker.io 命令时，你可能会遇到以下问题：</p><blockquote><p>dial unix /var/run/docker.sock: no such file or directory</p></blockquote><p>这个错误可能是由于 Docker 后台进程没有启动。检查下 Docker 后台进程的状态，确认它已经处于启动状态：</p><pre tabindex=0><code>$ sudo service docker.io status
$ sudo service docker.io start 
</code></pre><hr><p>via: <a href=http://xmodulo.com/2014/05/manage-linux-containers-docker-ubuntu.html>http://xmodulo.com/2014/05/manage-linux-containers-docker-ubuntu.html</a></p><p>译者：<a href=https://github.com/bazz2>bazz2</a> 校对：<a href=https://github.com/wxy>wxy</a></p><p>本文由 <a href=https://github.com/LCTT/TranslateProject>LCTT</a> 原创翻译，<a href=http://linux.cn/>Linux中国</a> 荣誉推出</p></div></article></main></div></div><footer class=footer><div class="container footer__container flex"><div class=footer__copyright>&copy; 2025 Linux.cn Archive.
<span class=footer__copyright-credits>Generated with <a href=https://gohugo.io/ rel="nofollow noopener" target=_blank>Hugo</a> and <a href=https://github.com/Vimux/Mainroad/ rel="nofollow noopener" target=_blank>Mainroad</a> theme.</span></div></div></footer></div><script async defer src=/js/menu.js></script></body></html>