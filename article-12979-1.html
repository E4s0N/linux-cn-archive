<!doctype html><html class=no-js lang=en><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><title>通过编写一个简单的游戏来学习 Rust - Linux.cn Archive</title>
<script>(function(e,t){e[t]=e[t].replace("no-js","js")})(document.documentElement,"className")</script><meta name=description content><meta property="og:title" content="通过编写一个简单的游戏来学习 Rust"><meta property="og:description" content="你可以尝试以多种语言编程一个简单的游戏来开始编程之路。"><meta property="og:type" content="article"><meta property="og:url" content="/article-12979-1.html"><meta property="article:section" content="posts"><meta property="article:published_time" content="2021-01-03T10:10:52+00:00"><meta property="article:modified_time" content="2021-01-03T10:10:52+00:00"><meta itemprop=name content="通过编写一个简单的游戏来学习 Rust"><meta itemprop=description content="你可以尝试以多种语言编程一个简单的游戏来开始编程之路。"><meta itemprop=datePublished content="2021-01-03T10:10:52+00:00"><meta itemprop=dateModified content="2021-01-03T10:10:52+00:00"><meta itemprop=wordCount content="322"><meta itemprop=keywords content="Rust,"><link rel=preconnect href=https://fonts.bunny.net crossorigin><link rel=dns-prefetch href=//fonts.bunny.net><link rel=dns-prefetch href=//fonts.bunny.net><link rel=stylesheet href="https://fonts.bunny.net/css?family=Open+Sans:400,400i,700"><link rel=stylesheet href=/css/style.css><link rel="shortcut icon" href=/favicon.ico></head><body class=body><div class="container container--outer"><header class=header><div class="container header__container"><div class=logo><a class=logo__link href=/ title="Linux.cn Archive" rel=home><div class="logo__item logo__text"><div class=logo__title>Linux.cn Archive</div></div></a></div><nav class=menu><button class=menu__btn aria-haspopup=true aria-expanded=false tabindex=0>
<span class=menu__btn-title tabindex=-1>Menu</span></button><ul class=menu__list><li class=menu__item><a class=menu__link href=/><span class=menu__text>Home</span></a></li><li class=menu__item><a class=menu__link href=/categories/><span class=menu__text>Categories</span></a></li><li class=menu__item><a class=menu__link href=/tags/><span class=menu__text>Tags</span></a></li><li class=menu__item><a class=menu__link href><span class=menu__text>RSS</span></a></li></ul></nav></div></header><div class="wrapper flex"><div class=primary><main class=main role=main><article class=post><header class=post__header><h1 class=post__title>通过编写一个简单的游戏来学习 Rust</h1><div class="post__meta meta"><div class="meta__item-datetime meta__item"><svg class="meta__icon icon icon-time" width="16" height="14" viewBox="0 0 30 28"><path d="M15 0C7 0 1 6 1 14s6 14 14 14 14-6 14-14S23 0 15 0zm0 25C9 25 4 20 4 14S9 3 15 3s11 5 11 11-5 11-11 11zm1-18h-2v8.4l6.8 4.4L22 18l-6-3.8V7z"/></svg><time class=meta__text datetime=2021-01-03T10:10:52Z>January 03, 2021</time></div></div></header><div class="content post__content clearfix"><blockquote><p>你可以尝试以多种语言编程一个简单的游戏来开始编程之路。</p></blockquote><p><img src=https://img.linux.net.cn/data/attachment/album/202101/03/101054axmmaxrpmsmopkac.png alt="海底的螃蟹 Ferris，Rust 编程语言的非官方标志" title="Ferris the crab under the sea, unofficial logo for Rust programming language"></p><p>当你想学习一门新的编程语言时，不妨关注一下编程语言的共同点。</p><ul><li>变量</li><li>表达式</li><li>语句</li></ul><p>这些概念是大多数编程语言的基础。一旦你理解了它们，你就可以开始弄清楚其余的东西。</p><p>因为编程语言通常具有相似性，一旦你懂了一种语言，你就可以通过理解其差异来学习另一种语言的基础知识。</p><p>学习新语言的一个好方法是使用一个你可以用来练习的标准程序。这可以让你专注于语言，而不是程序的逻辑。我在这一系列文章中使用了一个“猜数字”的程序，在这个程序中，电脑会在 1 到 100 之间选一个数字让你猜。程序一直循环，直到你猜对数字为止。</p><p>这个程序锻炼了编程语言的几个概念:</p><ul><li>变量</li><li>输入</li><li>输出</li><li>条件评估</li><li>循环</li></ul><p>这是学习一门新编程语言的很好的实践实验。</p><h3 id=安装-rust>安装 Rust</h3><p>你可以<a href=https://www.rust-lang.org/learn/get-started>使用 Rustup 安装一个 Rust 工具链</a>，或者你可以<a href=https://play.rust-lang.org/>在线尝试 Rust</a> 而不在本地安装它。</p><p>如果你在本地安装，你应该定期用 <code>rustup update</code> 来更新它，以保持你的工具链的新鲜，并使用 <code>cargo update</code> 来保持你的库的最新版本。</p><h3 id=rust-语言版本的猜数字>Rust 语言版本的猜数字</h3><p><a href=https://www.rust-lang.org/>Rust</a> 是一门赋予任何人构建可靠和高效的软件能力的语言。你可以通过编写一个 Rust 版本的“猜数字”游戏来探索 Rust。</p><p>第一步是编写一个 <code>Cargo.toml</code> 文件。你可以使用 <code>cargo new</code> 命令生成一个骨架 <code>Cargo.toml</code>。这几乎是开始一个 Rust 项目的最佳方式。</p><pre tabindex=0><code>$ cargo new guess
$ cd guess
$ ls -1
Cargo.toml
src/
</code></pre><p><code>Cargo.toml</code> 文件为你的包命名，并给它一些元数据，最重要的是，指明了它依赖于 <code>rand</code> <a href=https://doc.rust-lang.org/book/ch07-01-packages-and-crates.html>crate</a>。</p><pre tabindex=0><code>[package]
name = &#34;guess&#34;
version = &#34;2020.11.0&#34;
authors = [&#34;Moshe Zadka &lt;moshez@opensource.com&gt;&#34;]
edition = &#34;2018&#34;

# See more keys and their definitions at https://doc.rust-lang.org/cargo/reference/manifest.html

[dependencies]
rand = &#34;*&#34;
</code></pre><p>Rust 中的许多东西不是由语言或标准库提供的。取而代之的是，你可以从某个外部 crate 得到它们，这些 crate 可以做许多事情。</p><p>程序逻辑在 <code>src/main.rs</code> 中：</p><pre tabindex=0><code>use rand::Rng;
use std::io::BufRead;

fn main() {
    let mut rng = rand::thread_rng();
    let random = rng.gen_range(1..101);
    println!(&#34;Guess a number between 1 and 100&#34;);
    for line in std::io::stdin().lock().lines() {
        let parsed = line.ok().as_deref().map(str::parse::&lt;i64&gt;);
        if let Some(Ok(guess)) = parsed {
            match guess {
                _ if guess &lt; random =&gt; println!(&#34;Too low&#34;),
                _ if guess &gt; random =&gt; println!(&#34;Too high&#34;),
                _ =&gt; {
                    println!(&#34;That&#39;s right&#34;);
                    break;
                }
            }
        }
    }
}
</code></pre><p>代码的前两行声明你要做什么。在本例中，<code>rand::Rng</code> 生成一个猜测值，而 <a href=https://doc.rust-lang.org/rust-by-example/trait.html>trait</a> <code>std::io::BufRead</code> 使得可以从标准输入中读取。</p><p>Rust 代码的入口在 <code>main()</code> 函数中，所以下一步就是定义 <code>main()</code>。</p><p>要给一个变量赋值，先放 <code>let</code>，再放变量的名字，后面放 <code>=</code> 号。这样就创建了一个<a href=https://en.wikipedia.org/wiki/Immutable_object>不可变</a>变量。</p><p>Rust 中大多数变量都是不可变的，但是 <code>rng</code> 对象必须是可变的（<code>mut</code>）。例如，语句 <code>let random = 0</code> 给<code>random</code> 变量分配一个零值。</p><p>函数的第一行创建了一个线程安全的 <code>Rng</code> 对象，并将其分配给变量 <code>rng</code>。Rust 是建立在线程和内存安全的基础上的，所以你必须在开始写代码时就考虑到这些事情。</p><p>程序的下一行读取函数 <code>gen_range()</code> 的结果，并将其分配给名为 <code>random</code> 的变量。该函数取一个最小值（包含）和一个上界（不包含）。为了也包含上界，你可以用一个等号来标记较大的数字（例如，<code>1...=100</code>），或者你也可以像我在代码中做的那样，将上界设置为比你的预期最大值大 1。在这种情况下，该范围是 <code>1</code> 到 <code>100</code>，使得游戏刚好有足够的挑战性。</p><p>中央循环在 <code>std::io::stdin()</code> 中迭代行。由于有各种可能导致行不能读取的例外情况，Rust 要求你用一个 <code>Result</code> 来包裹一行。有时候可能无法将一行解析为一个整数。</p><p>这段代码使用条件模式匹配来忽略所有会导致错误的行：</p><pre tabindex=0><code>        let parsed = line.ok().as_deref().map(str::parse::&lt;i64&gt;);
        if let Some(Ok(guess)) = parsed {
            // ...
        }
</code></pre><p>第一行创建了一个 <code>Result&lt;Option&lt;i64>, ...></code> 对象，因为它可能在读取或解析步骤中失败。由于下一行只在 <code>Some(Ok(guess))</code> 上匹配，每当一行的结果是一个不匹配的值时，它就会跳过 <code>if</code> 语句。这是一种强大的忽略错误的方法。</p><p>Rust 支持条件表达式和流程控制，比如循环。在“猜数字”游戏中，只要猜中的值不等于 <code>random</code>，Rust 就会继续循环。</p><p><code>if</code> 语句的主体包含一个 Rust 的 <code>match</code> 语句的三向分支。虽然 <code>match</code> 最常用于模式匹配，但它也可以检查任意条件。在这种情况下是打印一个适当的信息，如果猜测是正确的，则中断（<code>break</code>）循环。</p><h3 id=示例输出>示例输出</h3><p>现在你已经写好了你的 Rust 程序，你可以运行它来玩“猜数字”游戏。每次运行程序时，Rust 都会选择一个不同的随机数，所以继续猜，直到找到正确的数字。</p><pre tabindex=0><code>$ cargo run
   Compiling guess v2020.11.0 (/Users/mzadka/src/guess)
    Finished dev [unoptimized + debuginfo] target(s) in 0.70s
     Running `target/debug/guess`
Guess a number between 1 and 100
50
Too high
25
Too high
12
Too low
18
Too high
15
Too high
13
Too low
14
That&#39;s right
</code></pre><p>典型的做法是用 <code>cargo run</code> 来测试程序。最终，你可能会使用 <code>cargo build</code> 分成两个独立的步骤<a href=https://opensource.com/article/20/3/rust-cargo>构建一个可执行文件并运行它</a>。</p><h3 id=学习-rust>学习 Rust</h3><p>这个“猜数字”游戏是学习一门新的编程语言的一个很好的入门程序，因为它以一种相当直接的方式锻炼了几个常见的编程概念。通过在不同的编程语言中实现这个简单的游戏，你可以展示语言的一些核心概念，并比较它们的细节。</p><p>你有喜欢的编程语言吗？你会如何用它来写“猜数字”游戏呢？请关注本系列文章，看看你可能感兴趣的其他编程语言的例子吧！</p><hr><p>via: <a href=https://opensource.com/article/20/12/learn-rust>https://opensource.com/article/20/12/learn-rust</a></p><p>作者：<a href=https://opensource.com/users/moshez>Moshe Zadka</a> 选题：<a href=https://github.com/lujun9972>lujun9972</a> 译者：<a href=https://github.com/wxy>wxy</a> 校对：<a href=https://github.com/wxy>wxy</a></p><p>本文由 <a href=https://github.com/LCTT/TranslateProject>LCTT</a> 原创编译，<a href=https://linux.cn/>Linux中国</a> 荣誉推出</p></div><footer class=post__footer><div class="post__tags tags clearfix"><svg class="tags__badge icon icon-tag" width="16" height="16" viewBox="0 0 32 32"><path d="M32 19c0 1-1 2-1 2L21 31s-1 1-2 1-2-1-2-1L2 16c-1-1-1.4-2-1.4-2S0 12.5.0 11V3C0 1.5.8.8.8.8S1.5.0 3 0h8c1.5.0 3 .6 3 .6S15 1 16 2l15 15s1 1 1 2zM7 10a3 3 0 100-6 3 3 0 000 6z"/></svg><ul class=tags__list><li class=tags__item><a class="tags__link btn" href=/tags/rust/ rel=tag>Rust</a></li></ul></div></footer></article></main></div></div><footer class=footer><div class="container footer__container flex"><div class=footer__copyright>&copy; 2025 Linux.cn Archive.
<span class=footer__copyright-credits>Generated with <a href=https://gohugo.io/ rel="nofollow noopener" target=_blank>Hugo</a> and <a href=https://github.com/Vimux/Mainroad/ rel="nofollow noopener" target=_blank>Mainroad</a> theme.</span></div></div></footer></div><script async defer src=/js/menu.js></script></body></html>