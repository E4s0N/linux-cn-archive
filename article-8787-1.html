<!doctype html><html class=no-js lang=en><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><title>用 R 收集和映射推特数据的初学者向导 - Linux.cn Archive</title>
<script>(function(e,t){e[t]=e[t].replace("no-js","js")})(document.documentElement,"className")</script><meta name=description content><meta property="og:title" content="用 R 收集和映射推特数据的初学者向导"><meta property="og:description" content="学习使用 R 的 twitteR 和 leaflet 包, 你就可以把任何话题的推文定位画在地图上。"><meta property="og:type" content="article"><meta property="og:url" content="/article-8787-1.html"><meta property="article:section" content="posts"><meta property="article:published_time" content="2017-08-17T15:02:07+00:00"><meta property="article:modified_time" content="2017-08-17T15:02:07+00:00"><meta itemprop=name content="用 R 收集和映射推特数据的初学者向导"><meta itemprop=description content="学习使用 R 的 twitteR 和 leaflet 包, 你就可以把任何话题的推文定位画在地图上。"><meta itemprop=datePublished content="2017-08-17T15:02:07+00:00"><meta itemprop=dateModified content="2017-08-17T15:02:07+00:00"><meta itemprop=wordCount content="324"><meta itemprop=keywords content="R语言,Twitter,"><link rel=preconnect href=https://fonts.bunny.net crossorigin><link rel=dns-prefetch href=//fonts.bunny.net><link rel=dns-prefetch href=//fonts.bunny.net><link rel=stylesheet href="https://fonts.bunny.net/css?family=Open+Sans:400,400i,700"><link rel=stylesheet href=/css/style.css><link rel="shortcut icon" href=/favicon.ico></head><body class=body><div class="container container--outer"><header class=header><div class="container header__container"><div class=logo><a class=logo__link href=/ title="Linux.cn Archive" rel=home><div class="logo__item logo__text"><div class=logo__title>Linux.cn Archive</div></div></a></div><nav class=menu><button class=menu__btn aria-haspopup=true aria-expanded=false tabindex=0>
<span class=menu__btn-title tabindex=-1>Menu</span></button><ul class=menu__list><li class=menu__item><a class=menu__link href=/><span class=menu__text>Home</span></a></li><li class=menu__item><a class=menu__link href=/categories/><span class=menu__text>Categories</span></a></li><li class=menu__item><a class=menu__link href=/tags/><span class=menu__text>Tags</span></a></li><li class=menu__item><a class=menu__link href><span class=menu__text>RSS</span></a></li></ul></nav></div></header><div class="wrapper flex"><div class=primary><main class=main role=main><article class=post><header class=post__header><h1 class=post__title>用 R 收集和映射推特数据的初学者向导</h1><div class="post__meta meta"><div class="meta__item-datetime meta__item"><svg class="meta__icon icon icon-time" width="16" height="14" viewBox="0 0 30 28"><path d="M15 0C7 0 1 6 1 14s6 14 14 14 14-6 14-14S23 0 15 0zm0 25C9 25 4 20 4 14S9 3 15 3s11 5 11 11-5 11-11 11zm1-18h-2v8.4l6.8 4.4L22 18l-6-3.8V7z"/></svg><time class=meta__text datetime=2017-08-17T15:02:07Z>August 17, 2017</time></div></div></header><div class="content post__content clearfix"><blockquote><p>学习使用 R 的 twitteR 和 leaflet 包, 你就可以把任何话题的推文定位画在地图上。</p></blockquote><p><img src=/data/attachment/album/201708/17/150211n9wjnx9pk91f4wtk.png alt="用 R 收集和映射推特数据的初学者向导" title="用 R 收集和映射推特数据的初学者向导"></p><p>当我开始学习 R ，我也需要学习如何出于研究的目的地收集推特数据并对其进行映射。尽管网上关于这个话题的信息很多，但我发觉难以理解什么与收集并映射推特数据相关。我不仅是个 R 新手，而且对各种教程中技术名词不熟悉。但尽管困难重重，我成功了！在这个教程里，我将以一种新手程序员都能看懂的方式来攻略如何收集推特数据并将至展现在地图中。</p><h3 id=创建应用程序>创建应用程序</h3><p>如果你没有推特帐号，首先你需要 <a href=https://twitter.com/signup>注册一个</a>。然后，到 <a href=https://apps.twitter.com/>apps.twitter.com</a> 创建一个允许你收集推特数据的应用程序。别担心，创建应用程序极其简单。你创建的应用程序会与推特应用程序接口（API）相连。 想象 API 是一个多功能电子个人助手。你可以使用 API 让其它程序帮你做事。这样一来，你可以接入推特 API 令其收集数据。只需确保不要请求太多，因为推特数据请求次数是有<a href=https://dev.twitter.com/rest/public/rate-limiting>限制</a> 的。</p><p>收集推文有两个可用的 API 。你若想做一次性的推文收集，那么使用 <strong>REST API</strong>. 若是想在特定时间内持续收集，可以用 <strong>streaming API</strong>。教程中我主要使用 REST API。</p><p>创建应用程序之后，前往 <strong>Keys and Access Tokens</strong> 标签。你需要 Consumer Key (API key)、 Consumer Secret (API secret)、 Access Token 和 Access Token Secret 才能在 R 中访问你的应用程序。</p><h3 id=收集推特数据>收集推特数据</h3><p>下一步是打开 R 准备写代码。对于初学者，我推荐使用 <a href=https://www.rstudio.com/>RStudio</a>，这是 R 的集成开发环境 (IDE) 。我发现 RStudio 在解决问题和测试代码时很实用。 R 有访问该 REST API 的包叫 <strong><a href=https://cran.r-project.org/web/packages/twitteR/twitteR.pdf>twitteR</a></strong>。</p><p>打开 RStudio 并新建 RScript。做好这些之后，你需要安装和加载 <strong>twitteR</strong> 包:</p><pre tabindex=0><code>install.packages(&#34;twitteR&#34;) 
#安装 TwitteR
library (twitteR) 
#载入 TwitteR
</code></pre><p>安装并载入 <strong>twitteR</strong> 包之后，你得输入上文提及的应用程序的 API 信息：</p><pre tabindex=0><code>api_key &lt;- &#34;&#34; 
 #在引号内放入你的 API key 
api_secret &lt;- &#34;&#34; 
 #在引号内放入你的 API secret token 
token &lt;- &#34;&#34; 
 #在引号内放入你的 token
token_secret &lt;- &#34;&#34; 
 #在引号内放入你的 token secret
</code></pre><p>接下来，连接推特访问 API：</p><pre tabindex=0><code>setup_twitter_oauth(api_key, api_secret, token, token_secret)
</code></pre><p>我们来试试让推特搜索有关社区花园和农夫市场：</p><pre tabindex=0><code>tweets &lt;- searchTwitter(&#34;community garden OR #communitygarden OR farmers market OR #farmersmarket&#34;, n = 200, lang = &#34;en&#34;)
</code></pre><p>这个代码意思是搜索前 200 篇 <code>(n = 200)</code> 英文 <code>(lang = "en")</code> 的推文, 包括关键词 <code>community garden</code> 或 <code>farmers market</code> 或任何提及这些关键词的话题标签。</p><p>推特搜索完成之后，在数据框中保存你的结果：</p><pre tabindex=0><code>tweets.df &lt;-twListToDF(tweets)
</code></pre><p>为了用推文创建地图，你需要收集的导出为 <strong>.csv</strong> 文件:</p><pre tabindex=0><code>write.csv(tweets.df, &#34;C:\Users\YourName\Documents\ApptoMap\tweets.csv&#34;) 
 #an example of a file extension of the folder in which you want to save the .csv file.
</code></pre><p>运行前确保 <strong>R</strong> 代码已保存然后继续进行下一步。.</p><h3 id=生成地图>生成地图</h3><p>现在你有了可以展示在地图上的数据。在此教程中，我们将用一个 R 包 <strong><a href=https://rstudio.github.io/leaflet>Leaflet</a></strong> 做一个基本的应用程序，这是一个生成交互式地图的热门 JavaScript 库。 Leaflet 使用 <a href=https://github.com/smbache/magrittr>magrittr</a> 管道运算符 (<code>%>%</code>)， 因为其语法自然，易于写代码。刚接触可能有点奇怪，但它确实降低了写代码的工作量。</p><p>为了清晰起见，在 RStudio 打开一个新的 R 脚本安装这些包：</p><pre tabindex=0><code>install.packages(&#34;leaflet&#34;)
install.packages(&#34;maps&#34;) 
library(leaflet)
library(maps)
</code></pre><p>现在需要一个路径让 Leaflet 访问你的数据：</p><pre tabindex=0><code>read.csv(&#34;C:\Users\YourName\Documents\ApptoMap\tweets.csv&#34;, stringsAsFactors = FALSE)
</code></pre><p><code>stringAsFactors = FALSE</code> 意思是保留信息，不将它转化成 factors。 (想了解 factors，读这篇文章<a href=http://simplystatistics.org/2015/07/24/stringsasfactors-an-unauthorized-biography/>&ldquo;stringsAsFactors: An unauthorized biography&rdquo;</a>， 作者 Roger Peng）</p><p>是时候制作你的 Leaflet 地图了。我们将使用 <strong>OpenStreetMap</strong>基本地图来做你的地图：</p><pre tabindex=0><code>m &lt;- leaflet(mymap) %&gt;% addTiles()
</code></pre><p>我们在基本地图上加个圈。对于 <code>lng</code> 和 <code>lat</code>，输入包含推文的经纬度的列名，并在前面加个<code>~</code>。 <code>~longitude</code> 和 <code>~latitude</code> 指向你的 <strong>.csv</strong> 文件中与列名：</p><pre tabindex=0><code>m %&gt;% addCircles(lng = ~longitude, lat = ~latitude, popup = mymap$type, weight = 8, radius = 40, color = &#34;#fb3004&#34;, stroke = TRUE, fillOpacity = 0.8)
</code></pre><p>运行你的代码。会弹出网页浏览器并展示你的地图。这是我前面收集的推文的地图：</p><p><img src=/data/attachment/album/201708/17/150211us845om3tpz3l4mz.jpg alt=推文定位地图 title=推文定位地图></p><p>带定位的推文地图，使用了 Leaflet 和 OpenStreetMap <a href=https://creativecommons.org/licenses/by-sa/2.0/>CC-BY-SA</a></p><p>虽然你可能会对地图上的图文数量如此之小感到惊奇，通常只有 1% 的推文记录了地理编码。我收集了总数为 366 的推文，但只有 10（大概总推文的 3%）是记录了地理编码的。如果你为得到记录了地理编码的推文而困扰，改变搜索关键词看看能不能得到更好的结果。</p><h3 id=总结>总结</h3><p>对于初学者，把以上所有碎片结合起来，从推特数据生成一个 Leaflet 地图可能很艰难。 这个教程基于我完成这个任务的经验，我希望它能让你的学习过程变得更轻松。</p><p>（题图：<a href=https://opensource.com/users/jason-baker>琼斯·贝克</a>. <a href=https://creativecommons.org/licenses/by-sa/4.0/>CC BY-SA 4.0</a>. 来源: <a href=https://pixabay.com/en/clouds-sky-cloud-dark-clouds-1473311/>Cloud</a>, <a href=https://pixabay.com/en/globe-planet-earth-world-1015311/>Globe</a>. Both <a href=https://creativecommons.org/publicdomain/zero/1.0/>CC0</a>.）</p><hr><p>作者简介：</p><p>Dorris Scott - Dorris Scott 是佐治亚大学的地理学博士生。她的研究重心是地理信息系统（GIS）、 地理数据科学、可视化和公共卫生。她的论文是在一个 GIS 系统接口将退伍军人福利医院的传统和非传统数据结合起来，帮助病人为他们的健康状况作出更为明朗的决定。</p><hr><p>via: <a href=https://opensource.com/article/17/6/collecting-and-mapping-twitter-data-using-r>https://opensource.com/article/17/6/collecting-and-mapping-twitter-data-using-r</a></p><p>作者：<a href=https://opensource.com/users/dorrisscott>Dorris Scott</a> 译者：<a href=https://github.com/XYenChi>XYenChi</a> 校对：<a href=https://github.com/wxy>wxy</a></p><p>本文由 <a href=https://github.com/LCTT/TranslateProject>LCTT</a> 原创编译，<a href=https://linux.cn/>Linux中国</a> 荣誉推出</p></div><footer class=post__footer><div class="post__tags tags clearfix"><svg class="tags__badge icon icon-tag" width="16" height="16" viewBox="0 0 32 32"><path d="M32 19c0 1-1 2-1 2L21 31s-1 1-2 1-2-1-2-1L2 16c-1-1-1.4-2-1.4-2S0 12.5.0 11V3C0 1.5.8.8.8.8S1.5.0 3 0h8c1.5.0 3 .6 3 .6S15 1 16 2l15 15s1 1 1 2zM7 10a3 3 0 100-6 3 3 0 000 6z"/></svg><ul class=tags__list><li class=tags__item><a class="tags__link btn" href=/tags/r%E8%AF%AD%E8%A8%80/ rel=tag>R语言</a></li><li class=tags__item><a class="tags__link btn" href=/tags/twitter/ rel=tag>Twitter</a></li></ul></div></footer></article></main></div></div><footer class=footer><div class="container footer__container flex"><div class=footer__copyright>&copy; 2025 Linux.cn Archive.
<span class=footer__copyright-credits>Generated with <a href=https://gohugo.io/ rel="nofollow noopener" target=_blank>Hugo</a> and <a href=https://github.com/Vimux/Mainroad/ rel="nofollow noopener" target=_blank>Mainroad</a> theme.</span></div></div></footer></div><script async defer src=/js/menu.js></script></body></html>