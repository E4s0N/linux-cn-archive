<!doctype html><html class=no-js lang=en><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><title>NGINX Plus 现在完全支持 HTTP/2 - Linux.cn Archive</title>
<script>(function(e,t){e[t]=e[t].replace("no-js","js")})(document.documentElement,"className")</script><meta name=description content><meta property="og:title" content="NGINX Plus 现在完全支持 HTTP/2"><meta property="og:description" content="早些时候，我们发布了支持 HTTP/2 协议的 NGINX Plus R7。作为 HTTP 协议的最新标准，HTTP/2 的设计为现在的 web 应用程序带来了更高的性能和安全性。（LCTT 译注： 开源版本的 NGINX 1.95 也支持 HTTP/2 了。） NGINX Plus 所实现的 HTTP/2 协议可与现有的网站和应用程序进行无缝衔接。只需要一点改变，不管用户选择什么样的浏览器，NGINX Plus 都能为用户同时提供 HTTP/1.x 与HTTP/2 的最佳体验。 要支持 HTTP/2 仅需通过可选的 nginx‑plus‑http2 软件包。nginx‑plus 和 nginx‑plus‑extras 软件包支持 SPDY 协议，目前推荐用于生产"><meta property="og:type" content="article"><meta property="og:url" content="/article-6368-1.html"><meta property="article:section" content="posts"><meta property="article:published_time" content="2015-10-08T09:15:00+00:00"><meta property="article:modified_time" content="2015-10-08T09:15:00+00:00"><meta itemprop=name content="NGINX Plus 现在完全支持 HTTP/2"><meta itemprop=description content="早些时候，我们发布了支持 HTTP/2 协议的 NGINX Plus R7。作为 HTTP 协议的最新标准，HTTP/2 的设计为现在的 web 应用程序带来了更高的性能和安全性。（LCTT 译注： 开源版本的 NGINX 1.95 也支持 HTTP/2 了。） NGINX Plus 所实现的 HTTP/2 协议可与现有的网站和应用程序进行无缝衔接。只需要一点改变，不管用户选择什么样的浏览器，NGINX Plus 都能为用户同时提供 HTTP/1.x 与HTTP/2 的最佳体验。 要支持 HTTP/2 仅需通过可选的 nginx‑plus‑http2 软件包。nginx‑plus 和 nginx‑plus‑extras 软件包支持 SPDY 协议，目前推荐用于生产"><meta itemprop=datePublished content="2015-10-08T09:15:00+00:00"><meta itemprop=dateModified content="2015-10-08T09:15:00+00:00"><meta itemprop=wordCount content="370"><meta itemprop=keywords content="nginx,HTTP/2,"><link rel=preconnect href=https://fonts.bunny.net crossorigin><link rel=dns-prefetch href=//fonts.bunny.net><link rel=dns-prefetch href=//fonts.bunny.net><link rel=stylesheet href="https://fonts.bunny.net/css?family=Open+Sans:400,400i,700"><link rel=stylesheet href=/css/style.css><link rel="shortcut icon" href=/favicon.ico></head><body class=body><div class="container container--outer"><header class=header><div class="container header__container"><div class=logo><a class=logo__link href=/ title="Linux.cn Archive" rel=home><div class="logo__item logo__text"><div class=logo__title>Linux.cn Archive</div></div></a></div><nav class=menu><button class=menu__btn aria-haspopup=true aria-expanded=false tabindex=0>
<span class=menu__btn-title tabindex=-1>Menu</span></button><ul class=menu__list><li class=menu__item><a class=menu__link href=/><span class=menu__text>Home</span></a></li><li class=menu__item><a class=menu__link href=/categories/><span class=menu__text>Categories</span></a></li><li class=menu__item><a class=menu__link href=/tags/><span class=menu__text>Tags</span></a></li><li class=menu__item><a class=menu__link href><span class=menu__text>RSS</span></a></li></ul></nav></div></header><div class="wrapper flex"><div class=primary><main class=main role=main><article class=post><header class=post__header><h1 class=post__title>NGINX Plus 现在完全支持 HTTP/2</h1><div class="post__meta meta"><div class="meta__item-datetime meta__item"><svg class="meta__icon icon icon-time" width="16" height="14" viewBox="0 0 30 28"><path d="M15 0C7 0 1 6 1 14s6 14 14 14 14-6 14-14S23 0 15 0zm0 25C9 25 4 20 4 14S9 3 15 3s11 5 11 11-5 11-11 11zm1-18h-2v8.4l6.8 4.4L22 18l-6-3.8V7z"/></svg><time class=meta__text datetime=2015-10-08T09:15:00Z>October 08, 2015</time></div></div></header><div class="content post__content clearfix"><p>早些时候，我们发布了支持 HTTP/2 协议的 <a href=https://www.nginx.com/blog/nginx-plus-r7-released/>NGINX Plus R7</a>。作为 HTTP 协议的最新标准，HTTP/2 的设计为现在的 web 应用程序带来了更高的性能和安全性。（LCTT 译注： <a href=http://mailman.nginx.org/pipermail/nginx-announce/2015/000162.html>开源版本的 NGINX 1.95 也支持 HTTP/2 了</a>。）</p><p>NGINX Plus 所实现的 HTTP/2 协议可与现有的网站和应用程序进行无缝衔接。只需要一点改变，不管用户选择什么样的浏览器，NGINX Plus 都能为用户同时提供 HTTP/1.x 与HTTP/2 的最佳体验。</p><p>要支持 HTTP/2 仅需通过可选的 <strong>nginx‑plus‑http2</strong> 软件包。<strong>nginx‑plus</strong> 和 <strong>nginx‑plus‑extras</strong> 软件包支持 SPDY 协议，目前推荐用于生产站点，因为其被大多数浏览器所支持并且代码也是相当成熟了。</p><h3 id=为什么要使用-http2>为什么要使用 HTTP/2？</h3><p>HTTP/2 使数据传输更高效，对你的应用程序更安全。 HTTP/2 相比于 HTTP/1.x 有五个提高性能特点：</p><ul><li><strong>完全复用</strong> – 在一个保持激活（keepalive）的连接上，HTTP/1.1 强制按严格的顺序来处理请求。一个请求必须在下一个请求开始前结束。 HTTP/2 消除了这一要求，允许并行和乱序来处理请求。</li><li><strong>单一，持久连接</strong> – 由于 HTTP/2 允许请求完全复用，所以可以通过单一连接并行下载网页上的所有对象。在 HTTP/1.x 中，使用多个连接来并行下载资源，从而导致使用底层 TCP 协议效率很低。</li><li><strong>二进制编码</strong> – Header 信息使用紧凑的二进制格式发送，而不是纯文本格式，节省了传输字节。</li><li><strong>Header 压缩</strong> – Headers 使用专用的 HPACK 压缩算法来进行压缩，这进一步降低数据通过网络传输的字节。</li><li><strong>SSL/TLS 加密</strong> – 在 HTTP/2 中，强制使用 SSL/TLS。在 <a href=https://tools.ietf.org/html/rfc7540>RFC</a> 中并没有强制，其允许纯文本的 HTTP/2，但是当前所有实现 HTTP/2的 Web 浏览器都只支持加密。 SSL/TLS 可以使你的网站更安全，并且使用 HTTP/2 各项性能会有提升，加密和解密过程的性能损失就减少了。</li></ul><p>要了解更多关于 HTTP/2:</p><ul><li>请阅读我们的 <a href=https://www.nginx.com/wp-content/uploads/2015/09/NGINX_HTTP2_White_Paper_v4.pdf>白皮书</a>，它涵盖了你需要了解HTTP/2 的一切。</li><li>下载由 Google 的 Ilya Grigorik 编写的 <a href=https://www.nginx.com/http2-ebook/>特别版的高性能浏览器网络电子书</a> （ LCTT 译注：涵盖 HTTP/2 的部分）。</li></ul><h3 id=nginx-plus-如何实现-http2>NGINX Plus 如何实现 HTTP/2</h3><p>我们的 HTTP/2 实现是基于 SPDY 支持的，它已经被广泛部署（使用了 NGINX 或 NGINX Plus 的网站近 75％ 都使用了 SPDY）。使用 NGINX Plus 部署 HTTP/2 时，几乎不会改变你应用程序的配置。本节将讨论 NGINX Plus如何实现对 HTTP/2 的支持。</p><h4 id=一个-http2-网关>一个 HTTP/2 网关</h4><p><img src=/data/attachment/album/201510/08/091503qx6864ajaudyo6i6.png alt></p><p>NGINX Plus 作为一个 HTTP/2 网关。它与支持 HTTP/2 的客户端 Web 浏览器用 HTTP/2 通讯，而转换 HTTP/2 请求给后端服务器通信时使用 HTTP/1.x（或者 FastCGI, SCGI, uWSGI, 等等. – 取决于你目前正在使用的协议）。</p><h4 id=向后兼容性>向后兼容性</h4><p><img src=/data/attachment/album/201510/08/091504enuwwbbqaopwlwwk.png alt></p><p>在一段时间内，你需要同时支持 HTTP/2 和 HTTP/1.x。在撰写本文时，超过50％的用户使用的 Web 浏览器已经<a href="http://caniuse.com/#feat=http2">支持 HTTP/2</a>，但这也意味着近50％的人还没有使用。</p><p>为了同时支持 HTTP/1.x 和 HTTP/2，NGINX Plus 实现了 TLS 上的 Next Protocol Negotiation (NPN)扩展。当 Web 浏览器连接到服务器时，其将所支持的协议列表发送到服务器端。如果浏览器支持的协议列表中包括 h2 - 即 HTTP/2，NGINX Plus 将使用 HTTP/2 连接到浏览器。如果浏览器不支持 NPN 或在发送支持的协议列表中没有 h2，NGINX Plus 将继续回落到 HTTP/1.x。</p><h3 id=转向-http2>转向 HTTP/2</h3><p>NGINX 公司会尽可能帮助大家无缝过渡到使用 HTTP/2。本节介绍了通过对你应用进行改变来启用对 HTTP/2 支持，其中只需对 NGINX Plus 配置进行几个变化。</p><h4 id=前提条件>前提条件</h4><p>使用 <strong>nginx‑plus‑http2</strong> 软件包升级到 NGINX Plus R7。注意现在还没有支持 HTTP/2 版本的 <strong>nginx‑plus‑extras</strong> 软件包。</p><h4 id=重定向所有流量到-ssltls>重定向所有流量到 SSL/TLS</h4><p>如果你的应用尚未使用 SSL/TLS 加密，现在启用它正是一个好的时机。加密你的应用程序可以保护你免受间谍以及来自其他中间人的攻击。一些搜索引擎甚至在搜索结果中对加密站点<a href=http://googlewebmastercentral.blogspot.co.uk/2014/08/https-as-ranking-signal.html>提高排名</a>。下面的配置块重定向所有的普通 HTTP 请求到该网站的加密版本。</p><pre tabindex=0><code>server {
    listen 80;
    location / {
        return 301 https://$host$request_uri;
    }
}
</code></pre><h4 id=启用-http2>启用 HTTP/2</h4><p>要启用对 HTTP/2 的支持，只需将 http2 参数添加到所有的 <a href=http://nginx.org/en/docs/http/ngx_http_core_module.html#listen>listen</a> 指令中，也要包括 SSL 参数，因为浏览器不支持不加密的 HTTP/2 请求。</p><pre tabindex=0><code>server {
    listen 443 ssl http2 default_server;

    ssl_certificate     server.crt;
    ssl_certificate_key server.key;
    …
}
</code></pre><p>如果有必要，重启 NGINX Plus，例如通过运行 <code>nginx -s reload</code> 命令。要验证 HTTP/2 是否正常工作，你可以在 <a href="https://chrome.google.com/webstore/detail/http2-and-spdy-indicator/mpbpobfflnpcgagjijhmgnchggcjblin?hl=en">Google Chrome</a> 和 <a href=https://addons.mozilla.org/en-us/firefox/addon/spdy-indicator/>Firefox</a> 中使用 “HTTP/2 and SPDY indicator” 插件来检查。</p><h3 id=注意事项>注意事项</h3><ul><li>在安装 <strong>nginx‑plus‑http2</strong> 包之前, 你必须删除配置文件中所有 listen 指令后的 SPDY 参数（使用 http2 和 ssl 参数来替换它以启用对 HTTP/2 的支持）。使用这个包后，如果 listen 指令后有 spdy 参数，NGINX Plus 将无法启动。</li><li>如果你在 NGINX Plus 前端使用了 Web 应用防火墙（WAF），请确保它能够解析 HTTP/2，或者把它移到 NGINX Plus 后面。</li><li>此版本不支持在 HTTP/2 RFC 中定义的 “Server Push” 特性。 NGINX Plus 以后的版本可能会支持它。</li><li>NGINX Plus R7 同时支持 SPDY 和 HTTP/2（LCTT 译注：但是你只能同时使用其中一种）。在以后的版本中，我们将弃用对 SPDY 的支持。谷歌在2016年初将 <a href=http://blog.chromium.org/2015/02/hello-http2-goodbye-spdy-http-is_9.html>弃用 SPDY</a>，因此同时支持这两种协议也非必要。</li><li>如果 <a href=http://nginx.org/en/docs/http/ngx_http_ssl_module.html#ssl_prefer_server_ciphers>ssl_prefer_server_ciphers</a> 设置为 on 或者使用了定义在 <a href=https://tools.ietf.org/html/rfc7540#appendix-A>Appendix A: TLS 1.2 Ciper Suite Black List</a> 中的 <a href=http://nginx.org/en/docs/http/ngx_http_ssl_module.html#ssl_ciphers>ssl_ciphers</a> 列表时，浏览器会出现 handshake-errors 而无法正常工作。详细内容请参阅 <a href=https://tools.ietf.org/html/rfc7540#section-9.2.2>section 9.2.2 of the HTTP/2 RFC</a>。</li></ul><h3 id=特别感谢>特别感谢</h3><p>NGINX 公司要感谢 <a href=http://dropbox.com/>Dropbox</a> 和 <a href=http://automattic.com/>Automattic</a>，他们是我们软件的重度使用者，并帮助我们实现 HTTP/2。他们的贡献帮助我们加速完成这个软件，我们希望你也能支持他们。</p><hr><p>via: <a href=https://www.nginx.com/blog/http2-r7/>https://www.nginx.com/blog/http2-r7/</a></p><p>作者：<a href=https://www.nginx.com/blog/author/fmemon/>Faisal Memon</a> 译者：<a href=https://github.com/strugglingyouth>strugglingyouth</a> 校对：<a href=https://github.com/wxy>wxy</a></p><p>本文由 <a href=https://github.com/LCTT/TranslateProject>LCTT</a> 原创编译，<a href=https://linux.cn/>Linux中国</a> 荣誉推出</p></div><footer class=post__footer><div class="post__tags tags clearfix"><svg class="tags__badge icon icon-tag" width="16" height="16" viewBox="0 0 32 32"><path d="M32 19c0 1-1 2-1 2L21 31s-1 1-2 1-2-1-2-1L2 16c-1-1-1.4-2-1.4-2S0 12.5.0 11V3C0 1.5.8.8.8.8S1.5.0 3 0h8c1.5.0 3 .6 3 .6S15 1 16 2l15 15s1 1 1 2zM7 10a3 3 0 100-6 3 3 0 000 6z"/></svg><ul class=tags__list><li class=tags__item><a class="tags__link btn" href=/tags/nginx/ rel=tag>nginx</a></li><li class=tags__item><a class="tags__link btn" href=/tags/http/2/ rel=tag>HTTP/2</a></li></ul></div></footer></article></main></div></div><footer class=footer><div class="container footer__container flex"><div class=footer__copyright>&copy; 2025 Linux.cn Archive.
<span class=footer__copyright-credits>Generated with <a href=https://gohugo.io/ rel="nofollow noopener" target=_blank>Hugo</a> and <a href=https://github.com/Vimux/Mainroad/ rel="nofollow noopener" target=_blank>Mainroad</a> theme.</span></div></div></footer></div><script async defer src=/js/menu.js></script></body></html>