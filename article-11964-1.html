<!doctype html><html class=no-js lang=en><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><title>使用 Fedora 31 和 Nextcloud 服务器构建自己的云 - Linux.cn Archive</title>
<script>(function(e,t){e[t]=e[t].replace("no-js","js")})(document.documentElement,"className")</script><meta name=description content><meta property="og:title" content="使用 Fedora 31 和 Nextcloud 服务器构建自己的云"><meta property="og:description" content="本文通过几个简单的步骤演示了如何使用 Fedora 和 Nextcloud 构建个人云。"><meta property="og:type" content="article"><meta property="og:url" content="/article-11964-1.html"><meta property="article:section" content="posts"><meta property="article:published_time" content="2020-03-06T09:32:41+00:00"><meta property="article:modified_time" content="2020-03-06T09:32:41+00:00"><meta itemprop=name content="使用 Fedora 31 和 Nextcloud 服务器构建自己的云"><meta itemprop=description content="本文通过几个简单的步骤演示了如何使用 Fedora 和 Nextcloud 构建个人云。"><meta itemprop=datePublished content="2020-03-06T09:32:41+00:00"><meta itemprop=dateModified content="2020-03-06T09:32:41+00:00"><meta itemprop=wordCount content="600"><meta itemprop=keywords content="Nextcloud,"><link rel=preconnect href=https://fonts.bunny.net crossorigin><link rel=dns-prefetch href=//fonts.bunny.net><link rel=dns-prefetch href=//fonts.bunny.net><link rel=stylesheet href="https://fonts.bunny.net/css?family=Open+Sans:400,400i,700"><link rel=stylesheet href=/css/style.css><link rel="shortcut icon" href=/favicon.ico></head><body class=body><div class="container container--outer"><header class=header><div class="container header__container"><div class=logo><a class=logo__link href=/ title="Linux.cn Archive" rel=home><div class="logo__item logo__text"><div class=logo__title>Linux.cn Archive</div></div></a></div><nav class=menu><button class=menu__btn aria-haspopup=true aria-expanded=false tabindex=0>
<span class=menu__btn-title tabindex=-1>Menu</span></button><ul class=menu__list><li class=menu__item><a class=menu__link href=/><span class=menu__text>Home</span></a></li><li class=menu__item><a class=menu__link href=/categories/><span class=menu__text>Categories</span></a></li><li class=menu__item><a class=menu__link href=/tags/><span class=menu__text>Tags</span></a></li><li class=menu__item><a class=menu__link href><span class=menu__text>RSS</span></a></li></ul></nav></div></header><div class="wrapper flex"><div class=primary><main class=main role=main><article class=post><header class=post__header><h1 class=post__title>使用 Fedora 31 和 Nextcloud 服务器构建自己的云</h1><div class="post__meta meta"><div class="meta__item-datetime meta__item"><svg class="meta__icon icon icon-time" width="16" height="14" viewBox="0 0 30 28"><path d="M15 0C7 0 1 6 1 14s6 14 14 14 14-6 14-14S23 0 15 0zm0 25C9 25 4 20 4 14S9 3 15 3s11 5 11 11-5 11-11 11zm1-18h-2v8.4l6.8 4.4L22 18l-6-3.8V7z"/></svg><time class=meta__text datetime=2020-03-06T09:32:41Z>March 06, 2020</time></div></div></header><div class="content post__content clearfix"><p><img src=/data/attachment/album/202003/06/093246ehccgz6dgec0votz.png alt></p><p><a href=https://nextcloud.com/>Nextcloud</a> 是用于跨多个设备存储和同步数据的软件套件。你可以从 <a href=https://github.com/nextcloud/server#nextcloud-server->https://github.com/nextcloud/server</a> 了解有关 Nextcloud 服务器的更多特性信息。</p><p>本文通过几个简单的步骤演示了如何使用 Fedora 和 Nextcloud 构建个人云。对于本教程，你将需要一台独立计算机或运行 Fedora 31 服务器版的虚拟机，还需要互联网连接。</p><h3 id=步骤-1预先安装条件>步骤 1：预先安装条件</h3><p>在安装和配置 Nextcloud 之前，必须满足一些预先条件。</p><p>首先，安装 Apache Web 服务器：</p><pre tabindex=0><code># dnf install httpd
</code></pre><p>接下来，安装 PHP 和一些其他模块。确保所安装的 PHP 版本符合 <a href=https://docs.nextcloud.com/server/17/admin_manual/installation/system_requirements.html#server>Nextcloud 的要求</a>：</p><pre tabindex=0><code># dnf install php php-gd php-mbstring php-intl php-pecl-apcu php-mysqlnd php-pecl-redis php-opcache php-imagick php-zip php-process
</code></pre><p>安装 PHP 后，启用并启动 Apache Web 服务器：</p><pre tabindex=0><code># systemctl enable --now httpd
</code></pre><p>接下来，允许 HTTP 流量穿过防火墙：</p><pre tabindex=0><code># firewall-cmd --permanent --add-service=http
# firewall-cmd --reload
</code></pre><p>接下来，安装 MariaDB 服务器和客户端：</p><pre tabindex=0><code># dnf install mariadb mariadb-server
</code></pre><p>然后启用并启动 MariaDB 服务器</p><pre tabindex=0><code># systemctl enable --now mariadb
</code></pre><p>现在，MariaDB 正在运行，你可以运行 <code>mysql_secure_installation</code> 命令来保护它：</p><pre tabindex=0><code># mysql_secure_installation

NOTE: RUNNING ALL PARTS OF THIS SCRIPT IS RECOMMENDED FOR ALL
      MariaDB SERVERS IN PRODUCTION USE!  PLEASE READ EACH STEP
      CAREFULLY!

In order to log into MariaDB to secure it, we&#39;ll need the
current password for the root user.  If you&#39;ve just installed
MariaDB, and you haven&#39;t set the root password yet, the password
will be blank, so you should just press enter here.

Enter current password for root (enter for none): &lt;ENTER&gt;
OK, successfully used password, moving on...

Setting the root password ensures that nobody can log into
the MariaDB root user without the proper authorization.

Set root password? [Y/n] &lt;ENTER&gt;
New password: Your_Password_Here
Re-enter new password: Your_Password_Here

Password updated successfully!

Reloading privilege tables...
 ... Success!

By default, a MariaDB installation has an anonymous user,
allowing anyone to log into MariaDB without having to have
a user account created for them.  This is intended only for
testing, and to make the installation go a bit smoother.  You
should remove them before moving into a production environment.

Remove anonymous users? [Y/n] &lt;ENTER&gt;
 ... Success!

Normally, root should only be allowed to connect from
&#39;localhost&#39;.  This ensures that someone cannot guess at the
root password from the network.

Disallow root login remotely? [Y/n] &lt;ENTER&gt;
 ... Success!

By default, MariaDB comes with a database named &#39;test&#39; that
anyone can access.  This is also intended only for testing, and
should be removed before moving into a production environment.

Remove test database and access to it? [Y/n] &lt;ENTER&gt;

 - Dropping test database...
 ... Success!

 - Removing privileges on test database...
 ... Success!

Reloading the privilege tables will ensure that all changes
made so far will take effect immediately.

Reload privilege tables now? [Y/n] &lt;ENTER&gt;
 ... Success!

Cleaning up...

All done!  If you&#39;ve completed all of the above steps, your
MariaDB installation should now be secure.

Thanks for using MariaDB!
</code></pre><p>接下来，为你的 Nextcloud 实例创建独立的用户和数据库：</p><pre tabindex=0><code># mysql -p
&gt; create database nextcloud;
&gt; create user &#39;nc_admin&#39;@&#39;localhost&#39; identified by &#39;SeCrEt&#39;;
&gt; grant all privileges on nextcloud.* to &#39;nc_admin&#39;@&#39;localhost&#39;;
&gt; flush privileges;
&gt; exit;
</code></pre><h3 id=步骤-2安装-nextcloud-服务器>步骤 2：安装 Nextcloud 服务器</h3><p>现在，你已满足 Nextcloud 安装的预先条件，请下载并解压 <a href=https://nextcloud.com/install/#instructions-server>Nextcloud 压缩包</a>：</p><pre tabindex=0><code># wget https://download.nextcloud.com/server/releases/nextcloud-17.0.2.zip
# unzip nextcloud-17.0.2.zip -d /var/www/html/
</code></pre><p>接下来，创建一个数据文件夹，并授予 Apache 对 <code>nextcloud</code> 目录树的读写访问权限：</p><pre tabindex=0><code># mkdir /var/www/html/nextcloud/data
# chown -R apache:apache /var/www/html/nextcloud
</code></pre><p>SELinux 必须配置为可与 Nextcloud 一起使用。基本命令如下所示，但在 nexcloud 安装中还有很多其他的命令，发布在这里：<a href=https://docs.nextcloud.com/server/17/admin_manual/installation/selinux_configuration.html>Nextcloud SELinux 配置</a>。</p><pre tabindex=0><code># semanage fcontext -a -t httpd_sys_rw_content_t &#39;/var/www/html/nextcloud/config(/.*)?&#39;
# semanage fcontext -a -t httpd_sys_rw_content_t &#39;/var/www/html/nextcloud/apps(/.*)?&#39;
# semanage fcontext -a -t httpd_sys_rw_content_t &#39;/var/www/html/nextcloud/data(/.*)?&#39;
# semanage fcontext -a -t httpd_sys_rw_content_t &#39;/var/www/html/nextcloud/.user.ini&#39;
# semanage fcontext -a -t httpd_sys_rw_content_t &#39;/var/www/html/nextcloud/3rdparty/aws/aws-sdk-php/src/data/logs(/.*)?&#39;
# restorecon -Rv &#39;/var/www/html/nextcloud/&#39;
</code></pre><h3 id=步骤-3配置-nextcloud>步骤 3：配置 Nextcloud</h3><p>可以使用它的 Web 界面或在命令行配置 Nextcloud。</p><h4 id=使用-web-界面>使用 Web 界面</h4><p>在你喜欢的浏览器中，访问 <a href=http://your_server_ip/nextcloud>http://your_server_ip/nextcloud</a> 并输入字段：</p><p><img src=/data/attachment/album/202003/06/093247exjcju42exjnit1h.png alt></p><h4 id=使用命令行>使用命令行</h4><p>在命令行中，只需输入以下内容，使用你之前在 MariaDB 中创建的独立 Nextcloud 用户替换相应的值：</p><pre tabindex=0><code># sudo -u apache php occ maintenance:install --data-dir /var/www/html/nextcloud/data/ --database &#34;mysql&#34; --database-name &#34;nextcloud&#34; --database-user &#34;nc_admin&#34; --database-pass &#34;DB_SeCuRe_PaSsWoRd&#34; --admin-user &#34;admin&#34; --admin-pass &#34;Admin_SeCuRe_PaSsWoRd&#34;
</code></pre><h3 id=最后几点>最后几点</h3><ul><li>我使用的是 http 协议，但是 Nextcloud 也可以在 https 上运行。我可能会在以后的文章中写一篇有关保护 Nextcloud 的文章。</li><li>我禁用了 SELinux，但是如果配置它，你的服务器将更加安全。</li><li>Nextcloud 的建议 PHP 内存限制为 512M。要更改它，请编辑 <code>/etc/php.ini</code> 配置文件中的 <code>memory_limit</code> 变量，然后重新启动 httpd 服务。</li><li>默认情况下，只能使用 <a href=http://localhost/>http://localhost/</a> URL 访问 Web 界面。如果要允许使用其他域名访问，<a href=https://help.nextcloud.com/t/adding-a-new-trusted-domain/26>你可编辑 /var/www/html/nextcloud/config/config.php 来进行此操作</a>。<code>*</code> 字符可用于绕过域名限制，并允许任何解析为服务器 IP 的 URL 访问。</li></ul><pre tabindex=0><code>&#39;trusted_domains&#39; =&gt;
array (
    0 =&gt; &#39;localhost&#39;,
    1 =&gt; &#39;*&#39;,
),
</code></pre><hr><p>via: <a href=https://fedoramagazine.org/build-your-own-cloud-with-fedora-31-and-nextcloud-server/>https://fedoramagazine.org/build-your-own-cloud-with-fedora-31-and-nextcloud-server/</a></p><p>作者：<a href=https://fedoramagazine.org/author/storyteller/>storyteller</a> 选题：<a href=https://github.com/lujun9972>lujun9972</a> 译者：<a href=https://github.com/geekpi>geekpi</a> 校对：<a href=https://github.com/wxy>wxy</a></p><p>本文由 <a href=https://github.com/LCTT/TranslateProject>LCTT</a> 原创编译，<a href=https://linux.cn/>Linux中国</a> 荣誉推出</p></div><footer class=post__footer><div class="post__tags tags clearfix"><svg class="tags__badge icon icon-tag" width="16" height="16" viewBox="0 0 32 32"><path d="M32 19c0 1-1 2-1 2L21 31s-1 1-2 1-2-1-2-1L2 16c-1-1-1.4-2-1.4-2S0 12.5.0 11V3C0 1.5.8.8.8.8S1.5.0 3 0h8c1.5.0 3 .6 3 .6S15 1 16 2l15 15s1 1 1 2zM7 10a3 3 0 100-6 3 3 0 000 6z"/></svg><ul class=tags__list><li class=tags__item><a class="tags__link btn" href=/tags/nextcloud/ rel=tag>Nextcloud</a></li></ul></div></footer></article></main></div></div><footer class=footer><div class="container footer__container flex"><div class=footer__copyright>&copy; 2025 Linux.cn Archive.
<span class=footer__copyright-credits>Generated with <a href=https://gohugo.io/ rel="nofollow noopener" target=_blank>Hugo</a> and <a href=https://github.com/Vimux/Mainroad/ rel="nofollow noopener" target=_blank>Mainroad</a> theme.</span></div></div></footer></div><script async defer src=/js/menu.js></script></body></html>