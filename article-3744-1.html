<!doctype html><html class=no-js lang=en><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><title>使用Linux命令行管理DigitalOcean VPS水滴 - Linux.cn Archive</title>
<script>(function(e,t){e[t]=e[t].replace("no-js","js")})(document.documentElement,"className")</script><meta name=description content><meta property="og:title" content="使用Linux命令行管理DigitalOcean VPS水滴"><meta property="og:description" content="DigitalOcean是云VPS主机市场中最炙手可热的新生儿。虽然没有提供像Amazon之类一样的综合服务业务，但DigitalOcean定位于中小型企业和开发者，已经成为基于Linux的最佳云VPS服务的强有力竞争者，这都得归功于它们具有竞争力的价格和用户友好的管理界面。"><meta property="og:type" content="article"><meta property="og:url" content="/article-3744-1.html"><meta property="article:section" content="posts"><meta property="article:published_time" content="2014-09-03T17:38:00+00:00"><meta property="article:modified_time" content="2014-09-03T17:38:00+00:00"><meta itemprop=name content="使用Linux命令行管理DigitalOcean VPS水滴"><meta itemprop=description content="DigitalOcean是云VPS主机市场中最炙手可热的新生儿。虽然没有提供像Amazon之类一样的综合服务业务，但DigitalOcean定位于中小型企业和开发者，已经成为基于Linux的最佳云VPS服务的强有力竞争者，这都得归功于它们具有竞争力的价格和用户友好的管理界面。"><meta itemprop=datePublished content="2014-09-03T17:38:00+00:00"><meta itemprop=dateModified content="2014-09-03T17:38:00+00:00"><meta itemprop=wordCount content="187"><meta itemprop=keywords content="命令,Linux,"><link rel=preconnect href=https://fonts.bunny.net crossorigin><link rel=dns-prefetch href=//fonts.bunny.net><link rel=dns-prefetch href=//fonts.bunny.net><link rel=stylesheet href="https://fonts.bunny.net/css?family=Open+Sans:400,400i,700"><link rel=stylesheet href=/css/style.css><link rel="shortcut icon" href=/favicon.ico></head><body class=body><div class="container container--outer"><header class=header><div class="container header__container"><div class=logo><a class=logo__link href=/ title="Linux.cn Archive" rel=home><div class="logo__item logo__text"><div class=logo__title>Linux.cn Archive</div></div></a></div><nav class=menu><button class=menu__btn aria-haspopup=true aria-expanded=false tabindex=0>
<span class=menu__btn-title tabindex=-1>Menu</span></button><ul class=menu__list><li class=menu__item><a class=menu__link href=/><span class=menu__text>Home</span></a></li><li class=menu__item><a class=menu__link href=/categories/><span class=menu__text>Categories</span></a></li><li class=menu__item><a class=menu__link href=/tags/><span class=menu__text>Tags</span></a></li><li class=menu__item><a class=menu__link href><span class=menu__text>RSS</span></a></li></ul></nav></div></header><div class="wrapper flex"><div class=primary><main class=main role=main><article class=post><header class=post__header><h1 class=post__title>使用Linux命令行管理DigitalOcean VPS水滴</h1><div class="post__meta meta"><div class="meta__item-datetime meta__item"><svg class="meta__icon icon icon-time" width="16" height="14" viewBox="0 0 30 28"><path d="M15 0C7 0 1 6 1 14s6 14 14 14 14-6 14-14S23 0 15 0zm0 25C9 25 4 20 4 14S9 3 15 3s11 5 11 11-5 11-11 11zm1-18h-2v8.4l6.8 4.4L22 18l-6-3.8V7z"/></svg><time class=meta__text datetime=2014-09-03T17:38:00Z>September 03, 2014</time></div></div></header><div class="content post__content clearfix"><p><a href=http://xmodulo.com/go/digitalocean>DigitalOcean</a>是云VPS主机市场中最炙手可热的新生儿。虽然没有提供像Amazon之类一样的综合服务业务，但DigitalOcean定位于中小型企业和开发者，已经成为基于Linux的最佳云VPS服务的强有力竞争者，这都得归功于它们具有竞争力的价格和用户友好的管理界面。</p><p><a href=https://camo.githubusercontent.com/8dfe323ab3bd63de9909fdc59fbdb303a7c1fab2/68747470733a2f2f6661726d342e737461746963666c69636b722e636f6d2f333834312f31343530313632373530305f326566323735616331635f7a2e6a7067><img src=https://camo.githubusercontent.com/8dfe323ab3bd63de9909fdc59fbdb303a7c1fab2/68747470733a2f2f6661726d342e737461746963666c69636b722e636f6d2f333834312f31343530313632373530305f326566323735616331635f7a2e6a7067 alt></a></p><p>不管什么时候，当你需要一个面向网络的服务器用于你的个人项目，你都可以全速开动一个“水滴”（<a href=http://xmodulo.com/go/digitalocean>DigitalOcean</a>中VPS实例的昵称），也可以在你不需要时杀掉它，没必要为了让你的VPS保持运作而烧光了你的钱袋。尽管DigitalOcean基于网络的管理界面已经十分高效，但对于那些命令行界面的死忠派，它还是提供了基于命令行界面的水滴管理工具，它叫<a href=https://github.com/pearkes/tugboat>tugboat</a>。多亏了这个命令行工具，所有复杂的水滴管理任务都可以简单地转变成一个脚本来完成。</p><p>在本文中，我打算讲述<strong>怎样使用tugboat来从命令行对DigitalOcean水滴进行管理</strong>。</p><h3 id=在linux上安装tugboat>在Linux上安装tugboat</h3><p>在Debian，Ubuntu或者Linux Mint上安装tugboat：</p><pre tabindex=0><code>$ sudo apt-get install ruby-dev
$ sudo gem install tugboat 
</code></pre><p>在Fedora上安装tugboat：</p><pre tabindex=0><code>$ sudo yum install ruby-devel
$ sudo gem install tugboat 
</code></pre><p>要在CentOS上安装tugboat，首先<a href=http://ask.xmodulo.com/upgrade-ruby-centos.html>安装或升级到最新的Ruby</a>，因为在CentOS 6.5以及更早的版本上，默认的Ruby不满足Tugboat所需的最小版本（1.9及更高版本）。安装Ruby 1.9及更高版本后，请按如下方式安装tugboat。</p><pre tabindex=0><code>$ sudo gem install tugboat 
</code></pre><h3 id=tugboat首次使用配置>tugboat首次使用配置</h3><p>在安装完后，就该进行一次配置，其中包括授权tugboat访问DigitalOcean帐号。</p><p>转到<a href=https://cloud.digitalocean.com/api_access>https://cloud.digitalocean.com/api_access</a>，并创建新的API密钥，记录客户ID和API密钥。</p><p><a href=https://camo.githubusercontent.com/9d49bd5c554296237e97ed313f70a1c3b58d9173/68747470733a2f2f6661726d342e737461746963666c69636b722e636f6d2f333833362f31343638383239393231355f666432383261303134325f7a2e6a7067><img src=https://camo.githubusercontent.com/9d49bd5c554296237e97ed313f70a1c3b58d9173/68747470733a2f2f6661726d342e737461746963666c69636b722e636f6d2f333833362f31343638383239393231355f666432383261303134325f7a2e6a7067 alt></a></p><p>通过运行以下命令来启动授权过程：</p><pre tabindex=0><code>$ tugboat authorize 
</code></pre><p>在提示你输入客户ID和API密钥时，请输入。它会询问几个其它问题，目前你可以接受默认的回答。我们将会在后面自定义默认设置。</p><p><a href=https://www.flickr.com/photos/xmodulo/14685122101/><img src=https://camo.githubusercontent.com/b3b1ce86ffda386af6766df4144292a37b581f7e/68747470733a2f2f6661726d362e737461746963666c69636b722e636f6d2f353539362f31343638353132323130315f646261353066633836625f7a2e6a7067 alt></a></p><p>现在，让我们自定义默认水滴设置，以反映你典型的使用状况。要做到这一点，首先检查水滴提供的可用设置项（如，可用的镜像、区域、大小）。</p><p>运行以下命令，它会列出可用的水滴镜像。选取使用一个默认镜像，并记录相关的ID。</p><pre tabindex=0><code>$ tugboat images --global 
</code></pre><p><a href=https://camo.githubusercontent.com/2478dee018a4e938ff91aae9bc5284dc001878aa/68747470733a2f2f6661726d332e737461746963666c69636b722e636f6d2f323930302f31343638383239393137355f653737653734666131655f7a2e6a7067><img src=https://camo.githubusercontent.com/2478dee018a4e938ff91aae9bc5284dc001878aa/68747470733a2f2f6661726d332e737461746963666c69636b722e636f6d2f323930302f31343638383239393137355f653737653734666131655f7a2e6a7067 alt></a></p><p>类似，从可用区域中选取一个默认的地理位置：</p><pre tabindex=0><code>$ tugboat regions
</code></pre><p>同时，从可用的RAM大小中选择一个默认的水滴大小：</p><pre tabindex=0><code>$ tugboat sizes 
</code></pre><p><a href=https://camo.githubusercontent.com/3fdc0a4378973b04c89e499e3b30f22bd470439e/68747470733a2f2f6661726d342e737461746963666c69636b722e636f6d2f333835382f31343530313636313233385f343330346538626466625f6f2e706e67><img src=https://camo.githubusercontent.com/3fdc0a4378973b04c89e499e3b30f22bd470439e/68747470733a2f2f6661726d342e737461746963666c69636b722e636f6d2f333835382f31343530313636313233385f343330346538626466625f6f2e706e67 alt></a></p><p>现在，把你的默认选择放到~/.tugboat中。例如，我在这里自定义了默认设置：区域在纽约，系统是Ubuntu 14.04，内存512MB。如果你想要通过密钥验证启用SSH，设置“ssh_user”为root，这个我很快会讲到。</p><pre tabindex=0><code>$ vi ~/.tugboat 
</code></pre><hr><pre tabindex=0><code>---
authentication:
  client_key: XXXXXXXXXXXXXXXXXXX
  api_key: XXXXXXXXXXXXXXXXXXXX
ssh:
  ssh_user: root
  ssh_key_path: /home/dev/.ssh/id_rsa
  ssh_port: &#39;22&#39;
defaults:
  region: &#39;4&#39;
  image: &#39;3240036&#39;
  size: &#39;66&#39;
  ssh_key: &#39;&#39;
  private_networking: &#39;false&#39;
  backups_enabled: &#39;false&#39;
</code></pre><h3 id=创建并添加ssh密钥到digitalocean>创建并添加SSH密钥到DigitalOcean</h3><p>要访问水滴实例，一个安全的方式是通过<a href=http://xmodulo.com/2012/04/how-to-enable-ssh-login-without.html>密钥验证</a>的SSH连接到该实例。</p><p>事实上，你可以通过使用<a href=http://xmodulo.com/go/digitalocean>DigitalOcean</a>来注册SSH公钥，为你的水滴实现自动启用密钥验证。下面告诉你怎么做。</p><p>首先，生成一个公/私密钥对（如果你还没有）。</p><pre tabindex=0><code>$ ssh-keygen -t rsa -C &#34;your@emailaddress.com&#34;
</code></pre><p>假设生成的密钥对由~/.ssh/id_rsa（私钥）和~/.ssh/id_rsa.pub（公钥）构成，去将你的公钥上传吧，命令如下：</p><pre tabindex=0><code>$ tugboat add-key [name-of-your-key] 
</code></pre><p>你可以任意给你的密钥命名（如，“my-default-key”）。当出现提示时，输入公钥路径（如，/home/user/.ssh/id_rsa.pub）。在密钥上传完成后，运行以下命令来验证密钥是否正确添加：</p><pre tabindex=0><code>$ tugboat keys 
</code></pre><p><a href=https://camo.githubusercontent.com/83220ff178dff29fb42ff5782bcf336be23b80bd/68747470733a2f2f6661726d342e737461746963666c69636b722e636f6d2f333836392f31343530313835333339375f336433663433363562315f7a2e6a7067><img src=https://camo.githubusercontent.com/83220ff178dff29fb42ff5782bcf336be23b80bd/68747470733a2f2f6661726d342e737461746963666c69636b722e636f6d2f333836392f31343530313835333339375f336433663433363562315f7a2e6a7067 alt></a></p><p>密钥也应该出现在DigitalOcean的<a href=https://cloud.digitalocean.com/ssh_keys>SSH密钥页</a>。如果你想要密钥自动使用到水滴中，添加密钥ID到~/.tugboat中。</p><pre tabindex=0><code>ssh_key: &#39;182710&#39;
</code></pre><h3 id=tugboat的基本用法>Tugboat的基本用法</h3><p>这里列出了tugboat命令行的一些基本使用情况。</p><ol><li>使用默认设置创建新水滴。</li></ol><pre tabindex=0><code>$ tugboat create
</code></pre><ol start=2><li>列出所有活动水滴。</li></ol><pre tabindex=0><code>$ tugboat droplets
</code></pre><ol start=3><li>显示水滴的信息。</li></ol><pre tabindex=0><code>$ tugboat info
</code></pre><p><a href=https://www.flickr.com/photos/xmodulo/14501627440/><img src=https://camo.githubusercontent.com/072f24ab8b997de2a447ccbcad0a7d1dbeb881dd/68747470733a2f2f6661726d362e737461746963666c69636b722e636f6d2f353539332f31343530313632373434305f353833353530366432615f7a2e6a7067 alt></a></p><ol><li>关闭水滴，并移除镜像。</li></ol><pre tabindex=0><code>$ tugboat destroy
</code></pre><ol start=2><li>关闭水滴，但保持镜像</li></ol><pre tabindex=0><code>$ tugboat halt
</code></pre><ol start=3><li>为水滴创建快照，水滴必须先关闭。</li></ol><pre tabindex=0><code>$ tugboat snapshot
</code></pre><ol start=4><li>调整水滴大小（增加或减少RAM大小），水滴必须先关闭。</li></ol><pre tabindex=0><code>$ tugboat resize -s
</code></pre><p>如果你想要了解特定命令的更多选项，运行：</p><pre tabindex=0><code>$ tugboat help &lt;command&gt; 
</code></pre><p><a href=https://camo.githubusercontent.com/c09480574cc9ce3fa84740423f2d52e279f365b4/68747470733a2f2f6661726d342e737461746963666c69636b722e636f6d2f333930302f31343638383031333332325f346661363038306335655f7a2e6a7067><img src=https://camo.githubusercontent.com/c09480574cc9ce3fa84740423f2d52e279f365b4/68747470733a2f2f6661726d342e737461746963666c69636b722e636f6d2f333930302f31343638383031333332325f346661363038306335655f7a2e6a7067 alt></a></p><h3 id=排障>排障</h3><ol><li>当我运行tugboat命令时，它出现以下错误。</li></ol><pre tabindex=0><code>/usr/lib/ruby/site_ruby/1.8/rubygems/custom_require.rb:31:in `gem_original_require&#39;: /usr/lib/ruby/gems/1.8/gems/tugboat-0.2.0/lib/tugboat/cli.rb:12: syntax error, unexpected &#39;:&#39;, expecting kEND (SyntaxError)
</code></pre><p>Tugboat要求Ruby 1.9及更高版本，你需要升级Ruby来解决该问题。对于CentOS，请参考<a href=http://ask.xmodulo.com/upgrade-ruby-centos.html>此教程</a>
2. 当我试着用gem来安装Tugboat时，出现了下面的错误。</p><pre tabindex=0><code>/usr/local/share/ruby/site_ruby/rubygems/core_ext/kernel_require.rb:55:in `require&#39;: cannot load such file -- json/pure (LoadError)
</code></pre><p>安装以下gem来修复该问题。</p><pre tabindex=0><code>$ sudo gem install json_pure 
</code></pre><hr><p>via: <a href=http://xmodulo.com/2014/07/manage-digitalocean-vps-droplets-command-line-linux.html>http://xmodulo.com/2014/07/manage-digitalocean-vps-droplets-command-line-linux.html</a></p><p>原文作者：<a href=http://xmodulo.com/author/nanni>Dan Nanni</a></p><p>译者：<a href=https://github.com/GOLinux>GOLinux</a> 校对：<a href=https://github.com/carolinewuyan>Caroline</a></p><p>本文由 <a href=https://github.com/LCTT/TranslateProject>LCTT</a> 原创翻译，<a href=http://linux.cn/>Linux中国</a> 荣誉推出</p></div><footer class=post__footer><div class="post__tags tags clearfix"><svg class="tags__badge icon icon-tag" width="16" height="16" viewBox="0 0 32 32"><path d="M32 19c0 1-1 2-1 2L21 31s-1 1-2 1-2-1-2-1L2 16c-1-1-1.4-2-1.4-2S0 12.5.0 11V3C0 1.5.8.8.8.8S1.5.0 3 0h8c1.5.0 3 .6 3 .6S15 1 16 2l15 15s1 1 1 2zM7 10a3 3 0 100-6 3 3 0 000 6z"/></svg><ul class=tags__list><li class=tags__item><a class="tags__link btn" href=/tags/%E5%91%BD%E4%BB%A4/ rel=tag>命令</a></li><li class=tags__item><a class="tags__link btn" href=/tags/linux/ rel=tag>Linux</a></li></ul></div></footer></article></main></div></div><footer class=footer><div class="container footer__container flex"><div class=footer__copyright>&copy; 2025 Linux.cn Archive.
<span class=footer__copyright-credits>Generated with <a href=https://gohugo.io/ rel="nofollow noopener" target=_blank>Hugo</a> and <a href=https://github.com/Vimux/Mainroad/ rel="nofollow noopener" target=_blank>Mainroad</a> theme.</span></div></div></footer></div><script async defer src=/js/menu.js></script></body></html>