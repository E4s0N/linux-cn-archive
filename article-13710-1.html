<!doctype html><html class=no-js lang=en><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><title>用 Linux 的 at 命令来安排一个任务 - Linux.cn Archive</title>
<script>(function(e,t){e[t]=e[t].replace("no-js","js")})(document.documentElement,"className")</script><meta name=description content><meta property="og:title" content="用 Linux 的 at 命令来安排一个任务"><meta property="og:description" content="at 命令是一种在特定时间和日期安排一次性任务的 Linux 终端方法。"><meta property="og:type" content="article"><meta property="og:url" content="/article-13710-1.html"><meta property="article:section" content="posts"><meta property="article:published_time" content="2021-08-23T14:45:53+00:00"><meta property="article:modified_time" content="2021-08-23T14:45:53+00:00"><meta itemprop=name content="用 Linux 的 at 命令来安排一个任务"><meta itemprop=description content="at 命令是一种在特定时间和日期安排一次性任务的 Linux 终端方法。"><meta itemprop=datePublished content="2021-08-23T14:45:53+00:00"><meta itemprop=dateModified content="2021-08-23T14:45:53+00:00"><meta itemprop=wordCount content="300"><meta itemprop=keywords content="at,"><link rel=preconnect href=https://fonts.bunny.net crossorigin><link rel=dns-prefetch href=//fonts.bunny.net><link rel=dns-prefetch href=//fonts.bunny.net><link rel=stylesheet href="https://fonts.bunny.net/css?family=Open+Sans:400,400i,700"><link rel=stylesheet href=/css/style.css><link rel="shortcut icon" href=/favicon.ico></head><body class=body><div class="container container--outer"><header class=header><div class="container header__container"><div class=logo><a class=logo__link href=/ title="Linux.cn Archive" rel=home><div class="logo__item logo__text"><div class=logo__title>Linux.cn Archive</div></div></a></div><nav class=menu><button class=menu__btn aria-haspopup=true aria-expanded=false tabindex=0>
<span class=menu__btn-title tabindex=-1>Menu</span></button><ul class=menu__list><li class=menu__item><a class=menu__link href=/><span class=menu__text>Home</span></a></li><li class=menu__item><a class=menu__link href=/categories/><span class=menu__text>Categories</span></a></li><li class=menu__item><a class=menu__link href=/tags/><span class=menu__text>Tags</span></a></li><li class=menu__item><a class=menu__link href><span class=menu__text>RSS</span></a></li></ul></nav></div></header><div class="wrapper flex"><div class=primary><main class=main role=main><article class=post><header class=post__header><h1 class=post__title>用 Linux 的 at 命令来安排一个任务</h1><div class="post__meta meta"><div class="meta__item-datetime meta__item"><svg class="meta__icon icon icon-time" width="16" height="14" viewBox="0 0 30 28"><path d="M15 0C7 0 1 6 1 14s6 14 14 14 14-6 14-14S23 0 15 0zm0 25C9 25 4 20 4 14S9 3 15 3s11 5 11 11-5 11-11 11zm1-18h-2v8.4l6.8 4.4L22 18l-6-3.8V7z"/></svg><time class=meta__text datetime=2021-08-23T14:45:53Z>August 23, 2021</time></div></div></header><div class="content post__content clearfix"><blockquote><p>at 命令是一种在特定时间和日期安排一次性任务的 Linux 终端方法。</p></blockquote><p><img src=https://img.linux.net.cn/data/attachment/album/202108/23/144542rmmyzwxsnanm4wpj.jpg alt title="Team checklist"></p><p>计算机擅长 <a href=https://opensource.com/article/20/11/orchestration-vs-automation>自动化</a>，但不是每个人都知道如何使自动化工作。不过，能够在特定的时间为电脑安排一个任务，然后忘记它，这确实是一种享受。也许你有一个文件要在特定的时间上传或下载，或者你需要处理一批还不存在但可以保证在某个时间存在的文件，或者需要监控设置，或者你只是需要一个友好的提醒，在下班回家的路上买上面包和黄油。</p><p>这就是 <code>at</code> 命令的用处。</p><h3 id=什么是-linux-at-命令>什么是 Linux at 命令？</h3><p><code>at</code> 命令是在 Linux 终端让你在特定时间和日期安排一次性工作的方法。它是一种自发的自动化，在终端上很容易实现。</p><h3 id=安装-at>安装 at</h3><p>在 Linux 上，<code>at</code> 命令可能已经安装了。你可以使用 <code>at -V</code> 命令来验证它是否已经安装。只要返回一个版本号，就说明你已经安装了 <code>at</code>。</p><pre tabindex=0><code>$ at -V
at version x.y.z
</code></pre><p>如果你试图使用 <code>at</code>，但没有找到该命令，大多数现代的 Linux 发行版会为你提供缺少的 <code>at</code> 软件包。</p><p>你可能还需要启动 <code>at</code> 守护程序，称为 <code>atd</code>。在大多数 Linux 系统中，你可以使用 <code>systemctl</code> 命令来启用该服务，并将它们设置为从现在开始自动启动：</p><pre tabindex=0><code>$ sudo systemctl enable --now atd
</code></pre><h3 id=用-at-交互式地安排一个作业>用 at 交互式地安排一个作业</h3><p>当你使用 <code>at</code> 命令并加上你希望任务运行的时间，会打开一个交互式 <code>at</code> 提示符。你可以输入你想在指定时间运行的命令。</p><p>做个比喻，你可以把这个过程看作是一个日历应用，就像你在你的手机上使用的那样。首先，你在某一天的某个时间创建一个事件，然后指定你想要发生什么。</p><p>例如，可以试试创建一个未来几分钟的任务，来给自己计划一个备忘录。这里运行一个简单的任务，以减少失败的可能性。要退出 <code>at</code> 提示符，请按键盘上的 <code>Ctrl+D</code>。</p><pre tabindex=0><code>$ at 11:20 AM
warning: commands will be executed using /bin/sh
at&gt; echo &#34;hello world&#34; &gt; ~/at-test.txt
at&gt; &lt;EOT&gt;
job 3 at Mon Jul 26 11:20:00 2021
</code></pre><p>正如你所看到的，<code>at</code> 使用直观和自然的时间定义。你不需要用 24 小时制的时钟，也不需要把时间翻译成 UTC 或特定的 ISO 格式。一般来说，你可以使用你自然想到的任何符号，如 <code>noon</code>、<code>1:30 PM</code>、<code>13:37</code> 等等，来描述你希望一个任务发生的时间。</p><p>等待几分钟，然后在你创建的文件上运行 <code>cat</code> 或者 <code>tac</code> 命令，验证你的任务是否已经运行：</p><pre tabindex=0><code>$ cat ~/at-test.txt
hello world
</code></pre><h3 id=用-at-安排一个任务>用 at 安排一个任务</h3><p>你不必使用 <code>at</code> 交互式提示符来安排任务。你可以使用 <code>echo</code> 或 <code>printf</code> 向它传送命令。在这个例子中，我使用了 <code>now</code> 符号，以及我希望任务从现在开始延迟多少分钟：</p><pre tabindex=0><code>$ echo &#34;echo &#39;hello again&#39; &gt;&gt; ~/at-test.txt&#34; | at now +1 minute
</code></pre><p>一分钟后，验证新的命令是否已被执行：</p><pre tabindex=0><code>$ cat ~/at-test.txt
hello world
hello again
</code></pre><h3 id=时间表达式>时间表达式</h3><p><code>at</code> 命令在解释时间时是非常宽容的。你可以在许多格式中选择，这取决于哪一种对你来说最方便：</p><ul><li><code>YYMMDDhhmm[.ss]</code>（两位的年份、月、日、小时、分钟，及可选的秒）</li><li><code>CCYYMMDDhhmm[.ss]</code>（四位的年份、月、日、时、分钟，及可选的秒）</li><li><code>now</code>（现在）</li><li><code>midnight</code>（午夜 00:00）</li><li><code>noon</code>（中午 12:00）</li><li><code>teatime</code>（下午 16 点）</li><li><code>AM</code>（上午）</li><li><code>PM</code>（下午）</li></ul><p>时间和日期可以是绝对时间，也可以加一个加号（<code>+</code>），使其与 <code>now</code> 相对。当指定相对时间时，你可以使用你可能用过的词语：</p><ul><li><code>minutes</code>（分钟）</li><li><code>hours</code>（小时）</li><li><code>days</code>（天）</li><li><code>weeks</code>（星期）</li><li><code>months</code>（月）</li><li><code>years</code>（年）</li></ul><h3 id=时间和日期语法>时间和日期语法</h3><p><code>at</code> 命令对时间的输入相比日期不那么宽容。时间必须放在第一位，接着是日期，尽管日期默认为当前日期，并且只有在为未来某天安排任务时才需要。</p><p>这些是一些有效表达式的例子：</p><pre tabindex=0><code>$ echo &#34;rsync -av /home/tux me@myserver:/home/tux/&#34; | at 3:30 AM tomorrow
$ echo &#34;/opt/batch.sh ~/Pictures&#34; | at 3:30 AM 08/01/2022
$ echo &#34;echo hello&#34; | at now + 3 days
</code></pre><h3 id=查看你的-at-队列>查看你的 at 队列</h3><p>当你爱上了 <code>at</code>，并且正在安排任务，而不是在桌子上的废纸上乱写乱画，你可能想查看一下你是否有任务还在队列中。</p><p>要查看你的 <code>at</code> 队列，使用 <code>atq</code> 命令：</p><pre tabindex=0><code>$ atq
10 Thu Jul 29 12:19:00 2021 a tux
9 Tue Jul 27 03:30:00 2021 a tux
7 Tue Jul 27 00:00:00 2021 a tux
</code></pre><p>要从队列中删除一个任务，使用 <code>atrm</code> 命令和任务号。例如，要删除任务 7：</p><pre tabindex=0><code>$ atrm 7
$ atq
10 Thu Jul 29 12:19:00 2021 a tux
9 Tue Jul 27 03:30:00 2021 a tux
</code></pre><p>要看一个计划中的任务的实际内容，你需要查看 <code>/var/spool/at</code> 下的内容。只有 root 用户可以查看该目录的内容，所以你必须使用 <code>sudo</code> 来查看或 <code>cat</code> 任何任务的内容。</p><h3 id=用-linux-at-安排任务>用 Linux at 安排任务</h3><p><code>at</code> 系统是一个很好的方法，可以避免忘记在一天中晚些时候运行一个作业，或者在你离开时让你的计算机为你运行一个作业。与 <code>cron</code> 不同的是，它不像 <code>cron</code> 那样要求任务必须从现在起一直按计划运行到永远，因此它的语法比 <code>cron</code> 简单得多。</p><p>等下次你有一个希望你的计算机记住并管理它的小任务，试试 <code>at</code> 命令。</p><hr><p>via: <a href=https://opensource.com/article/21/8/linux-at-command>https://opensource.com/article/21/8/linux-at-command</a></p><p>作者：<a href=https://opensource.com/users/seth>Seth Kenlon</a> 选题：<a href=https://github.com/lujun9972>lujun9972</a> 译者：<a href=https://github.com/geekpi>geekpi</a> 校对：<a href=https://github.com/wxy>wxy</a></p><p>本文由 <a href=https://github.com/LCTT/TranslateProject>LCTT</a> 原创编译，<a href=https://linux.cn/>Linux中国</a> 荣誉推出</p></div><footer class=post__footer><div class="post__tags tags clearfix"><svg class="tags__badge icon icon-tag" width="16" height="16" viewBox="0 0 32 32"><path d="M32 19c0 1-1 2-1 2L21 31s-1 1-2 1-2-1-2-1L2 16c-1-1-1.4-2-1.4-2S0 12.5.0 11V3C0 1.5.8.8.8.8S1.5.0 3 0h8c1.5.0 3 .6 3 .6S15 1 16 2l15 15s1 1 1 2zM7 10a3 3 0 100-6 3 3 0 000 6z"/></svg><ul class=tags__list><li class=tags__item><a class="tags__link btn" href=/tags/at/ rel=tag>at</a></li></ul></div></footer></article></main></div></div><footer class=footer><div class="container footer__container flex"><div class=footer__copyright>&copy; 2025 Linux.cn Archive.
<span class=footer__copyright-credits>Generated with <a href=https://gohugo.io/ rel="nofollow noopener" target=_blank>Hugo</a> and <a href=https://github.com/Vimux/Mainroad/ rel="nofollow noopener" target=_blank>Mainroad</a> theme.</span></div></div></footer></div><script async defer src=/js/menu.js></script></body></html>