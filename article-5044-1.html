<!doctype html><html class=no-js lang=en><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><title>在Linux上使用Python和Flask创建你的第一个应用 - Linux.cn Archive</title>
<script>(function(e,t){e[t]=e[t].replace("no-js","js")})(document.documentElement,"className")</script><meta name=description content><meta property="og:title" content="在Linux上使用Python和Flask创建你的第一个应用"><meta property="og:description" content="无论你在linux上娱乐还是工作，这对你而言都是一个使用python来编程的很好的机会。回到大学我希望他们教我的是Python而不是Java，这学起来很有趣且在实际的应用如yum包管理器中很有用。"><meta property="og:type" content="article"><meta property="og:url" content="/article-5044-1.html"><meta property="article:section" content="posts"><meta property="article:published_time" content="2015-03-12T15:37:00+00:00"><meta property="article:modified_time" content="2015-03-12T15:37:00+00:00"><meta itemprop=name content="在Linux上使用Python和Flask创建你的第一个应用"><meta itemprop=description content="无论你在linux上娱乐还是工作，这对你而言都是一个使用python来编程的很好的机会。回到大学我希望他们教我的是Python而不是Java，这学起来很有趣且在实际的应用如yum包管理器中很有用。"><meta itemprop=datePublished content="2015-03-12T15:37:00+00:00"><meta itemprop=dateModified content="2015-03-12T15:37:00+00:00"><meta itemprop=wordCount content="303"><meta itemprop=keywords content="flask,python,"><link rel=preconnect href=https://fonts.bunny.net crossorigin><link rel=dns-prefetch href=//fonts.bunny.net><link rel=dns-prefetch href=//fonts.bunny.net><link rel=stylesheet href="https://fonts.bunny.net/css?family=Open+Sans:400,400i,700"><link rel=stylesheet href=/css/style.css><link rel="shortcut icon" href=/favicon.ico></head><body class=body><div class="container container--outer"><header class=header><div class="container header__container"><div class=logo><a class=logo__link href=/ title="Linux.cn Archive" rel=home><div class="logo__item logo__text"><div class=logo__title>Linux.cn Archive</div></div></a></div><nav class=menu><button class=menu__btn aria-haspopup=true aria-expanded=false tabindex=0>
<span class=menu__btn-title tabindex=-1>Menu</span></button><ul class=menu__list><li class=menu__item><a class=menu__link href=/><span class=menu__text>Home</span></a></li><li class=menu__item><a class=menu__link href=/categories/><span class=menu__text>Categories</span></a></li><li class=menu__item><a class=menu__link href=/tags/><span class=menu__text>Tags</span></a></li><li class=menu__item><a class=menu__link href><span class=menu__text>RSS</span></a></li></ul></nav></div></header><div class="wrapper flex"><div class=primary><main class=main role=main><article class=post><header class=post__header><h1 class=post__title>在Linux上使用Python和Flask创建你的第一个应用</h1><div class="post__meta meta"><div class="meta__item-datetime meta__item"><svg class="meta__icon icon icon-time" width="16" height="14" viewBox="0 0 30 28"><path d="M15 0C7 0 1 6 1 14s6 14 14 14 14-6 14-14S23 0 15 0zm0 25C9 25 4 20 4 14S9 3 15 3s11 5 11 11-5 11-11 11zm1-18h-2v8.4l6.8 4.4L22 18l-6-3.8V7z"/></svg><time class=meta__text datetime=2015-03-12T15:37:00Z>March 12, 2015</time></div></div></header><div class="content post__content clearfix"><p><img src=/data/attachment/album/201503/12/153736di7plh4hd2pk2p2l.png alt></p><p>无论你在linux上娱乐还是工作，这对你而言都是一个使用python来编程的很好的机会。回到大学我希望他们教我的是Python而不是Java，这学起来很有趣且在实际的应用如yum包管理器中很有用。</p><p>本篇教程中我会带你使用python和一个称为flask的微型框架来构建一个简单的应用，来显示诸如<a href=http://techarena51.com/index.php/linux-memory-usage/>每个进程的内存使用</a>，CPU百分比之类有用的信息。</p><h3 id=前置需求>前置需求</h3><p>Python基础、列表、类、函数、模块。HTML/CSS (基础)。</p><p>学习这篇教程你不必是一个python高级开发者，但是首先我建议你阅读 <a href=https://wiki.python.org/moin/BeginnersGuide/NonProgrammers>https://wiki.python.org/moin/BeginnersGuide/NonProgrammers</a> 。</p><h3 id=在linux上安装python-3>在Linux上安装Python 3</h3><p>在大多数Linux发行版上Python是默认安装的。下面的你命令可以让你看到安装的版本。</p><pre tabindex=0><code>[root@linux-vps ~]# python -V
Python 2.7.5
</code></pre><p>我们会使用3.x的版本来构建我们的app。根据<a href=https://wiki.python.org/moin/Python2orPython3>Python.org</a>所说，现在只对这个版本进行改进，而且不向后兼容Python 2。</p><p><strong>注意</strong>: 在开始之前，我强烈建议你在虚拟机中尝试这个教程，因为Python是许多Linux发行版的核心组件，任何意外都可能会损坏你的系统。</p><p>以下步骤是基于红帽的版本如CentOS（6和7），基于Debian的版本如UbuntuMint和Resbian可以跳过这步，Pythonn 3应该默认已经安装了。如果没有安装，请用apt-get而不是yum来安装下面相应的包。</p><pre tabindex=0><code>[leo@linux-vps] yum groupinstall &#39;Development Tools&#39;
[leo@linux-vps] yum install -y zlib-dev openssl-devel sqlite-devel bzip2-devel
[leo@linux-vps] wget https://www.python.org/ftp/python/3.4.2/Python-3.4.2.tgz
[leo@linux-vps] tar -xvzf Python-3.4.2.tgz
[leo@linux-vps] cd Python-3.4.2
[leo@linux-vps] ./configure
[leo@linux-vps] make
# 推荐使用 make altinstall 以覆盖当前的 python 库
[leo@linux-vps]   make altinstall
</code></pre><p>成功安装后，你应该可以用下面的命令进入Python3.4的shell了。</p><pre tabindex=0><code>[leo@linux-vps]# python3.4
Python 3.4.2 (default, Dec 12 2014, 08:01:15)
[GCC 4.8.2 20140120 (Red Hat 4.8.2-16)] on linux
Type &#34;help&#34;, &#34;copyright&#34;, &#34;credits&#34; or &#34;license&#34; for more information.
&gt;&gt;&gt; exit ()
</code></pre><h3 id=使用pip来安装包>使用pip来安装包</h3><p>Python有它自己的包管理去，与yum和apt-get相似。你将需要它来下载、安装和卸载包。</p><pre tabindex=0><code>[leo@linux-vps] pip3.4 install &#34;packagename&#34;    
[leo@linux-vps] pip3.4 list
[leo@linux-vps] pip3.4 uninstall &#34;packagename&#34;
</code></pre><h3 id=python虚拟环境>Python虚拟环境</h3><p>在Python中虚拟环境是一个放置你的项目的依赖环境的目录。这是一个将带有不同的依赖环境的项目隔离的好办法。它可以让你不用sudo命令就能安装包。</p><pre tabindex=0><code>[leo@linux-vps] mkdir python3.4-flask
[leo@linux-vps] cd python3.4-flask 
[leo@linux-vps python3.4-flask] pyvenv-3.4 venv
</code></pre><p>要创建虚拟环境你需要使用“pyvenv-3.4”命令。上述命令会在venv文件夹的内部创建一个名为lib的目录，这里会安装项目所依赖的包。这里同样会创建一个bin文件夹容纳该环境下的pip和python可执行文件。</p><h3 id=为我们的linux系统信息项目激活虚拟环境>为我们的Linux系统信息项目激活虚拟环境</h3><pre tabindex=0><code> [leo@linux-vps python3.4-flask] source venv/bin/activate
 [leo@linux-vps python3.4-flask] which pip3.4
~/python3.4-flask/venv/bin/pip3.4
[leo@linux-vps python3.4-flask] which python3.4
~/python3.4-flask/venv/bin/python3.4
</code></pre><h3 id=使用pip安装flask>使用pip安装flask</h3><p>让我们继续安装第一个模块flask框架，它可以处理访问路由和渲染显示我们app的模板。</p><pre tabindex=0><code>[leo@linux-vps python3.4-flask]pip3.4 install flask
</code></pre><h3 id=在flask中创建第一个应用>在flask中创建第一个应用</h3><h4 id=第一步创建你app的目录>第一步：创建你app的目录</h4><pre tabindex=0><code> [leo@linux-vps python3.4-flask] mkdir  app
 [leo@linux-vps python3.4-flask] mkdir app/static
 [leo@linux-vps python3.4-flask] mkdir app/templates
</code></pre><p>在python3.4-flask文件夹中创建一个名为app的文件夹，它包含了两个子文件夹“static”和“templates”。我们的Python脚本会放在app文件夹，像css/js这类文件会在static文件夹，template文件夹会包含我们的html模板。</p><h4 id=第二步在app文件夹内部创建一个初始化文件>第二步：在app文件夹内部创建一个初始化文件</h4><pre tabindex=0><code>[leo@linux-vps python3.4-flask] vim app/_init_.py
from flask import Flask

app = Flask(__name__)
from app import index
</code></pre><p>这个文件会创建一个Flask的新的实例，并加载我们存储在index.py文件中的python程序——这个文件我们之后会创建。</p><pre tabindex=0><code>[leo@linux-vps python3.4-flask]vim app/index.py
from app import app

@app.route(&#39;/&#39;)
def index():
 import subprocess
 cmd = subprocess.Popen([&#39;ps_mem&#39;],stdout=subprocess.PIPE,stderr=subprocess.PIPE)
 out,error = cmd.communicate()
 memory = out.splitlines()    

    return 
</code></pre><p>flask中的访问路由通过“路由装饰器”处理。它用于将一个 URL 绑定到函数。</p><pre tabindex=0><code>@app.route(&#39;/&#39;)
@app.route(&#39;/index&#39;) 
</code></pre><p>要在python中运行shell命令，你可以使用Subprocess模块中的Popen类。</p><pre tabindex=0><code>subprocess.Popen([&#39;ps_mem&#39;],stdout=subprocess.PIPE,stderr=subprocess.PIPE)
</code></pre><p>这个类会使用一个列表作为参数，列表的第一项默认是可执行的程序，下一项会是参数，这里是个另外一个例子。</p><pre tabindex=0><code>subprocess.Popen([&#39;ls&#39;, ‘-l’],stdout=subprocess.PIPE,stderr=subprocess.PIPE)
</code></pre><p>stdout和stderr会相应地存储命令的输出和错误。你可以使用Popen的communicate方法来访问输出。</p><pre tabindex=0><code>out,error = cmd.communicate()
</code></pre><p>要更好地用html模板显示输出，我会使用splitlines()方法，</p><pre tabindex=0><code>memory = out.splitlines()
</code></pre><p>关于subprocess模块更多的信息会在教程的最后给出。</p><h4 id=第三步创建一个html模板来显示我们命令的输出>第三步：创建一个html模板来显示我们命令的输出。</h4><p>要做到这个我们使用flask中的Jinja2模板引擎来为我们渲染。</p><p>最后你的index.py文件应该看起来像这样：</p><pre tabindex=0><code>from flask import render_template
from app import app

def index():
 import subprocess
 cmd = subprocess.Popen([&#39;ps_mem&#39;],stdout=subprocess.PIPE,stderr=subprocess.PIPE)
 out,error = cmd.communicate()
 memory = out.splitlines()     

return render_template(&#39;index.html&#39;, memory=memory)
</code></pre><p>现在在你的模板目录下创建一个index.html模板，flask会自动搜索这个目录下的模板。</p><pre tabindex=0><code>[leo@linux-vps python3.4-flask]vim app/templates/index.html


Memory usage per process

{% for line in memory %}
    {{ line.decode(&#39;utf-8&#39;) }} 

   {% endfor %}
</code></pre><p>Jinja2模板引擎允许你使用“{{ … }}”分隔符来输出结果，{% … %}来做循环和赋值。我使用“decode()”方法来格式化。</p><h4 id=第四步运行app>第四步：运行app</h4><pre tabindex=0><code>[leo@linux-vps python3.4-flask]vim run.py
from app import app
app.debug = True
app.run(host=&#39;174.140.165.231&#39;, port=80)
</code></pre><p>上面的代码会在debug模式下运行app。如果你不指定 IP 地址和端口，默认则是localhost:5000。</p><pre tabindex=0><code>[leo@linux-vps python3.4-flask] chmod +x run.py
[leo@linux-vps python3.4-flask] python3.4 run.py
</code></pre><p><img src=/data/attachment/album/201503/12/153736h272ssscshm2s3u7.png alt></p><p>我已经加了更多的代码来显示CPU、I/O和平均负载。</p><p><img src=/data/attachment/album/201503/12/153738a8r32rrx8i2u2ugx.png alt></p><p>你可以在<a href=https://github.com/Leo-g/python-flask-cmd>这里</a>浏览完整的代码。</p><p>这是一个对flask的简短教程，我建议你阅读下面的教程和文档来更深入地了解。</p><p><a href=http://flask.pocoo.org/docs/0.10/quickstart/>http://flask.pocoo.org/docs/0.10/quickstart/</a></p><p><a href=https://docs.python.org/3.4/library/subprocess.html#popen-constructor>https://docs.python.org/3.4/library/subprocess.html#popen-constructor</a></p><p><a href=http://blog.miguelgrinberg.com/post/the-flask-mega-tutorial-part-i-hello-world>http://blog.miguelgrinberg.com/post/the-flask-mega-tutorial-part-i-hello-world</a></p><hr><p>via: <a href=http://techarena51.com/index.php/how-to-install-python-3-and-flask-on-linux/>http://techarena51.com/index.php/how-to-install-python-3-and-flask-on-linux/</a></p><p>作者：<a href=http://techarena51.com/>Leo G</a> 译者：<a href=https://github.com/gekpi>geekpi</a> 校对：<a href=https://github.com/wxy>wxy</a></p><p>本文由 <a href=https://github.com/LCTT/TranslateProject>LCTT</a> 原创翻译，<a href=http://linux.cn/>Linux中国</a> 荣誉推出</p></div><footer class=post__footer><div class="post__tags tags clearfix"><svg class="tags__badge icon icon-tag" width="16" height="16" viewBox="0 0 32 32"><path d="M32 19c0 1-1 2-1 2L21 31s-1 1-2 1-2-1-2-1L2 16c-1-1-1.4-2-1.4-2S0 12.5.0 11V3C0 1.5.8.8.8.8S1.5.0 3 0h8c1.5.0 3 .6 3 .6S15 1 16 2l15 15s1 1 1 2zM7 10a3 3 0 100-6 3 3 0 000 6z"/></svg><ul class=tags__list><li class=tags__item><a class="tags__link btn" href=/tags/flask/ rel=tag>flask</a></li><li class=tags__item><a class="tags__link btn" href=/tags/python/ rel=tag>python</a></li></ul></div></footer></article></main></div></div><footer class=footer><div class="container footer__container flex"><div class=footer__copyright>&copy; 2025 Linux.cn Archive.
<span class=footer__copyright-credits>Generated with <a href=https://gohugo.io/ rel="nofollow noopener" target=_blank>Hugo</a> and <a href=https://github.com/Vimux/Mainroad/ rel="nofollow noopener" target=_blank>Mainroad</a> theme.</span></div></div></footer></div><script async defer src=/js/menu.js></script></body></html>