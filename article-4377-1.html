<!doctype html><html class=no-js lang=en><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><title>如何创建和使用Python CGI脚本 - Linux.cn Archive</title>
<script>(function(e,t){e[t]=e[t].replace("no-js","js")})(document.documentElement,"className")</script><meta name=description content><meta property="og:title" content="如何创建和使用Python CGI脚本"><meta property="og:description" content="你是否想使用Python语言创建一个网页，或者处理用户从web表单输入的数据？这些任务可以通过Python CGI(公用网关接口)脚本以及一个Apache web服务器实现。当用户请求一个指定URL或者和网页交互(比如点击&#34;&#34;提交&#34;按钮)的时候，CGI脚本就会被web服务器启用。CGI脚本调用执行完毕后，它的输出结果就会被web服务器用来创建显示给用户的网页。  配置Apache web服务器，让其能运行CGI脚本 在这个教程里，我们假设Apache web服务器已经安装好，并已运行。这篇教程使用的Apache web服务器(版本2.2.15，用于CentOS发行版6.5)运行在本地主机(127.0.0.1"><meta property="og:type" content="article"><meta property="og:url" content="/article-4377-1.html"><meta property="article:section" content="posts"><meta property="article:published_time" content="2014-12-05T10:26:00+00:00"><meta property="article:modified_time" content="2014-12-05T10:26:00+00:00"><meta itemprop=name content="如何创建和使用Python CGI脚本"><meta itemprop=description content="你是否想使用Python语言创建一个网页，或者处理用户从web表单输入的数据？这些任务可以通过Python CGI(公用网关接口)脚本以及一个Apache web服务器实现。当用户请求一个指定URL或者和网页交互(比如点击&#34;&#34;提交&#34;按钮)的时候，CGI脚本就会被web服务器启用。CGI脚本调用执行完毕后，它的输出结果就会被web服务器用来创建显示给用户的网页。  配置Apache web服务器，让其能运行CGI脚本 在这个教程里，我们假设Apache web服务器已经安装好，并已运行。这篇教程使用的Apache web服务器(版本2.2.15，用于CentOS发行版6.5)运行在本地主机(127.0.0.1"><meta itemprop=datePublished content="2014-12-05T10:26:00+00:00"><meta itemprop=dateModified content="2014-12-05T10:26:00+00:00"><meta itemprop=wordCount content="214"><meta itemprop=keywords content="CGI,Python,"><link rel=preconnect href=https://fonts.bunny.net crossorigin><link rel=dns-prefetch href=//fonts.bunny.net><link rel=dns-prefetch href=//fonts.bunny.net><link rel=stylesheet href="https://fonts.bunny.net/css?family=Open+Sans:400,400i,700"><link rel=stylesheet href=/css/style.css><link rel="shortcut icon" href=/favicon.ico></head><body class=body><div class="container container--outer"><header class=header><div class="container header__container"><div class=logo><a class=logo__link href=/ title="Linux.cn Archive" rel=home><div class="logo__item logo__text"><div class=logo__title>Linux.cn Archive</div></div></a></div><nav class=menu><button class=menu__btn aria-haspopup=true aria-expanded=false tabindex=0>
<span class=menu__btn-title tabindex=-1>Menu</span></button><ul class=menu__list><li class=menu__item><a class=menu__link href=/><span class=menu__text>Home</span></a></li><li class=menu__item><a class=menu__link href=/categories/><span class=menu__text>Categories</span></a></li><li class=menu__item><a class=menu__link href=/tags/><span class=menu__text>Tags</span></a></li><li class=menu__item><a class=menu__link href><span class=menu__text>RSS</span></a></li></ul></nav></div></header><div class="wrapper flex"><div class=primary><main class=main role=main><article class=post><header class=post__header><h1 class=post__title>如何创建和使用Python CGI脚本</h1><div class="post__meta meta"><div class="meta__item-datetime meta__item"><svg class="meta__icon icon icon-time" width="16" height="14" viewBox="0 0 30 28"><path d="M15 0C7 0 1 6 1 14s6 14 14 14 14-6 14-14S23 0 15 0zm0 25C9 25 4 20 4 14S9 3 15 3s11 5 11 11-5 11-11 11zm1-18h-2v8.4l6.8 4.4L22 18l-6-3.8V7z"/></svg><time class=meta__text datetime=2014-12-05T10:26:00Z>December 05, 2014</time></div></div></header><div class="content post__content clearfix"><p>你是否想使用Python语言创建一个网页，或者处理用户从web表单输入的数据？这些任务可以通过Python CGI(公用网关接口)脚本以及一个Apache web服务器实现。当用户请求一个指定URL或者和网页交互(比如点击"&ldquo;提交"按钮)的时候，CGI脚本就会被web服务器启用。CGI脚本调用执行完毕后，它的输出结果就会被web服务器用来创建显示给用户的网页。</p><p><img src=/data/attachment/album/201412/04/232938y1l1ttm7mmmjjmmk.png alt></p><h3 id=配置apache-web服务器让其能运行cgi脚本>配置Apache web服务器，让其能运行CGI脚本</h3><p>在这个教程里，我们假设Apache web服务器已经安装好，并已运行。这篇教程使用的Apache web服务器(版本2.2.15，用于CentOS发行版6.5)运行在本地主机(127.0.0.1)，并且监听80端口，如下面的Apache指令指定一样：</p><pre tabindex=0><code>ServerName 127.0.0.1:80
Listen 80
</code></pre><p>下面举例中的HTML文件存放在web服务器上的/var/www/html目录下，并通过DocumentRoot指令指定(指定网页文件所在目录)：</p><pre tabindex=0><code>DocumentRoot &#34;/var/www/html&#34;
</code></pre><p>现在尝试请求URL：http://localhost/page1.html</p><p>这将返回web服务器中下面文件的内容：</p><pre tabindex=0><code>/var/www/html/page1.html
</code></pre><p>为了启用CGI脚本，我们必须指定CGI脚本在web服务器上的位置，需要用到ScriptAlias指令：</p><pre tabindex=0><code>ScriptAlias /cgi-bin/ &#34;/var/www/cgi-bin/&#34;
</code></pre><p>以上指令表明CGI脚本保存在web服务器的/var/www/cgi-bin目录，请求URL里包含/cgi-bin/的将会搜索这个目录下的CGI脚本。</p><p>我们必须还要明确CGI脚本在/var/www/cgi-bin目录下有执行权限，还要指定CGI脚本的文件扩展名。使用下面的指令：</p><pre tabindex=0><code>&lt;Directory &#34;/var/www/cgi-bin&#34;&gt;
    Options +ExecCGI
    AddHandler cgi-script .py
&lt;/Directory&gt;
</code></pre><p>下面访问URL：http://localhost/cgi-bin/myscript-1.py</p><p>这将会调用web服务器中下面所示脚本：</p><pre tabindex=0><code>/var/www/cgi-bin/myscript-1.py
</code></pre><h3 id=创建一个cgi脚本>创建一个CGI脚本</h3><p>在创建一个Python CGI脚本之前，你需要确认你已经安装了Python(这通常是默认安装的，但是安装版本可能会有所不同)。本篇教程使用的脚本是使用Python版本2.6.6编写的。你可以通过下面任意一命令(-V和&ndash;version参数将显示所安装Python的版本号)检查Python的版本。</p><pre tabindex=0><code>$ python -V
$ python --version
</code></pre><p>如果你的Python CGI脚本要用来处理用户输入的数据(从一个web输入表单)，那么你将需要导入Python cgi模块。这个模块可以处理用户通过web输入表单输入的数据。你可以在你的脚本中通过下面的语句导入该脚本：</p><pre tabindex=0><code>import cgi
</code></pre><p>你也必须修改Python CGI脚本的执行权限，以防止web服务器不能调用。可以通过下面的命令增加执行权限：</p><pre tabindex=0><code># chmod o+x myscript-1.py
</code></pre><h3 id=python-cgi例子>Python CGI例子</h3><p>涉及到Python CGI脚本的两个方案将会在下面讲述：</p><ul><li>使用Python脚本创建一个网页</li><li>读取并显示用户输入的数据，并且在网页上显示结果</li></ul><p>注意：Python cgi模块在方案2中是必需的，因为这涉及到用户从web表单输入数据。</p><h3 id=例子1-使用python脚本创建一个网页>例子1 ：使用Python脚本创建一个网页</h3><p>对于这个方案，我们将通过创建包含一个单一提交按钮的网页/var/www/html/page1.html开始。</p><pre tabindex=0><code>&lt;html&gt;
&lt;h1&gt;Test Page 1&lt;/h1&gt;
&lt;form name=&#34;input&#34; action=&#34;/cgi-bin/myscript-1.py&#34; method=&#34;get&#34;&gt;
&lt;input type=&#34;submit&#34; value=&#34;Submit&#34;&gt;
&lt;/form&gt;
&lt;/html&gt;
</code></pre><p>当"提交"按钮被点击，/var/www/cgi-bin/myscript-1.py脚本将被调用(通过action参数指定)。通过设置方法参数为"get"来指定一个"GET"请求，服务器将会返回指定的网页。/var/www/html/page1.html在浏览器中的显示情况如下：</p><p><img src=/data/attachment/album/201412/04/232941b1d4dd2d6axx6u54.jpg alt></p><p>/var/www/cgi-bin/myscript-1.py的内容如下：</p><pre tabindex=0><code>#!/usr/bin/python
print &#34;Content-Type: text/html&#34;
print &#34;&#34;
print &#34;&lt;html&gt;&#34;
print &#34;&lt;h2&gt;CGI Script Output&lt;/h2&gt;&#34;
print &#34;&lt;p&gt;This page was generated by a Python CGI script.&lt;/p&gt;&#34;
print &#34;&lt;/html&gt;&#34; 
</code></pre><p>第一行声明表示这是使用 /usr/bin/python命令运行的Python脚本。&ldquo;Content-Type: text/html"打印语句是必需的，这是为了让web服务器知道接受自CGI脚本的输出类型。其余的语句用来输出HTML格式的其余网页内容。</p><p>当"Submit"按钮点击，下面的网页将返回：</p><p><img src=/data/attachment/album/201412/04/232943rn7iiws4g8z8pp78.jpg alt></p><p>这个例子的要点是你可以决定哪些信息可以被CGI脚本返回。这可能包括日志文件的内容，当前登陆用户的列表，或者今天的日期。在你处理时拥有所有python库的可能性是无穷无尽的。</p><h3 id=例子2读取并显示用户输入的数据并将结果显示在网页上>例子2：读取并显示用户输入的数据，并将结果显示在网页上</h3><p>对于这个方案，我们将通过创建一个含有三个输入域和一个提交按钮的网页/var/www/html/page2.html开始。</p><pre tabindex=0><code>&lt;html&gt;
&lt;h1&gt;Test Page 2&lt;/h1&gt;
&lt;form name=&#34;input&#34; action=&#34;/cgi-bin/myscript-2.py&#34; method=&#34;get&#34;&gt;
First Name: &lt;input type=&#34;text&#34; name=&#34;firstName&#34;&gt;&lt;br&gt;
Last Name: &lt;input type=&#34;text&#34; name=&#34;lastName&#34;&gt;&lt;br&gt;
Position: &lt;input type=&#34;text&#34; name=&#34;position&#34;&gt;&lt;br&gt;
&lt;input type=&#34;submit&#34; value=&#34;Submit&#34;&gt; 
&lt;/form&gt;
&lt;/html&gt;
</code></pre><p>当"Submit"按钮点击，/var/www/cgi-bin/myscript-2.py脚本将被执行(通过action参数指定)。/var/www//html/page2.html显示在web浏览器中的图片如下所示(注意，三个输入域已经被填写好了)：</p><p><img src=/data/attachment/album/201412/04/232945rje944yen44u84m1.jpg alt></p><p>/var/www/cgi-bin/myscript-2.py的内容如下：</p><pre tabindex=0><code>#!/usr/bin/python
import cgi
form = cgi.FieldStorage()
print &#34;Content-Type: text/html&#34;
print &#34;&#34;
print &#34;&lt;html&gt;&#34;
print &#34;&lt;h2&gt;CGI Script Output&lt;/h2&gt;&#34;
print &#34;&lt;p&gt;&#34;
print &#34;The user entered data are:&lt;br&gt;&#34;
print &#34;&lt;b&gt;First Name:&lt;/b&gt; &#34; + form[&#34;firstName&#34;].value + &#34;&lt;br&gt;&#34;
print &#34;&lt;b&gt;Last Name:&lt;/b&gt; &#34; + form[&#34;lastName&#34;].value + &#34;&lt;br&gt;&#34;
print &#34;&lt;b&gt;Position:&lt;/b&gt; &#34; + form[&#34;position&#34;].value + &#34;&lt;br&gt;&#34;
print &#34;&lt;/p&gt;&#34;
print &#34;&lt;/html&gt;&#34;
</code></pre><p>正如前面提到，import cgi语句用来确保能够处理用户通过web输入表单输入的数据。web输入表单被封装在一个表单对象中，叫做cgi.FieldStorage对象。一旦开始输出，&ldquo;Content-Type: text/html"是必需的，因为web服务器需要知道接受自CGI脚本的输出格式。用户输入的数据在包含form[&ldquo;firstName&rdquo;].value，form[&ldquo;lastName&rdquo;].value，和 form[&ldquo;position&rdquo;].value的语句中可以得到。那些中括号中的名称和**/var/www/html/page2.html**文本输入域中定义的名称参数一致。</p><p>当网页上的"Submit"按钮被点击，下面的网页将被返回。</p><p><img src=/data/attachment/album/201412/04/232946w442bc70r7ebczwz.jpg alt></p><p>这个例子的要点就是你可以很容易地读取并显示用户在web表单上输入的数据。除了以字符串的方式处理数据，你也可以用Python将用户输入的数据转化为可用于数值计算的数字。</p><h3 id=结论>结论</h3><p>本教程演示了如何使用Python CGI脚本创建网页并处理用户在网页表单输入的数据。查阅更多关于Apache CGI脚本的信息，点击<a href=http://httpd.apache.org/docs/2.2/howto/cgi.html>这里</a>。查阅更多关于Python cgi模块的信息，点击<a href=https://docs.python.org/2/library/cgi.html#module-cgi>这里</a>。</p><hr><p>via: <a href=http://xmodulo.com/create-use-python-cgi-scripts.html>http://xmodulo.com/create-use-python-cgi-scripts.html</a></p><p>作者：<a href=http://xmodulo.com/author/joshua>Joshua Reed</a> 译者：<a href=https://github.com/su-kaiyao>su-kaiyao</a> 校对：<a href=https://github.com/wxy>wxy</a></p><p>本文由 <a href=https://github.com/LCTT/TranslateProject>LCTT</a> 原创翻译，<a href=http://linux.cn/>Linux中国</a> 荣誉推出</p></div><footer class=post__footer><div class="post__tags tags clearfix"><svg class="tags__badge icon icon-tag" width="16" height="16" viewBox="0 0 32 32"><path d="M32 19c0 1-1 2-1 2L21 31s-1 1-2 1-2-1-2-1L2 16c-1-1-1.4-2-1.4-2S0 12.5.0 11V3C0 1.5.8.8.8.8S1.5.0 3 0h8c1.5.0 3 .6 3 .6S15 1 16 2l15 15s1 1 1 2zM7 10a3 3 0 100-6 3 3 0 000 6z"/></svg><ul class=tags__list><li class=tags__item><a class="tags__link btn" href=/tags/cgi/ rel=tag>CGI</a></li><li class=tags__item><a class="tags__link btn" href=/tags/python/ rel=tag>Python</a></li></ul></div></footer></article></main></div></div><footer class=footer><div class="container footer__container flex"><div class=footer__copyright>&copy; 2025 Linux.cn Archive.
<span class=footer__copyright-credits>Generated with <a href=https://gohugo.io/ rel="nofollow noopener" target=_blank>Hugo</a> and <a href=https://github.com/Vimux/Mainroad/ rel="nofollow noopener" target=_blank>Mainroad</a> theme.</span></div></div></footer></div><script async defer src=/js/menu.js></script></body></html>