<!doctype html><html class=no-js lang=en><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><title>一种为 Linux ARM 设备构建跨平台 UI 的新方法 - Linux.cn Archive</title>
<script>(function(e,t){e[t]=e[t].replace("no-js","js")})(document.documentElement,"className")</script><meta name=description content><meta property="og:title" content="一种为 Linux ARM 设备构建跨平台 UI 的新方法"><meta property="og:description" content="AndroidXML 和 TotalCross 的运用为树莓派和其他设备创建 UI 提供了更简单的方法。"><meta property="og:type" content="article"><meta property="og:url" content="/article-13129-1.html"><meta property="article:section" content="posts"><meta property="article:published_time" content="2021-02-18T12:37:52+00:00"><meta property="article:modified_time" content="2021-02-18T12:37:52+00:00"><meta itemprop=name content="一种为 Linux ARM 设备构建跨平台 UI 的新方法"><meta itemprop=description content="AndroidXML 和 TotalCross 的运用为树莓派和其他设备创建 UI 提供了更简单的方法。"><meta itemprop=datePublished content="2021-02-18T12:37:52+00:00"><meta itemprop=dateModified content="2021-02-18T12:37:52+00:00"><meta itemprop=wordCount content="283"><meta itemprop=keywords content="UI,"><link rel=preconnect href=https://fonts.bunny.net crossorigin><link rel=dns-prefetch href=//fonts.bunny.net><link rel=dns-prefetch href=//fonts.bunny.net><link rel=stylesheet href="https://fonts.bunny.net/css?family=Open+Sans:400,400i,700"><link rel=stylesheet href=/css/style.css><link rel="shortcut icon" href=/favicon.ico></head><body class=body><div class="container container--outer"><header class=header><div class="container header__container"><div class=logo><a class=logo__link href=/ title="Linux.cn Archive" rel=home><div class="logo__item logo__text"><div class=logo__title>Linux.cn Archive</div></div></a></div><nav class=menu><button class=menu__btn aria-haspopup=true aria-expanded=false tabindex=0>
<span class=menu__btn-title tabindex=-1>Menu</span></button><ul class=menu__list><li class=menu__item><a class=menu__link href=/><span class=menu__text>Home</span></a></li><li class=menu__item><a class=menu__link href=/categories/><span class=menu__text>Categories</span></a></li><li class=menu__item><a class=menu__link href=/tags/><span class=menu__text>Tags</span></a></li><li class=menu__item><a class=menu__link href><span class=menu__text>RSS</span></a></li></ul></nav></div></header><div class="wrapper flex"><div class=primary><main class=main role=main><article class=post><header class=post__header><h1 class=post__title>一种为 Linux ARM 设备构建跨平台 UI 的新方法</h1><div class="post__meta meta"><div class="meta__item-datetime meta__item"><svg class="meta__icon icon icon-time" width="16" height="14" viewBox="0 0 30 28"><path d="M15 0C7 0 1 6 1 14s6 14 14 14 14-6 14-14S23 0 15 0zm0 25C9 25 4 20 4 14S9 3 15 3s11 5 11 11-5 11-11 11zm1-18h-2v8.4l6.8 4.4L22 18l-6-3.8V7z"/></svg><time class=meta__text datetime=2021-02-18T12:37:52Z>February 18, 2021</time></div></div></header><div class="content post__content clearfix"><blockquote><p>AndroidXML 和 TotalCross 的运用为树莓派和其他设备创建 UI 提供了更简单的方法。</p></blockquote><p><img src=https://img.linux.net.cn/data/attachment/album/202102/18/123715oomfuuz94ioi41ii.jpg alt title="Digital images of a computer desktop"></p><p>为应用程序创建良好的用户体验（UX）是一项艰巨的任务，尤其是在开发嵌入式应用程序时。今天，有两种图形用户界面（GUI）工具通常用于开发嵌入式软件：它们要么涉及复杂的技术，要么非常昂贵。</p><p>然而，我们已经创建了一个概念验证（PoC），它提供了一种新的方法来使用现有的、成熟的工具为运行在桌面、移动、嵌入式设备和低功耗 ARM 设备上的应用程序构建用户界面（UI）。我们的方法是使用 Android Studio 绘制 UI；使用 <a href=https://totalcross.com/>TotalCross</a> 在设备上呈现 Android XML；采用被称为 <a href=https://github.com/TotalCross/KnowCodeXML>KnowCode</a> 的新 <a href=https://yourapp.totalcross.com/knowcode-app>TotalCross API</a>；以及使用 <a href=https://www.raspberrypi.org/>树莓派 4</a> 来执行应用程序。</p><h3 id=选择-android-studio>选择 Android Studio</h3><p>可以使用 TotalCross API 为应用程序构建一个美观的响应式用户体验，但是在 Android Studio 中创建 UI 缩短了制作原型和实际应用程序之间的时间。</p><p>有很多工具可以用来为应用程序构建 UI，但是 <a href=https://developer.android.com/studio>Android Studio</a> 是全世界开发者最常使用的工具。除了它被大量采用以外，这个工具的使用也非常直观，而且它对于创建简单和复杂的应用程序都非常强大。在我看来，唯一的缺点是使用该工具所需的计算机性能，它比其他集成开发环境 （IDE） 如 VSCode 或其开源替代方案 <a href=https://vscodium.com/>VSCodium</a> 要庞大得多。</p><p>通过思考这些问题，我们创建了一个概念验证，使用 Android Studio 绘制 UI，并使用 TotalCross 直接在设备上运行 AndroidXML。</p><h3 id=构建-ui>构建 UI</h3><p>对于我们的 PoC，我们想创建一个家用电器应用程序来控制温度和其他东西，并在 Linux ARM 设备上运行。</p><p><img src=https://img.linux.net.cn/data/attachment/album/202102/18/123754nxtt51tgtg21jht5.png alt="Home appliance application to control thermostat" title="Home appliance application to control thermostat"></p><p>我们想为树莓派开发我们的应用程序，所以我们使用 Android 的 <a href=https://codelabs.developers.google.com/codelabs/constraint-layout/index.html#0>ConstraintLayout</a> 来构建 848x480（树莓派的分辨率）的固定屏幕大小的 UI，不过你可以用其他布局构建响应性 UI。</p><p>Android XML 为 UI 创建增加了很多灵活性，使得为应用程序构建丰富的用户体验变得容易。在下面的 XML 中，我们使用了两个主要组件：<a href=https://developer.android.com/reference/android/widget/ImageView>ImageView</a> 和 <a href=https://developer.android.com/reference/android/widget/TextView>TextView</a>。</p><pre tabindex=0><code>&lt;ImageView
android:id=&#34;@+id/imageView6&#34;
android:layout_width=&#34;273dp&#34;
android:layout_height=&#34;291dp&#34;
android:background=&#34;@drawable/Casa&#34;
tools:layout_editor_absoluteX=&#34;109dp&#34;
tools:layout_editor_absoluteY=&#34;95dp&#34; /&gt;
&lt;TextView
android:id=&#34;@+id/insideTempEdit&#34;
android:layout_width=&#34;94dp&#34;
android:layout_height=&#34;92dp&#34;
android:background=&#34;#F5F5F5&#34;
android:text=&#34;20&#34;
android:textAlignment=&#34;center&#34;
android:gravity=&#34;center&#34;
android:textColor=&#34;#000000&#34;
android:textSize=&#34;67dp&#34;
android:textStyle=&#34;bold&#34;
tools:layout_editor_absoluteX=&#34;196dp&#34;
tools:layout_editor_absoluteY=&#34;246dp&#34; /&gt;
</code></pre><p>TextView 元素用于向用户显示一些数据，比如建筑物内的温度。大多数 ImageView 都用作用户与 UI 交互的按钮，但它们也需要实现屏幕上组件提供的事件。</p><h3 id=用-totalcross-整合>用 TotalCross 整合</h3><p>这个 PoC 中的第二项技术是 TotalCross。我们不想在设备上使用 Android 的任何东西，因为：</p><p>1。我们的目标是为 Linux ARM 提供一个出色的 UI。 2。我们希望在设备上实现低占用。 3。我们希望应用程序在低计算能力的低端硬件设备上运行（例如，没有 GPU、 低 RAM 等）。</p><p>首先，我们使用 <a href=https://medium.com/totalcross-community/totalcross-plugin-for-vscode-4f45da146a0a>VSCode 插件</a> 创建了一个空的 TotalCross 项目。接下来，我们保存了 <code>drawable</code> 文件夹中的图像副本和 <code>xml</code> 文件夹中的 Android XML 文件副本，这两个文件夹都位于 <code>resources</code> 文件夹中：</p><p><img src=https://img.linux.net.cn/data/attachment/album/202102/18/123754n22li8268d82s882.png alt="Home Appliance file structure" title="Home Appliance file structure"></p><p>为了使用 TotalCross 模拟器运行 XML 文件，我们添加了一个名为 KnowCode 的新 TotalCross API 和一个主窗口来加载 XML。下面的代码使用 API 加载和呈现 XML：</p><pre tabindex=0><code>public void initUI() {
    XmlScreenAbstractLayout xmlCont = XmlScreenFactory.create(&#34;xml / homeApplianceXML.xml&#34;);
    swap(xmlCont);
}
</code></pre><p>就这样！只需两个命令，我们就可以使用 TotalCross 运行 Android XML 文件。以下是 XML 如何在 TotalCross 的模拟器上执行：</p><p><img src=https://img.linux.net.cn/data/attachment/album/202102/18/123755zcjpqmjj7v4o7dol.png alt="TotalCross simulator running temperature application" title="TotalCross simulator running temperature application"></p><p>完成这个 PoC 还有两件事要做：添加一些事件来提供用户交互，并在树莓派上运行它。</p><h3 id=添加事件>添加事件</h3><p>KnowCode API 提供了一种通过 ID（<code>getControlByID</code>） 获取 XML 元素并更改其行为的方法，如添加事件、更改可见性等。</p><p>例如，为了使用户能够改变家中或其他建筑物的温度，我们在 UI 底部放置了加号和减号按钮，并在每次单击按钮时都会出现“单击”事件，使温度升高或降低一度：</p><pre tabindex=0><code>Button plus = (Button) xmlCont.getControlByID(&#34;@+id/plus&#34;);
Label insideTempLabel = (Label) xmlCont.getControlByID(&#34;@+id/insideTempLabel&#34;);
plus.addPressListener(new PressListener() {
    @Override
    public void controlPressed(ControlEvent e) {
        try {
            String tempString = insideTempLabel.getText();
            int temp;
            temp = Convert.toInt(tempString);
            insideTempLabel.setText(Convert.toString(++temp));
        } catch (InvalidNumberException e1) {
            e1.printStackTrace();
        }
    }
});
</code></pre><h3 id=在树莓派-4-上测试>在树莓派 4 上测试</h3><p>最后一步！我们在一台设备上运行了应用程序并检查了结果。我们只需要打包应用程序并在目标设备上部署和运行它。<a href=https://tigervnc.org/>VNC</a> 也可用于检查设备上的应用程序。</p><p>整个应用程序，包括资源（图像等）、Android XML、TotalCross 和 Knowcode API，在 Linux ARM 上大约是 8MB。</p><p>下面是应用程序的演示：</p><p><img src=https://img.linux.net.cn/data/attachment/album/202102/18/123755iasg8auh22sk2d11.gif alt="Application demo" title="Application demo"></p><p>在本例中，该应用程序仅为 Linux ARM 打包，但同一应用程序可以作为 Linux 桌面应用程序运行，在Android 设备 、Windows、windows CE 甚至 iOS 上运行。</p><p>所有示例源代码和项目都可以在 <a href=https://github.com/TotalCross/HomeApplianceXML>HomeApplianceXML GitHub</a> 存储库中找到。</p><h3 id=现有工具的新玩法>现有工具的新玩法</h3><p>为嵌入式应用程序创建 GUI 并不需要像现在这样困难。这种概念证明为如何轻松地完成这项任务提供了新的视角，不仅适用于嵌入式系统，而且适用于所有主要的操作系统，所有这些系统都使用相同的代码库。</p><p>我们的目标不是为设计人员或开发人员创建一个新的工具来构建 UI 应用程序；我们的目标是为使用现有的最佳工具提供新的玩法。</p><p>你对这种新的应用程序开发方式有何看法？在下面的评论中分享你的想法。</p><hr><p>via: <a href=https://opensource.com/article/20/5/linux-arm-ui>https://opensource.com/article/20/5/linux-arm-ui</a></p><p>作者：<a href=https://opensource.com/users/brunoamuniz>Bruno Muniz</a> 选题：<a href=https://github.com/lujun9972>lujun9972</a> 译者：<a href=https://github.com/Chao-zhi>Chao-zhi</a> 校对：<a href=https://github.com/wxy>wxy</a></p><p>本文由 <a href=https://github.com/LCTT/TranslateProject>LCTT</a> 原创编译，<a href=https://linux.cn/>Linux中国</a> 荣誉推出</p></div><footer class=post__footer><div class="post__tags tags clearfix"><svg class="tags__badge icon icon-tag" width="16" height="16" viewBox="0 0 32 32"><path d="M32 19c0 1-1 2-1 2L21 31s-1 1-2 1-2-1-2-1L2 16c-1-1-1.4-2-1.4-2S0 12.5.0 11V3C0 1.5.8.8.8.8S1.5.0 3 0h8c1.5.0 3 .6 3 .6S15 1 16 2l15 15s1 1 1 2zM7 10a3 3 0 100-6 3 3 0 000 6z"/></svg><ul class=tags__list><li class=tags__item><a class="tags__link btn" href=/tags/ui/ rel=tag>UI</a></li></ul></div></footer></article></main></div></div><footer class=footer><div class="container footer__container flex"><div class=footer__copyright>&copy; 2025 Linux.cn Archive.
<span class=footer__copyright-credits>Generated with <a href=https://gohugo.io/ rel="nofollow noopener" target=_blank>Hugo</a> and <a href=https://github.com/Vimux/Mainroad/ rel="nofollow noopener" target=_blank>Mainroad</a> theme.</span></div></div></footer></div><script async defer src=/js/menu.js></script></body></html>