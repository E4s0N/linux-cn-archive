<!doctype html><html class=no-js lang=en><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><title>Telnet，爱一直在 - Linux.cn Archive</title>
<script>(function(e,t){e[t]=e[t].replace("no-js","js")})(document.documentElement,"className")</script><meta name=description content><meta property="og:title" content="Telnet，爱一直在"><meta property="og:description" content="登录远程服务器，你可能不会也从未考虑过它。但这并不意味着 telnet 命令在调试远程连接问题时不是一个实用的工具。"><meta property="og:type" content="article"><meta property="og:url" content="/article-9369-1.html"><meta property="article:section" content="posts"><meta property="article:published_time" content="2018-02-22T10:59:32+00:00"><meta property="article:modified_time" content="2018-02-22T10:59:32+00:00"><meta itemprop=name content="Telnet，爱一直在"><meta itemprop=description content="登录远程服务器，你可能不会也从未考虑过它。但这并不意味着 telnet 命令在调试远程连接问题时不是一个实用的工具。"><meta itemprop=datePublished content="2018-02-22T10:59:32+00:00"><meta itemprop=dateModified content="2018-02-22T10:59:32+00:00"><meta itemprop=wordCount content="302"><meta itemprop=keywords content="telnet,"><link rel=preconnect href=https://fonts.bunny.net crossorigin><link rel=dns-prefetch href=//fonts.bunny.net><link rel=dns-prefetch href=//fonts.bunny.net><link rel=stylesheet href="https://fonts.bunny.net/css?family=Open+Sans:400,400i,700"><link rel=stylesheet href=/css/style.css><link rel="shortcut icon" href=/favicon.ico></head><body class=body><div class="container container--outer"><header class=header><div class="container header__container"><div class=logo><a class=logo__link href=/ title="Linux.cn Archive" rel=home><div class="logo__item logo__text"><div class=logo__title>Linux.cn Archive</div></div></a></div><nav class=menu><button class=menu__btn aria-haspopup=true aria-expanded=false tabindex=0>
<span class=menu__btn-title tabindex=-1>Menu</span></button><ul class=menu__list><li class=menu__item><a class=menu__link href=/><span class=menu__text>Home</span></a></li><li class=menu__item><a class=menu__link href=/categories/><span class=menu__text>Categories</span></a></li><li class=menu__item><a class=menu__link href=/tags/><span class=menu__text>Tags</span></a></li><li class=menu__item><a class=menu__link href><span class=menu__text>RSS</span></a></li></ul></nav></div></header><div class="wrapper flex"><div class=primary><main class=main role=main><article class=post><header class=post__header><h1 class=post__title>Telnet，爱一直在</h1><div class="post__meta meta"><div class="meta__item-datetime meta__item"><svg class="meta__icon icon icon-time" width="16" height="14" viewBox="0 0 30 28"><path d="M15 0C7 0 1 6 1 14s6 14 14 14 14-6 14-14S23 0 15 0zm0 25C9 25 4 20 4 14S9 3 15 3s11 5 11 11-5 11-11 11zm1-18h-2v8.4l6.8 4.4L22 18l-6-3.8V7z"/></svg><time class=meta__text datetime=2018-02-22T10:59:32Z>February 22, 2018</time></div></div></header><div class="content post__content clearfix"><p><img src=/data/attachment/album/201802/22/105938exdcxkgw6hccg772.jpg alt></p><p>Telnet，是系统管理员登录远程服务器的一种协议和工具。然而，由于所有的通信都没有加密，包括密码，都是明文发送的。Telnet 在 SSH 被开发出来之后就基本弃用了。</p><p>登录远程服务器，你可能不会也从未考虑过它。但这并不意味着 <code>telnet</code> 命令在调试远程连接问题时不是一个实用的工具。</p><p>本教程中，我们将探索使用 <code>telnet</code> 解决所有常见问题：“我怎么又连不上啦？”</p><p>这种讨厌的问题通常会在安装了像 Web服务器、邮件服务器、ssh 服务器、Samba 服务器等诸如此类的事之后遇到，用户无法连接服务器。</p><p><code>telnet</code> 不会解决问题但可以很快缩小问题的范围。</p><p><code>telnet</code> 用来调试网络问题的简单命令和语法：</p><pre tabindex=0><code>telnet &lt;hostname or IP&gt; &lt;port&gt;
</code></pre><p>因为 <code>telnet</code> 最初通过端口建立连接不会发送任何数据，适用于任何协议，包括加密协议。</p><p>连接问题服务器有四个可能会遇到的主要问题。我们会研究这四个问题，研究它们意味着什么以及如何解决。</p><p>本教程默认已经在 <code>samba.example.com</code> 安装了 <a href=https://www.samba.org/>Samba</a> 服务器而且本地客户无法连上服务器。</p><h3 id=error-1---连接挂起>Error 1 - 连接挂起</h3><p>首先，我们需要试着用 <code>telnet</code> 连接 Samba 服务器。使用下列命令 (Samba 监听端口445)：</p><pre tabindex=0><code>telnet samba.example.com 445
</code></pre><p>有时连接会莫名停止：</p><pre tabindex=0><code>telnet samba.example.com 445
Trying 172.31.25.31...
</code></pre><p>这意味着 <code>telnet</code> 没有收到任何回应来建立连接。有两个可能的原因：</p><ol><li>你和服务器之间有个路由器宕掉了。</li><li>防火墙拦截了你的请求。</li></ol><p>为了排除第 1 点，对服务器上进行一个快速 <a href=https://www.systutorials.com/docs/linux/man/8-mtr/><code>mtr samba.example.com</code></a> 。如果服务器是可达的，那么便是防火墙（注意：防火墙总是存在的）。</p><p>首先用 <code>iptables -L -v -n</code> 命令检查服务器本身有没有防火墙，没有的话你能看到以下内容：</p><pre tabindex=0><code>iptables -L -v -n
Chain INPUT (policy ACCEPT 0 packets, 0 bytes)
 pkts bytes target prot opt in out source destination

Chain FORWARD (policy ACCEPT 0 packets, 0 bytes)
 pkts bytes target prot opt in out source destination

Chain OUTPUT (policy ACCEPT 0 packets, 0 bytes)
 pkts bytes target prot opt in out source destination
</code></pre><p>如果你看到其他东西那可能就是问题所在了。为了检验，停止 <code>iptables</code> 一下并再次运行 <code>telnet samba.example.com 445</code> 看看你是否能连接。如果你还是不能连接看看你的提供商或企业有没有防火墙拦截你。</p><h3 id=error-2---dns-问题>Error 2 - DNS 问题</h3><p>DNS 问题通常发生在你正使用的主机名没有解析到 IP 地址。错误如下：</p><pre tabindex=0><code>telnet samba.example.com 445
Server lookup failure: samba.example.com:445, Name or service not known
</code></pre><p>第一步是把主机名替换成服务器的 IP 地址。如果你可以连上那么就是主机名的问题。</p><p>有很多发生的原因（以下是我见过的）：</p><ol><li>域名注册了吗？用 <code>whois</code> 来检验。</li><li>域名过期了吗？用 <code>whois</code> 来检验。</li><li>是否使用正确的主机名？用 <code>dig</code> 或 <code>host</code> 来确保你使用的主机名解析到正确的 IP。</li><li>你的 <strong>A</strong> 记录正确吗？确保你没有偶然创建类似 <code>smaba.example.com</code> 的 <strong>A</strong> 记录。</li></ol><p>一定要多检查几次拼写和主机名是否正确（是 <code>samba.example.com</code> 还是 <code>samba1.example.com</code>）？这些经常会困扰你，特别是比较长、难记或其它国家的主机名。</p><h3 id=error-3---服务器没有侦听端口>Error 3 - 服务器没有侦听端口</h3><p>这种错误发生在 <code>telnet</code> 可达服务器但是指定端口没有监听。就像这样：</p><pre tabindex=0><code>telnet samba.example.com 445
Trying 172.31.25.31...
telnet: Unable to connect to remote host: Connection refused
</code></pre><p>有这些原因：</p><ol><li>你 <strong>确定</strong> 连接的是正确的服务器？</li><li>你的应用服务器没有侦听预期的端口。在服务器上运行 <code>netstat -plunt</code> 来查看它究竟在干什么并看哪个端口才是对的，实际正在监听中的。</li><li>应用服务器没有运行。这可能突然而又悄悄地发生在你启动应用服务器之后。启动服务器运行 <code>ps auxf</code> 或 <code>systemctl status application.service</code> 查看运行。</li></ol><h3 id=error-4---连接被服务器关闭>Error 4 - 连接被服务器关闭</h3><p>这种错误发生在连接成功建立但是应用服务器建立的安全措施一连上就将其结束。错误如下：</p><pre tabindex=0><code>telnet samba.example.com 445
Trying 172.31.25.31...
Connected to samba.example.com.
Escape character is &#39;^]&#39;.
Connection closed by foreign host.
</code></pre><p>最后一行 <code>Connection closed by foreign host.</code> 意味着连接被服务器主动终止。为了修复这个问题，需要看看应用服务器的安全设置确保你的 IP 或用户允许连接。</p><h3 id=成功连接>成功连接</h3><p>成功的 <code>telnet</code> 连接如下：</p><pre tabindex=0><code>telnet samba.example.com 445
Trying 172.31.25.31...
Connected to samba.example.com.
Escape character is &#39;^]&#39;.
</code></pre><p>连接会保持一段时间只要你连接的应用服务器时限没到。</p><p>输入 <code>CTRL+]</code> 中止连接，然后当你看到 <code>telnet></code> 提示，输入 <code>quit</code> 并按回车：</p><pre tabindex=0><code>telnet samba.example.com 445
Trying 172.31.25.31...
Connected to samba.example.com.
Escape character is &#39;^]&#39;.
^]
telnet&gt; quit
Connection closed.
</code></pre><h3 id=总结>总结</h3><p>客户程序连不上服务器的原因有很多。确切原因很难确定，特别是当客户是图形用户界面提供很少或没有错误信息。用 <code>telnet</code> 并观察输出可以让你很快确定问题所在节约很多时间。</p><hr><p>via: <a href=https://bash-prompt.net/guides/telnet/>https://bash-prompt.net/guides/telnet/</a></p><p>作者：<a href=https://bash-prompt.net>Elliot Cooper</a> 译者：<a href=https://github.com/XYenChi>XYenChi</a> 校对：<a href=https://github.com/wxy>wxy</a></p><p>本文由 <a href=https://github.com/LCTT/TranslateProject>LCTT</a> 原创编译，<a href=https://linux.cn/>Linux中国</a> 荣誉推出</p></div><footer class=post__footer><div class="post__tags tags clearfix"><svg class="tags__badge icon icon-tag" width="16" height="16" viewBox="0 0 32 32"><path d="M32 19c0 1-1 2-1 2L21 31s-1 1-2 1-2-1-2-1L2 16c-1-1-1.4-2-1.4-2S0 12.5.0 11V3C0 1.5.8.8.8.8S1.5.0 3 0h8c1.5.0 3 .6 3 .6S15 1 16 2l15 15s1 1 1 2zM7 10a3 3 0 100-6 3 3 0 000 6z"/></svg><ul class=tags__list><li class=tags__item><a class="tags__link btn" href=/tags/telnet/ rel=tag>telnet</a></li></ul></div></footer></article></main></div></div><footer class=footer><div class="container footer__container flex"><div class=footer__copyright>&copy; 2025 Linux.cn Archive.
<span class=footer__copyright-credits>Generated with <a href=https://gohugo.io/ rel="nofollow noopener" target=_blank>Hugo</a> and <a href=https://github.com/Vimux/Mainroad/ rel="nofollow noopener" target=_blank>Mainroad</a> theme.</span></div></div></footer></div><script async defer src=/js/menu.js></script></body></html>