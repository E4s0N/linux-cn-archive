<!doctype html><html class=no-js lang=en><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><title>如何在 Windows 上运行 Linux 容器 - Linux.cn Archive</title>
<script>(function(e,t){e[t]=e[t].replace("no-js","js")})(document.documentElement,"className")</script><meta name=description content><meta property="og:title" content="如何在 Windows 上运行 Linux 容器"><meta property="og:description" content="现在能够在 Windows 10 和 Windows 服务器上运行 Docker 容器了，它是以 Ubuntu 作为宿主基础的。
想象一下，使用你喜欢的 Linux 发行版——比如 Ubuntu——在 Windows 上运行你自己的 Linux 应用。"><meta property="og:type" content="article"><meta property="og:url" content="/article-8873-1.html"><meta property="article:section" content="posts"><meta property="article:published_time" content="2017-09-17T10:56:00+00:00"><meta property="article:modified_time" content="2017-09-17T10:56:00+00:00"><meta itemprop=name content="如何在 Windows 上运行 Linux 容器"><meta itemprop=description content="现在能够在 Windows 10 和 Windows 服务器上运行 Docker 容器了，它是以 Ubuntu 作为宿主基础的。
想象一下，使用你喜欢的 Linux 发行版——比如 Ubuntu——在 Windows 上运行你自己的 Linux 应用。"><meta itemprop=datePublished content="2017-09-17T10:56:00+00:00"><meta itemprop=dateModified content="2017-09-17T10:56:00+00:00"><meta itemprop=wordCount content="294"><meta itemprop=keywords content="Ubuntu,Windows,Docker,"><link rel=preconnect href=https://fonts.bunny.net crossorigin><link rel=dns-prefetch href=//fonts.bunny.net><link rel=dns-prefetch href=//fonts.bunny.net><link rel=stylesheet href="https://fonts.bunny.net/css?family=Open+Sans:400,400i,700"><link rel=stylesheet href=/css/style.css><link rel="shortcut icon" href=/favicon.ico></head><body class=body><div class="container container--outer"><header class=header><div class="container header__container"><div class=logo><a class=logo__link href=/ title="Linux.cn Archive" rel=home><div class="logo__item logo__text"><div class=logo__title>Linux.cn Archive</div></div></a></div><nav class=menu><button class=menu__btn aria-haspopup=true aria-expanded=false tabindex=0>
<span class=menu__btn-title tabindex=-1>Menu</span></button><ul class=menu__list><li class=menu__item><a class=menu__link href=/><span class=menu__text>Home</span></a></li><li class=menu__item><a class=menu__link href=/categories/><span class=menu__text>Categories</span></a></li><li class=menu__item><a class=menu__link href=/tags/><span class=menu__text>Tags</span></a></li><li class=menu__item><a class=menu__link href><span class=menu__text>RSS</span></a></li></ul></nav></div></header><div class="wrapper flex"><div class=primary><main class=main role=main><article class=post><header class=post__header><h1 class=post__title>如何在 Windows 上运行 Linux 容器</h1><div class="post__meta meta"><div class="meta__item-datetime meta__item"><svg class="meta__icon icon icon-time" width="16" height="14" viewBox="0 0 30 28"><path d="M15 0C7 0 1 6 1 14s6 14 14 14 14-6 14-14S23 0 15 0zm0 25C9 25 4 20 4 14S9 3 15 3s11 5 11 11-5 11-11 11zm1-18h-2v8.4l6.8 4.4L22 18l-6-3.8V7z"/></svg><time class=meta__text datetime=2017-09-17T10:56:00Z>September 17, 2017</time></div></div></header><div class="content post__content clearfix"><h3 id=1概述>1、概述</h3><p>现在能够在 Windows 10 和 Windows 服务器上运行 Docker 容器了，它是以 Ubuntu 作为宿主基础的。</p><p>想象一下，使用你喜欢的 Linux 发行版——比如 Ubuntu——在 Windows 上运行你自己的 Linux 应用。</p><p>现在，借助 Docker 技术和 Windows 上的 Hyper-V 虚拟化的力量，这一切成为了可能。</p><p><img src=/data/attachment/album/201709/17/105627lic1ifnc1ellldyq.png alt></p><h3 id=2前置需求>2、前置需求</h3><p>你需要一个 8GB 内存的 64 位 x86 PC，运行 Windows 10 或 Windows Server。</p><p>只有加入了 <a href=https://insider.windows.com/zh-cn/>Windows 预览体验计划（Insider）</a>，才能运行带有 Hyper-V 支持的 Linux 容器。该计划可以让你测试预发布软件和即将发布的 Windows。</p><p>如果你特别在意稳定性和隐私（Windows 预览体验计划允许微软收集使用信息），你可以考虑等待 2017 年 10 月发布的<a href=https://www.microsoft.com/zh-cn/windows/upcoming-features>Windows 10 Fall Creator update</a>，这个版本可以让你无需 Windows 预览体验身份即可使用带有 Hyper-V 支持的 Docker 技术。</p><p>你也需要最新版本的 Docker，它可以从 <a href=http://dockerproject.org/>http://dockerproject.org</a> 下载得到。</p><p>最后，你还需要确认你安装了 <a href=https://tukaani.org/xz/>XZ 工具</a>，解压 Ubuntu 宿主容器镜像时需要它。</p><h3 id=3加入-windows-预览体验计划insider>3、加入 Windows 预览体验计划（Insider）</h3><p>如果你已经是 Windows 预览体验计划（Insider）成员，你可以跳过此步。否则在浏览器中打开如下链接：</p><p><a href=https://insider.windows.com/zh-cn/getting-started/>https://insider.windows.com/zh-cn/getting-started/</a></p><p><img src=/data/attachment/album/201709/17/105628r1f5llb715oe74ev.png alt></p><p>要注册该计划，使用你在 Windows 10 中的微软个人账户登录，并在预览体验计划首页点击“注册”，接受条款并完成注册。</p><p>然后你需要打开 Windows 开始菜单中的“更新和安全”菜单，并在菜单左侧选择“Windows 预览体验计划”。</p><p><img src=/data/attachment/album/201709/17/105629vaj0lxjlisjxbxxi.png alt></p><p>如果需要的话，在 Windows 提示“你的 Windows 预览体验计划账户需要关注”时，点击“修复”按钮。</p><h3 id=4-windows-预览体验insider的内容>4、 Windows 预览体验（Insider）的内容</h3><p>从 Windows 预览体验计划面板，选择“开始使用”。如果你的微软账户没有关联到你的 Windows 10 系统，当提示时使用你要关联的账户进行登录。</p><p>然后你可以选择你希望从 Windows 预览体验计划中收到何种内容。要得到 Docker 技术所需要的 Hyper-V 隔离功能，你需要加入“快圈”，两次确认后，重启 Windows。重启后，你需要等待你的机器安装各种更新后才能进行下一步。</p><p><img src=/data/attachment/album/201709/17/105629f4eztyygtllys353.png alt></p><h3 id=5安装-docker-for-windows>5、安装 Docker for Windows</h3><p>从 <a href=https://store.docker.com/editions/community/docker-ce-desktop-windows>Docker Store</a> 下载 Docker for Windows。</p><p><img src=/data/attachment/album/201709/17/105630dkytkjadteopjkyj.png alt></p><p>下载完成后，安装，并在需要时重启。</p><p><img src=/data/attachment/album/201709/17/105630g593jnjjnsh9zsvd.png alt></p><p>重启后，Docker 就已经启动了。Docker 要求启用 Hyper-V 功能，因此它会提示你启用并重启。点击“OK”来为 Docker 启用它并重启系统。</p><p><img src=/data/attachment/album/201709/17/105631czj3e9y3tt5t99ky.png alt></p><h3 id=6下载-ubuntu-容器镜像>6、下载 Ubuntu 容器镜像</h3><p>从 <a href=https://partner-images.canonical.com/hyper-v/linux-containers/xenial/current/>Canonical 合作伙伴镜像网站</a>下载用于 Windows 的最新的 Ubuntu 容器镜像。</p><p>下载后，使用 XZ 工具解压：</p><pre tabindex=0><code>C:\Users\mathi\&gt; .\xz.exe -d xenial-container-hyper-v.vhdx.xz
C:\Users\mathi\&gt;
</code></pre><h3 id=7准备容器环境>7、准备容器环境</h3><p>首先创建两个目录：</p><p><img src=/data/attachment/album/201709/17/105631e5ifc5qqsb1skk8t.png alt></p><p>创建 <code>C:\lcow</code>*，*它将用于 Docker 准备容器时的临时空间。</p><p><img src=/data/attachment/album/201709/17/105632r3pp4nxx5ixyw6l5.png alt></p><p>再创建一个 <code>C:\Program Files\Linux Containers</code> ，这是存放 Ubuntu 容器镜像的地方。</p><p>你需要给这个目录额外的权限以允许 Docker 在其中使用镜像。在管理员权限的 Powershell 窗口中运行如下 Powershell 脚本：</p><pre tabindex=0><code>param(
[string] $Root
)
# Give the virtual machines group full control
$acl = Get-Acl -Path $Root
$vmGroupRule = new-object System.Security.AccessControl.FileSystemAccessRule(&#34;NT VIRTUAL MACHINE\Virtual Machines&#34;, &#34;FullControl&#34;,&#34;ContainerInherit,ObjectInherit&#34;, &#34;None&#34;, &#34;Allow&#34;)
$acl.SetAccessRule($vmGroupRule)
Set-Acl -AclObject $acl -Path $Root
</code></pre><p>将其保存为<code>set_perms.ps1</code>并运行它。</p><p>提示**，你也许需要运行** <code>Set-ExecutionPolicy -Scope process unrestricted</code> 来允许运行未签名的 Powershell 脚本。</p><p><img src=/data/attachment/album/201709/17/105632ds3k6bsnfeg33nga.png alt></p><pre tabindex=0><code>C:\Users\mathi\&gt; .\set_perms.ps1 &#34;C:\Program Files\Linux Containers&#34;
C:\Users\mathi\&gt;
</code></pre><p>现在，将上一步解压得到的 Ubuntu 容器镜像（.vhdx）复制到 <code>C:\Program Files\Linux Containers</code> 下的 <code>uvm.vhdx</code>。</p><h3 id=8更多的-docker-准备工作>8、更多的 Docker 准备工作</h3><p>Docker for Windows 要求一些预发布的功能才能与 Hyper-V 隔离相配合工作。这些功能在之前的 Docker CE 版本中还不可用，这些所需的文件可以从 <a href=https://master.dockerproject.org/>master.dockerproject.org</a> 下载。</p><p><img src=/data/attachment/album/201709/17/105632min17nhnghyls827.png alt></p><p>从 <a href=https://master.dockerproject.org/>master.dockerproject.org</a> 下载 <code>dockerd.exe</code> 和 <code>docker.exe</code>，并将其放到安全的地方，比如你自己的文件夹中。它们用于在下一步中启动 Ubuntu 容器。</p><h3 id=9-在-hyper-v-上运行-ubuntu-容器>9、 在 Hyper-V 上运行 Ubuntu 容器</h3><p>你现在已经准备好启动你的容器了。首先以管理员身份打开命令行（<code>cmd.exe</code>），然后以正确的环境变量启动 <code>dockerd.exe</code>。</p><pre tabindex=0><code>C:\Users\mathi\&gt; set LCOW_SUPPORTED=1
C:\Users\mathi\&gt; .\dockerd.exe -D --data-root C:\lcow
</code></pre><p>然后，以管理员身份启动 Powershell 窗口，并运行 <code>docker.exe</code> 为你的容器拉取镜像：</p><pre tabindex=0><code>C:\Users\mathi\&gt; .\docker.exe pull ubuntu
</code></pre><p><img src=/data/attachment/album/201709/17/105633miwxzgigxipj6gpq.png alt><img src=/data/attachment/album/201709/17/105634p351gz3sy5g1zzgy.png alt><img src=/data/attachment/album/201709/17/105634uv6sjxloxl0xv6ym.png alt></p><p>现在你终于启动了容器，再次运行 <code>docker.exe</code>，让它运行这个新镜像：</p><pre tabindex=0><code>C:\Users\mathi\&gt; .\docker.exe run -it ubuntu
</code></pre><p><img src=/data/attachment/album/201709/17/105627lic1ifnc1ellldyq.png alt></p><p>恭喜你！你已经成功地在 Windows 上让你的系统运行了带有 Hyper-V 隔离的容器，并且跑的是你非常喜欢的 Ubuntu 容器。</p><h3 id=10获取帮助>10、获取帮助</h3><p>如果你需要一些 Hyper-V Ubuntu 容器的起步指导，或者你遇到一些问题，你可以在这里寻求帮助：</p><ul><li><a href=https://askubuntu.com/>Ask Ubuntu</a></li><li><a href=https://ubuntuforums.org/>Ubuntu Forums</a></li><li><a href=https://wiki.ubuntu.com/IRC/ChannelList>IRC-based support</a></li></ul></div><footer class=post__footer><div class="post__tags tags clearfix"><svg class="tags__badge icon icon-tag" width="16" height="16" viewBox="0 0 32 32"><path d="M32 19c0 1-1 2-1 2L21 31s-1 1-2 1-2-1-2-1L2 16c-1-1-1.4-2-1.4-2S0 12.5.0 11V3C0 1.5.8.8.8.8S1.5.0 3 0h8c1.5.0 3 .6 3 .6S15 1 16 2l15 15s1 1 1 2zM7 10a3 3 0 100-6 3 3 0 000 6z"/></svg><ul class=tags__list><li class=tags__item><a class="tags__link btn" href=/tags/ubuntu/ rel=tag>Ubuntu</a></li><li class=tags__item><a class="tags__link btn" href=/tags/windows/ rel=tag>Windows</a></li><li class=tags__item><a class="tags__link btn" href=/tags/docker/ rel=tag>Docker</a></li></ul></div></footer></article></main></div></div><footer class=footer><div class="container footer__container flex"><div class=footer__copyright>&copy; 2025 Linux.cn Archive.
<span class=footer__copyright-credits>Generated with <a href=https://gohugo.io/ rel="nofollow noopener" target=_blank>Hugo</a> and <a href=https://github.com/Vimux/Mainroad/ rel="nofollow noopener" target=_blank>Mainroad</a> theme.</span></div></div></footer></div><script async defer src=/js/menu.js></script></body></html>