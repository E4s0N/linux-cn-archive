<!doctype html><html class=no-js lang=en><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><title>如何在 Linux 中扩展 Veritas 文件系统（VxFS） - Linux.cn Archive</title>
<script>(function(e,t){e[t]=e[t].replace("no-js","js")})(document.documentElement,"className")</script><meta name=description content><meta property="og:title" content="如何在 Linux 中扩展 Veritas 文件系统（VxFS）"><meta property="og:description" content="扩展 VxFX 文件系统是 Linux/Unix 管理员的一项日常任务"><meta property="og:type" content="article"><meta property="og:url" content="/article-16199-1.html"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-09-17T09:52:25+00:00"><meta property="article:modified_time" content="2023-09-17T09:52:25+00:00"><meta itemprop=name content="如何在 Linux 中扩展 Veritas 文件系统（VxFS）"><meta itemprop=description content="扩展 VxFX 文件系统是 Linux/Unix 管理员的一项日常任务"><meta itemprop=datePublished content="2023-09-17T09:52:25+00:00"><meta itemprop=dateModified content="2023-09-17T09:52:25+00:00"><meta itemprop=wordCount content="366"><meta itemprop=keywords content="VxFX,"><link rel=preconnect href=https://fonts.bunny.net crossorigin><link rel=dns-prefetch href=//fonts.bunny.net><link rel=dns-prefetch href=//fonts.bunny.net><link rel=stylesheet href="https://fonts.bunny.net/css?family=Open+Sans:400,400i,700"><link rel=stylesheet href=/css/style.css><link rel="shortcut icon" href=/favicon.ico></head><body class=body><div class="container container--outer"><header class=header><div class="container header__container"><div class=logo><a class=logo__link href=/ title="Linux.cn Archive" rel=home><div class="logo__item logo__text"><div class=logo__title>Linux.cn Archive</div></div></a></div><nav class=menu><button class=menu__btn aria-haspopup=true aria-expanded=false tabindex=0>
<span class=menu__btn-title tabindex=-1>Menu</span></button><ul class=menu__list><li class=menu__item><a class=menu__link href=/><span class=menu__text>Home</span></a></li><li class=menu__item><a class=menu__link href=/categories/><span class=menu__text>Categories</span></a></li><li class=menu__item><a class=menu__link href=/tags/><span class=menu__text>Tags</span></a></li><li class=menu__item><a class=menu__link href><span class=menu__text>RSS</span></a></li></ul></nav></div></header><div class="wrapper flex"><div class=primary><main class=main role=main><article class=post><header class=post__header><h1 class=post__title>如何在 Linux 中扩展 Veritas 文件系统（VxFS）</h1><div class="post__meta meta"><div class="meta__item-datetime meta__item"><svg class="meta__icon icon icon-time" width="16" height="14" viewBox="0 0 30 28"><path d="M15 0C7 0 1 6 1 14s6 14 14 14 14-6 14-14S23 0 15 0zm0 25C9 25 4 20 4 14S9 3 15 3s11 5 11 11-5 11-11 11zm1-18h-2v8.4l6.8 4.4L22 18l-6-3.8V7z"/></svg><time class=meta__text datetime=2023-09-17T09:52:25Z>September 17, 2023</time></div></div></header><div class="content post__content clearfix"><p><img src=https://img.linux.net.cn/data/attachment/album/202309/17/095154jxqizcscc3xjuzrl.jpg alt></p><p>扩展 VxFX 文件系统是 Linux/Unix 管理员的一项日常任务，可以通过以下文章中描述的几个步骤在线完成此任务：</p><p>在此，磁盘组没有足够的可用空间，因此我们将在现有磁盘组（DG）中添加新磁盘，然后调整其大小。</p><p><strong>相关文章：</strong></p><ul><li><strong><a href=https://www.2daygeek.com/create-vxvm-volume-vxfs-filesystem-linux/>如何在 Linux 中创建 VxVM 卷和文件系统</a></strong></li><li><strong><a href=https://www.2daygeek.com/create-veritas-shared-vxfs-file-system-linux/>如何在 Linux 上创建共享 VxFS 文件系统</a></strong></li></ul><h3 id=步骤-1识别文件系统>步骤 1：识别文件系统</h3><p>使用 <a href=https://www.2daygeek.com/linux-check-disk-space-usage-df-command/>df 命令</a> 检查要增加/扩展的文件系统，并记下以下输出中的磁盘组（DG）和卷名称，稍后在运行 <code>vxdg</code> 和 <code>vxresize</code> 命令时将使用这些名称。</p><pre tabindex=0><code># df -hP /data

Filesystem                  Size  Used Avail Use% Mounted on
/dev/vx/dsk/testdg/testvol  9.0G  8.4G 0.6G  95%  /data
</code></pre><p>根据上面的输出，VxFS 文件系统大小为 9.0 GB，我们希望额外扩展 5 GB 并发布此活动，VxFS 大小将为 14 GB。</p><p>在本例中，DG 名称为 <code>testdg</code>，卷名称为 <code>testvol</code>。</p><h3 id=步骤-2获取新磁盘lun>步骤 2：获取新磁盘/LUN</h3><p>新磁盘必须由存储团队映射到主机，这可能需要 CR 批准，因此提出 CR 并向相关团队添加必要的任务，并且还包括此活动的回滚计划。</p><h3 id=步骤-3扫描磁盘lun>步骤 3：扫描磁盘/LUN</h3><p>存储团队将新 LUN 映射到主机后，获取 LUN id 并将其保存。</p><p>使用以下命令扫描 LUN 以在操作系统级别发现它们。</p><pre tabindex=0><code>for disk_scan in `ls /sys/class/scsi_host`; do 
    echo &#34;Scanning $disk_scan…Completed&#34;
    echo &#34;- - -&#34; &gt; /sys/class/scsi_host/$disk_scan/scan
done
</code></pre><pre tabindex=0><code>Scanning host0...Completed
Scanning host1...Completed
.
.
Scanning host[N]...Completed
</code></pre><p>扫描完成后，使用以下命令查看是否在操作系统级别找到给定的 LUN。</p><pre tabindex=0><code>lsscsi --scsi | grep -i [Last_Five_Digit_of_LUN]
</code></pre><h3 id=步骤-4在-vxvm-中查找磁盘>步骤 4：在 VxVM 中查找磁盘</h3><p>默认情况下，所有可用磁盘对 Veritas 卷管理器（VxVM）都是可见的，可以使用 <code>vxdisk</code> 命令列出这些磁盘，如下所示。</p><pre tabindex=0><code># vxdisk -e list

DEVICE       TYPE           DISK        GROUP        STATUS               OS_NATIVE_NAME   ATTR
emc_01       auto:cdsdisk   disk1       testdg       online               sdd              -
emc_02       auto:cdsdisk   disk2       testdg       online               sde              -
emc_03       auto:none      -           -            online invalid       sdf              -
sda          auto:LVM       -           -            LVM                  sda              -
sdb          auto:LVM       -           -            LVM                  sdb              -
</code></pre><p>磁盘 <code>sdf</code> 的状态显示为 <code>Online invalid</code> 表示该磁盘不受 VxVM 控制。但是，请使用 <code>smartctl</code> 命令仔细检查 LUN id，以确保你选择了正确的磁盘。</p><pre tabindex=0><code>smartctl -a /dev/sd[x]|grep -i unit
</code></pre><p>如果磁盘未填充到 VxVM，请执行以下命令扫描操作系统设备树中的磁盘设备。</p><pre tabindex=0><code>vxdisk scandisks
</code></pre><h3 id=步骤-5在-vxvm-中初始化磁盘>步骤 5：在 VxVM 中初始化磁盘</h3><p>当磁盘在<strong>步骤 4</strong> 中对 VxVM 可见，那么使用 <code>vxdisksetup</code> 命令初始化磁盘，如下所示：</p><pre tabindex=0><code>vxdisksetup -i sdf
</code></pre><p>上面的命令将磁盘 <code>sdf</code> 带到 Veritas 卷管理器（VxVM），并且磁盘状态现在更改为 <code>online</code>。</p><p><img src=https://img.linux.net.cn/data/attachment/album/202309/17/095225ffh9ss4encczrejz.jpg alt></p><h3 id=步骤-6将磁盘添加到-vxvm-中的磁盘组dg>步骤 6：将磁盘添加到 VxVM 中的磁盘组（DG）</h3><p><code>vxdg</code> 命令对磁盘组执行各种管理操作。在此示例中，我们将使用它向现有磁盘组（DG）添加新磁盘。</p><pre tabindex=0><code>vxdg -g [DG_Name] adddisk [Any_Name_to_Disk_as_per_Your_Wish=Device_Name]
</code></pre><pre tabindex=0><code>vxdg -g testdg adddisk disk3=emc_03
</code></pre><p>运行上述命令后，磁盘名称为 <code>disk3</code> 且磁盘组名称为 <code>testdg</code> 已针对 <code>emc_03</code> 设备进行更新 如下所示：</p><pre tabindex=0><code># vxdisk -e list

DEVICE       TYPE           DISK        GROUP        STATUS               OS_NATIVE_NAME   ATTR
emc_01       auto:cdsdisk   disk1       testdg       online               sdd              -
emc_02       auto:cdsdisk   disk2       testdg       online               sde              -
emc_03       auto:none      disk3       testdg       online               sdf              -
sda          auto:LVM       -           -            LVM                  sda              -
sdb          auto:LVM       -           -            LVM                  sdb              -
</code></pre><h3 id=步骤-7检查磁盘组dg中的可用空间>步骤 7：检查磁盘组（DG）中的可用空间</h3><p>要确定连接卷有多少可用空间，请运行：</p><pre tabindex=0><code>vxassist -g testdg maxsize
</code></pre><h3 id=步骤-8扩展-vxvm-卷和-vxfs-文件系统>步骤 8：扩展 VxVM 卷和 VxFS 文件系统</h3><p>我们为此活动添加了 5GB LUN，因此额外扩展了 VxVM 卷和 VxFS 文件系统 <code>5GB</code>，如下所示：</p><pre tabindex=0><code>vxresize -b -g [DG_Name] [Volume_Name] +[Size_to_be_Increased]
</code></pre><pre tabindex=0><code>vxresize -b -g testdg testvol +5g
</code></pre><p>这里：</p><ul><li><code>vxresize</code>：命令</li><li><code>-b</code>：在后台执行调整大小操作（可选）。</li><li><code>-g</code>：将命令的操作限制为给定磁盘组，由磁盘组 ID 或磁盘组名称指定。</li><li><code>testdg</code>：我们的磁盘组（DG）名称</li><li><code>test</code>vol`：我们的卷名称</li><li><code>+5g</code>：此卷将额外增加 5GB。</li></ul><h3 id=步骤-9检查扩展-vxfs-文件系统>步骤 9：检查扩展 VxFS 文件系统</h3><p>最后，使用 <code>df</code> 命令检查 <code>/data</code> 的扩展 VxFS：</p><pre tabindex=0><code># df -hP /data

Filesystem                  Size  Used Avail Use% Mounted on
/dev/vx/dsk/testdg/testvol  14G   8.4G 5.6G  68%  /data
</code></pre><h3 id=总结>总结</h3><p>在本教程中，我们向你展示了如何向现有磁盘组（DG）添加新磁盘，以及如何通过几个简单步骤在 Linux 中扩展 VxVM 卷和 VxFS 文件系统。</p><p>如果你有任何问题或反馈，请随时在下面发表评论。</p><p><em>（题图：MJ/3fe4fdb7-99da-4b8f-a818-0ae232e6fbcc）</em></p><hr><p>via: <a href=https://www.2daygeek.com/extend-increase-vxvm-volume-vxfs-filesystem-linux/>https://www.2daygeek.com/extend-increase-vxvm-volume-vxfs-filesystem-linux/</a></p><p>作者：<a href=https://www.2daygeek.com/author/jayabal/>Jayabal Thiyagarajan</a> 选题：<a href=https://github.com/lujun9972>lujun9972</a> 译者：<a href=https://github.com/geekpi>geekpi</a> 校对：<a href=https://github.com/wxy>wxy</a></p><p>本文由 <a href=https://github.com/LCTT/TranslateProject>LCTT</a> 原创编译，<a href=https://linux.cn/>Linux中国</a> 荣誉推出</p></div><footer class=post__footer><div class="post__tags tags clearfix"><svg class="tags__badge icon icon-tag" width="16" height="16" viewBox="0 0 32 32"><path d="M32 19c0 1-1 2-1 2L21 31s-1 1-2 1-2-1-2-1L2 16c-1-1-1.4-2-1.4-2S0 12.5.0 11V3C0 1.5.8.8.8.8S1.5.0 3 0h8c1.5.0 3 .6 3 .6S15 1 16 2l15 15s1 1 1 2zM7 10a3 3 0 100-6 3 3 0 000 6z"/></svg><ul class=tags__list><li class=tags__item><a class="tags__link btn" href=/tags/vxfx/ rel=tag>VxFX</a></li></ul></div></footer></article></main></div></div><footer class=footer><div class="container footer__container flex"><div class=footer__copyright>&copy; 2025 Linux.cn Archive.
<span class=footer__copyright-credits>Generated with <a href=https://gohugo.io/ rel="nofollow noopener" target=_blank>Hugo</a> and <a href=https://github.com/Vimux/Mainroad/ rel="nofollow noopener" target=_blank>Mainroad</a> theme.</span></div></div></footer></div><script async defer src=/js/menu.js></script></body></html>