<!doctype html><html class=no-js lang=en><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><title>配置 Linux 的访问控制列表(ACL) - Linux.cn Archive</title>
<script>(function(e,t){e[t]=e[t].replace("no-js","js")})(document.documentElement,"className")</script><meta name=description content><meta property="og:title" content="配置 Linux 的访问控制列表(ACL)"><meta property="og:description" content="使用拥有权限控制的Liunx，工作是一件轻松的任务。它可以定义任何user,group和other的权限。无论是在桌面电脑或者不会有很多用户的虚拟Linux实例，或者当用户不愿意分享他们之间的文件时，这样的工作是很棒的。然而，如果你是在一个大型组织，你运行了NFS或者Samba服务给不同的用户，然后你将会需要灵活的挑选并设置很多复杂的配置和权限去满足你的组织不同的需求。  Linux（和其他Unix等POSIX兼容的操作系统）有一种被称为访问控制列表(ACL)的权限控制方法，它是一种权限分配之外的普遍范式。例如，默认情况下你需要确认3个权限组：owner"><meta property="og:type" content="article"><meta property="og:url" content="/article-3966-1.html"><meta property="article:section" content="posts"><meta property="article:published_time" content="2014-10-07T20:47:45+00:00"><meta property="article:modified_time" content="2014-10-07T20:47:45+00:00"><meta itemprop=name content="配置 Linux 的访问控制列表(ACL)"><meta itemprop=description content="使用拥有权限控制的Liunx，工作是一件轻松的任务。它可以定义任何user,group和other的权限。无论是在桌面电脑或者不会有很多用户的虚拟Linux实例，或者当用户不愿意分享他们之间的文件时，这样的工作是很棒的。然而，如果你是在一个大型组织，你运行了NFS或者Samba服务给不同的用户，然后你将会需要灵活的挑选并设置很多复杂的配置和权限去满足你的组织不同的需求。  Linux（和其他Unix等POSIX兼容的操作系统）有一种被称为访问控制列表(ACL)的权限控制方法，它是一种权限分配之外的普遍范式。例如，默认情况下你需要确认3个权限组：owner"><meta itemprop=datePublished content="2014-10-07T20:47:45+00:00"><meta itemprop=dateModified content="2014-10-07T20:47:45+00:00"><meta itemprop=wordCount content="117"><meta itemprop=keywords content="ACL,权限,文件系统,"><link rel=preconnect href=https://fonts.bunny.net crossorigin><link rel=dns-prefetch href=//fonts.bunny.net><link rel=dns-prefetch href=//fonts.bunny.net><link rel=stylesheet href="https://fonts.bunny.net/css?family=Open+Sans:400,400i,700"><link rel=stylesheet href=/css/style.css><link rel="shortcut icon" href=/favicon.ico></head><body class=body><div class="container container--outer"><header class=header><div class="container header__container"><div class=logo><a class=logo__link href=/ title="Linux.cn Archive" rel=home><div class="logo__item logo__text"><div class=logo__title>Linux.cn Archive</div></div></a></div><nav class=menu><button class=menu__btn aria-haspopup=true aria-expanded=false tabindex=0>
<span class=menu__btn-title tabindex=-1>Menu</span></button><ul class=menu__list><li class=menu__item><a class=menu__link href=/><span class=menu__text>Home</span></a></li><li class=menu__item><a class=menu__link href=/categories/><span class=menu__text>Categories</span></a></li><li class=menu__item><a class=menu__link href=/tags/><span class=menu__text>Tags</span></a></li><li class=menu__item><a class=menu__link href><span class=menu__text>RSS</span></a></li></ul></nav></div></header><div class="wrapper flex"><div class=primary><main class=main role=main><article class=post><header class=post__header><h1 class=post__title>配置 Linux 的访问控制列表(ACL)</h1><div class="post__meta meta"><div class="meta__item-datetime meta__item"><svg class="meta__icon icon icon-time" width="16" height="14" viewBox="0 0 30 28"><path d="M15 0C7 0 1 6 1 14s6 14 14 14 14-6 14-14S23 0 15 0zm0 25C9 25 4 20 4 14S9 3 15 3s11 5 11 11-5 11-11 11zm1-18h-2v8.4l6.8 4.4L22 18l-6-3.8V7z"/></svg><time class=meta__text datetime=2014-10-07T20:47:45Z>October 07, 2014</time></div></div></header><div class="content post__content clearfix"><p>使用拥有权限控制的Liunx，工作是一件轻松的任务。它可以定义任何user,group和other的权限。无论是在桌面电脑或者不会有很多用户的虚拟Linux实例，或者当用户不愿意分享他们之间的文件时，这样的工作是很棒的。然而，如果你是在一个大型组织，你运行了NFS或者Samba服务给不同的用户，然后你将会需要灵活的挑选并设置很多复杂的配置和权限去满足你的组织不同的需求。</p><p><img src=/data/attachment/album/201410/07/204750yyt9oin8pqpinsge.jpg alt></p><p>Linux（和其他Unix等POSIX兼容的操作系统）有一种被称为访问控制列表(ACL)的权限控制方法，它是一种权限分配之外的普遍范式。例如，默认情况下你需要确认3个权限组：owner、group和other。而使用ACL，你可以增加权限给其他用户或组别，而不单只是简单的"other"或者是拥有者不存在的组别。可以允许指定的用户A、B、C拥有写权限而不再是让他们整个组拥有写权限。</p><p>ACL支持多种Linux文件系统，包括ext2, ext3, ext4, XFS, Btfrs, 等。如果你不确定你的文件系统是否支持ACL，请参考文档。</p><h3 id=在文件系统使acl生效>在文件系统使ACL生效</h3><p>首先，我们需要安装工具来管理ACL。</p><p>Ubuntu/Debian 中:</p><pre tabindex=0><code>$ sudo apt-get install acl
</code></pre><p>CentOS/Fedora/RHEL 中:</p><pre tabindex=0><code># yum -y install acl
</code></pre><p>Archlinux 中:</p><pre tabindex=0><code># pacman -S acl
</code></pre><p>出于演示目的，我将使用ubuntu server版本，其他版本类似。</p><p>安装ACL完成后，需要激活我们磁盘分区的ACL功能，这样我们才能使用它。</p><p>首先，我们检查ACL功能是否已经开启。</p><pre tabindex=0><code>$ mount
</code></pre><p><img src=/data/attachment/album/201410/07/204753evycy9cfry8z8cyr.jpg alt></p><p>你可以注意到，我的root分区中ACL属性已经开启。万一你没有开启，你需要编辑/etc/fstab文件，在你需要开启ACL的分区的选项前增加acl标记。</p><p><img src=/data/attachment/album/201410/07/204404oa8gsl6d6dgsjpl6.jpg alt></p><p>现在我们需要重新挂载分区（我喜欢完全重启，因为我不想丢失数据），如果你对其它分区开启ACL，你必须也重新挂载它。</p><pre tabindex=0><code>$ sudo mount / -o remount
</code></pre><p>干的不错！现在我们已经在我们的系统中开启ACL，让我们开始和它一起工作。</p><h3 id=acl-范例>ACL 范例</h3><p>基础ACL通过两条命令管理：<strong>setfacl</strong>用于增加或者修改ACL，<strong>getfacl</strong>用于显示分配完的ACL。让我们来做一些测试。</p><p>我创建一个目录/shared给一个假设的用户，名叫freeuser</p><pre tabindex=0><code>$ ls -lh /
</code></pre><p><img src=/data/attachment/album/201410/07/204756oxx3y1jh5z6z5j88.jpg alt></p><p>我想要分享这个目录给其他两个用户test和test2，一个拥有完整权限，另一个只有读权限。</p><p>首先，为用户test设置ACL：</p><pre tabindex=0><code>$ sudo setfacl -m u:test:rwx /shared
</code></pre><p>现在用户test可以随意创建文件夹，文件和访问在/shared目录下的任何地方。</p><p><img src=/data/attachment/album/201410/07/204758kgdg88i7ugy6eudy.jpg alt></p><p>现在我们增加只读权限给用户test2:</p><pre tabindex=0><code>$ sudo setfacl -m u:test2:rx /shared
</code></pre><p>注意test2读取目录需要执行(x)权限</p><p><img src=/data/attachment/album/201410/07/204759rdxji39gq5p3cdni.jpg alt></p><p>让我来解释下setfacl命令格式：</p><ul><li><strong>-m</strong> 表示修改ACL。你可以增加新的，或修改存在的ACL</li><li><strong>u:</strong> 表示用户。你可以使用 <strong>g</strong> 来设置组权限</li><li><strong>test</strong> 用户名</li><li><strong>:rwx</strong> 需要设置的权限。</li></ul><p>现在让我向你展示如何读取ACL：</p><pre tabindex=0><code>$ ls -lh /shared
</code></pre><p><img src=/data/attachment/album/201410/07/204445murozr1rhnllt96e.jpg alt></p><p>你可以注意到，正常权限后多一个+标记。这表示ACL已经设置成功。要具体看一下ACL，我们需要运行：</p><pre tabindex=0><code>$ sudo getfacl /shared
</code></pre><p><img src=/data/attachment/album/201410/07/204801gthgg8yqq8tq9ttc.jpg alt></p><p>最后，如果你需要移除ACL：</p><pre tabindex=0><code>$ sudo setfacl -x u:test /shared
</code></pre><p><img src=/data/attachment/album/201410/07/204803kdqdq99t4gpqkq94.jpg alt></p><p>如果你想要立即擦除所有ACL条目：</p><pre tabindex=0><code>$ sudo setfacl -b /shared
</code></pre><p><img src=/data/attachment/album/201410/07/204805n2s88w4418t64zrg.jpg alt></p><p>最后，在设置了ACL文件或目录工作时，cp和mv命令会改变这些设置。在cp的情况下,需要添加“p”参数来复制ACL设置。如果这不可行，它将会展示一个警告。mv默认移动ACL设置，如果这也不可行，它也会向您展示一个警告。</p><h3 id=总结>总结</h3><p>使用ACL让在你想要分享的文件上拥有更多的能力和控制，特别是在NFS/Samba服务。此外，如果你的主管共享主机，这个工具是必备的。</p><hr><p>via: <a href=http://xmodulo.com/2014/08/configure-access-control-lists-acls-linux.html>http://xmodulo.com/2014/08/configure-access-control-lists-acls-linux.html</a></p><p>作者：<a href=http://xmodulo.com/author/valerio>Christopher Valerio</a> 译者：<a href=http://www.vicyu.net>VicYu</a> 校对：<a href=https://github.com/wxy>wxy</a></p><p>本文由 <a href=https://github.com/LCTT/TranslateProject>LCTT</a> 原创翻译，<a href=http://linux.cn/>Linux中国</a> 荣誉推出</p></div><footer class=post__footer><div class="post__tags tags clearfix"><svg class="tags__badge icon icon-tag" width="16" height="16" viewBox="0 0 32 32"><path d="M32 19c0 1-1 2-1 2L21 31s-1 1-2 1-2-1-2-1L2 16c-1-1-1.4-2-1.4-2S0 12.5.0 11V3C0 1.5.8.8.8.8S1.5.0 3 0h8c1.5.0 3 .6 3 .6S15 1 16 2l15 15s1 1 1 2zM7 10a3 3 0 100-6 3 3 0 000 6z"/></svg><ul class=tags__list><li class=tags__item><a class="tags__link btn" href=/tags/acl/ rel=tag>ACL</a></li><li class=tags__item><a class="tags__link btn" href=/tags/%E6%9D%83%E9%99%90/ rel=tag>权限</a></li><li class=tags__item><a class="tags__link btn" href=/tags/%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/ rel=tag>文件系统</a></li></ul></div></footer></article></main></div></div><footer class=footer><div class="container footer__container flex"><div class=footer__copyright>&copy; 2025 Linux.cn Archive.
<span class=footer__copyright-credits>Generated with <a href=https://gohugo.io/ rel="nofollow noopener" target=_blank>Hugo</a> and <a href=https://github.com/Vimux/Mainroad/ rel="nofollow noopener" target=_blank>Mainroad</a> theme.</span></div></div></footer></div><script async defer src=/js/menu.js></script></body></html>