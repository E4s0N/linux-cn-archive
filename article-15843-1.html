<!doctype html><html class=no-js lang=en><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><title>如何在 Rocky Linux 9 / AlmaLinux 9 上安装 KVM - Linux.cn Archive</title>
<script>(function(e,t){e[t]=e[t].replace("no-js","js")})(document.documentElement,"className")</script><meta name=description content><meta property="og:title" content="如何在 Rocky Linux 9 / AlmaLinux 9 上安装 KVM"><meta property="og:description" content="在本指南中，我们演示了如何在 Rocky Linux 9 / Alma Linux 9 上安装 KVM。"><meta property="og:type" content="article"><meta property="og:url" content="/article-15843-1.html"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-05-25T15:59:00+00:00"><meta property="article:modified_time" content="2023-05-25T15:59:00+00:00"><meta itemprop=name content="如何在 Rocky Linux 9 / AlmaLinux 9 上安装 KVM"><meta itemprop=description content="在本指南中，我们演示了如何在 Rocky Linux 9 / Alma Linux 9 上安装 KVM。"><meta itemprop=datePublished content="2023-05-25T15:59:00+00:00"><meta itemprop=dateModified content="2023-05-25T15:59:00+00:00"><meta itemprop=wordCount content="442"><meta itemprop=keywords content="KVM,"><link rel=preconnect href=https://fonts.bunny.net crossorigin><link rel=dns-prefetch href=//fonts.bunny.net><link rel=dns-prefetch href=//fonts.bunny.net><link rel=stylesheet href="https://fonts.bunny.net/css?family=Open+Sans:400,400i,700"><link rel=stylesheet href=/css/style.css><link rel="shortcut icon" href=/favicon.ico></head><body class=body><div class="container container--outer"><header class=header><div class="container header__container"><div class=logo><a class=logo__link href=/ title="Linux.cn Archive" rel=home><div class="logo__item logo__text"><div class=logo__title>Linux.cn Archive</div></div></a></div><nav class=menu><button class=menu__btn aria-haspopup=true aria-expanded=false tabindex=0>
<span class=menu__btn-title tabindex=-1>Menu</span></button><ul class=menu__list><li class=menu__item><a class=menu__link href=/><span class=menu__text>Home</span></a></li><li class=menu__item><a class=menu__link href=/categories/><span class=menu__text>Categories</span></a></li><li class=menu__item><a class=menu__link href=/tags/><span class=menu__text>Tags</span></a></li><li class=menu__item><a class=menu__link href><span class=menu__text>RSS</span></a></li></ul></nav></div></header><div class="wrapper flex"><div class=primary><main class=main role=main><article class=post><header class=post__header><h1 class=post__title>如何在 Rocky Linux 9 / AlmaLinux 9 上安装 KVM</h1><div class="post__meta meta"><div class="meta__item-datetime meta__item"><svg class="meta__icon icon icon-time" width="16" height="14" viewBox="0 0 30 28"><path d="M15 0C7 0 1 6 1 14s6 14 14 14 14-6 14-14S23 0 15 0zm0 25C9 25 4 20 4 14S9 3 15 3s11 5 11 11-5 11-11 11zm1-18h-2v8.4l6.8 4.4L22 18l-6-3.8V7z"/></svg><time class=meta__text datetime=2023-05-25T15:59:00Z>May 25, 2023</time></div></div></header><div class="content post__content clearfix"><p><img src=https://img.linux.net.cn/data/attachment/album/202305/25/155857v1e939ckoj3eaxe3.jpg alt></p><blockquote><p>在本指南中，我们演示了如何在 Rocky Linux 9 / Alma Linux 9 上安装 KVM。</p></blockquote><p>KVM 是 内核虚拟机 Kernel Virtualization Machine 的简称，是一个为 Linux 内核设计的开源虚拟化平台。它是一种 1 类管理程序，或通常称为裸机管理程序。它允许用户创建和管理多台客户机，这些可以在 Linux 或 Windows 操作系统中创建。</p><p>与大多数虚拟化平台一样，它将硬件资源（如 CPU、内存、存储、网络、图形等）抽象化，并将它们分配给独立于宿主机运行的客户机。</p><h3 id=先决条件>先决条件</h3><ul><li>预装 Rocky Linux 9 / AlmaLinux 9</li><li>具有管理员权限的 sudo 用户</li><li>互联网连接</li></ul><h3 id=1验证是否启用了硬件虚拟化>1、验证是否启用了硬件虚拟化</h3><p>首先，你需要验证你的系统是否启用了虚拟化功能。在大多数现代系统上，此功能已在 BIOS 中启用。但可以肯定的是，你可以验证是否如图所示启用了虚拟化。</p><p>该命令探测是否存在 VMX（ 虚拟机扩展 Virtual Machine Extension ），它是英特尔硬件虚拟化的 CPU 标志，或 SVM，它是 AMD 硬件虚拟化的标志。</p><pre tabindex=0><code>$ cat /proc/cpuinfo | egrep &#34;vmx|svm&#34;
</code></pre><p>从以下输出中，你可以看到我们的系统启用了英特尔硬件虚拟化：</p><p><img src=https://img.linux.net.cn/data/attachment/album/202305/25/160235mterwfxif5eezrrx.jpg alt></p><h3 id=2在-rocky-linux-9--almalinux-9-上安装-kvm>2、在 Rocky Linux 9 / AlmaLinux 9 上安装 KVM</h3><p>确保启用虚拟化后，下一步就是安装 KVM 和管理工具。为此，请运行以下 <code>dnf</code> 命令。</p><pre tabindex=0><code>$ sudo dnf install qemu-kvm virt-manager libvirt virt-install virt-viewer virt-top bridge-utils  bridge-utils virt-top libguestfs-tools -y
</code></pre><p><img src=https://img.linux.net.cn/data/attachment/album/202305/25/160242b3dyjj3xc3d8s2h5.jpg alt></p><p>安装完成后，运行以下命令检查是否已加载所需的 KVM 模块。</p><pre tabindex=0><code>$ lsmod | grep kvm
</code></pre><p>你应该得到以下输出以确认已加载必要的模块：</p><p><img src=https://img.linux.net.cn/data/attachment/album/202305/25/160249fojj180t7asyyy6o.jpg alt></p><h3 id=3启动并启用-libvirtd-守护进程>3、启动并启用 libvirtd 守护进程</h3><p>在下一步中，一定要启动 libvirtd 守护进程。这是一个服务器端守护程序组件，可在虚拟化的客户机上运行和管理任务。它用于管理虚拟化技术，例如 Xen、KVM 和 ESXi 等等。</p><p>要启动 libvirtd 守护进程，请运行以下命令：</p><pre tabindex=0><code>$ sudo systemctl start libvirtd
</code></pre><p>请务必启用该服务以在引导时启动：</p><pre tabindex=0><code>$ sudo systemctl enable --now libvirtd
</code></pre><p>验证 libvirtd 守护进程是否正在运行，如下所示：</p><pre tabindex=0><code>$ sudo systemctl status libvirtd
</code></pre><p><img src=https://img.linux.net.cn/data/attachment/album/202305/25/160256t7vsaj7dlgppygop.jpg alt></p><h3 id=4设置桥接接口>4、设置桥接接口</h3><p>到目前为止，我们已经安装了 KVM 和所有管理工具，事实上，我们可以继续启动虚拟机。但是，如果我们可以从管理程序网络外部访问虚拟机，那就太好了。为此，我们需要创建一个桥接接口。</p><p>首先，确定系统上的网络接口。</p><pre tabindex=0><code>$ sudo nmcli connection show
</code></pre><p>从输出来看，<code>ens160</code> 是活动的网络接口，请务必注意你的情况下的接口，因为你将一路使用它。</p><p><img src=https://img.linux.net.cn/data/attachment/album/202305/25/160304jkfynx9d9xys39y3.jpg alt></p><p>要开始创建网桥，首先，使用以下语法用其 UUID 删除连接：</p><pre tabindex=0><code>$ sudo nmcli connection delete UUID
</code></pre><p>在我们的例子中，命令将是：</p><pre tabindex=0><code>$ sudo nmcli connection delete 19e98123-9a84-30a6-bc59-a7134446bb26
</code></pre><p>你将收到连接已成功删除的确认信息。</p><p><img src=https://img.linux.net.cn/data/attachment/album/202305/25/160315n1uf7r7si8fi67sm.jpg alt></p><p>在继续进行之前，最好准备好以下详细信息：</p><ul><li>网桥名称 – 新网桥的首选名称（例如 <code>br1</code>）</li><li>设备名称 – 这是你的网络接口的名称。它将作为网桥的从属设备（例如，<code>ens160</code>）</li><li>IP 地址/子网 – 桥接网络的 IP 地址和子网（例如 <code>192.168.2.50/24</code>）。请注意，这应该与你的网络子网和 IP 地址相对应。</li><li>网关 – 你网络的默认网关地址（例如 <code>192.168.2.1</code>）</li><li>DNS1 和 DNS2 – 首选 DNS 地址（例如 <code>8.8.8.8</code> 和 <code>8.8.4.4</code>）</li></ul><p>继续，使用以下语法创建一个新的桥接接口。</p><pre tabindex=0><code>$ sudo nmcli connection add type bridge autoconnect yes con-name BRIDGE NAME ifname BRIDGE NAME
</code></pre><p>在我们的例子中，<code>br1</code> 是首选的网桥接口名称。因此，命令将如图所示：</p><pre tabindex=0><code>$ sudo nmcli connection add type bridge autoconnect yes con-name br1 ifname br1
</code></pre><p><img src=https://img.linux.net.cn/data/attachment/album/202305/25/160324tbvbin1ainv7ku1z.jpg alt></p><p>在接下来的步骤中，你将通过指定 IP 子网、网关和 DNS 值来修改网桥。</p><p>首先使用以下语法指定 IP 子网：</p><pre tabindex=0><code>$ sudo nmcli connection modify BRIDGE NAME ipv4.addresses IP ADDRESS/SUBNET ipv4.method manual
</code></pre><p>根据我们的设置，命令将是：</p><pre tabindex=0><code>$ sudo nmcli connection modify br1 ipv4.addresses 192.168.2.150/24 ipv4.method manual
</code></pre><p>接下来，使用以下语法指定网关地址：</p><pre tabindex=0><code>$ sudo nmcli connection modify BRIDGE NAME ipv4.gateway GATEWAY
</code></pre><p>根据我们的网络，该命令采用以下格式：</p><pre tabindex=0><code>$ sudo nmcli connection modify br1 ipv4.gateway 192.168.2.1
</code></pre><p>DNS 地址的语法如下：</p><pre tabindex=0><code>$ sudo nmcli connection modify BRIDGE NAME ipv4.dns DNS1 +ipv4.dns DNS2
</code></pre><p>该命令采用以下格式：</p><pre tabindex=0><code>$ sudo nmcli connection modify br1 ipv4.dns 8.8.8.8 +ipv4.dns 8.8.4.4
</code></pre><p><img src=https://img.linux.net.cn/data/attachment/album/202305/25/160339zcc2vhcc2h61kzxx.jpg alt></p><p>此后，使用以下命令添加网桥从属设备：</p><pre tabindex=0><code>$ sudo nmcli connection add type bridge-slave autoconnect yes con-name DEVICE NAME ifname DEVICE NAME master BRIDGE NAME
</code></pre><p>使用我们的值，命令如图所示：</p><pre tabindex=0><code>$ sudo nmcli connection add type bridge-slave autoconnect yes con-name ens160 ifname ens160 master br1
</code></pre><p>你将收到以下确认信息，表明已成功添加网桥从属设备。请记住，桥接从属设备是你的网络接口或适配器。</p><p><img src=https://img.linux.net.cn/data/attachment/album/202305/25/160349a4hzz16xzzqq1mx0.jpg alt></p><p>要确认网桥已创建，请运行以下命令：</p><pre tabindex=0><code>$ sudo nmcli connection show
</code></pre><p>从输出中，你可以看到列出了网桥接口。</p><p><img src=https://img.linux.net.cn/data/attachment/album/202305/25/160401o83frylp6rohplot.jpg alt></p><p>激要活它，请运行以下命令：</p><pre tabindex=0><code>$ sudo nmcli connection up br1
</code></pre><p><img src=https://img.linux.net.cn/data/attachment/album/202305/25/160410eqa68k8la88igrws.jpg alt></p><p>此外，你可以使用 <code>ip addr</code> 命令验证：</p><pre tabindex=0><code>$ ip addr | grep br1
</code></pre><p><img src=https://img.linux.net.cn/data/attachment/album/202305/25/160419b0r9rxd7v1ozydze.jpg alt></p><p>最后，编辑网桥配置文件。</p><pre tabindex=0><code>$ sudo vi /etc/qemu-kvm/bridge.conf
</code></pre><p>添加以下行：</p><pre tabindex=0><code>allow all
</code></pre><p>然后重新启动虚拟化守护进程以应用更改</p><pre tabindex=0><code>$ sudo systemctl restart libvirtd
</code></pre><h3 id=5创建虚拟机>5、创建虚拟机</h3><p>安装 KVM 并配置桥接连接后，现在让我们创建一个虚拟机。在执行之前，为登录用户分配必要的所有权，以便在不切换到 root 的情况下运行命令。</p><pre tabindex=0><code>$ sudo chown -R $USER:libvirt /var/lib/libvirt/
</code></pre><p>在命令行上，我们将使用以下语法使用 Ubuntu 20.04 ISO 镜像创建虚拟机。</p><pre tabindex=0><code>$ virt-install \
    --name Ubuntu \
    --ram 2048 \
    --vcpus 2 \
    --disk path=/var/lib/libvirt/images/ubuntu-20.04.img,size=15 \
    --os-variant ubuntu20.04 \
    --network bridge=br1,model=virtio \
    --graphics vnc,listen=0.0.0.0 \
    --console pty,target_type=serial \
    --cdrom /home/linuxtechi/Downloads/ubuntu-20.04.4-desktop-amd64.iso
</code></pre><p><img src=https://img.linux.net.cn/data/attachment/album/202305/25/160430tslv6t61s2wlulxs.jpg alt></p><p>执行该命令后，将启动图形屏幕会话，并开始安装客户操作系统。</p><p><img src=https://img.linux.net.cn/data/attachment/album/202305/25/160439bb6fdggaf60dbr88.jpg alt></p><p><img src=https://img.linux.net.cn/data/attachment/album/202305/25/160452snhizitui7v0ivwp.jpg alt></p><h3 id=总结>总结</h3><p>我们关于如何在 Rocky Linux 9 / AlmaLinux 9 上安装 KVM 的文章到此结束，非常欢迎你提供反馈。</p><p><em>（题图：MJ/a364d6e3-0c59-4be8-bf02-5df078359429）</em></p><hr><p>via: <a href=https://www.linuxtechi.com/install-kvm-on-rocky-linux-almalinux/>https://www.linuxtechi.com/install-kvm-on-rocky-linux-almalinux/</a></p><p>作者：<a href=https://www.linuxtechi.com/author/pradeep/>Pradeep Kumar</a> 选题：<a href=https://github.com/lkxed/>lkxed</a> 译者：<a href=https://github.com/geekpi>geekpi</a> 校对：<a href=https://github.com/wxy>wxy</a></p><p>本文由 <a href=https://github.com/LCTT/TranslateProject>LCTT</a> 原创编译，<a href=https://linux.cn/>Linux中国</a> 荣誉推出</p></div><footer class=post__footer><div class="post__tags tags clearfix"><svg class="tags__badge icon icon-tag" width="16" height="16" viewBox="0 0 32 32"><path d="M32 19c0 1-1 2-1 2L21 31s-1 1-2 1-2-1-2-1L2 16c-1-1-1.4-2-1.4-2S0 12.5.0 11V3C0 1.5.8.8.8.8S1.5.0 3 0h8c1.5.0 3 .6 3 .6S15 1 16 2l15 15s1 1 1 2zM7 10a3 3 0 100-6 3 3 0 000 6z"/></svg><ul class=tags__list><li class=tags__item><a class="tags__link btn" href=/tags/kvm/ rel=tag>KVM</a></li></ul></div></footer></article></main></div></div><footer class=footer><div class="container footer__container flex"><div class=footer__copyright>&copy; 2025 Linux.cn Archive.
<span class=footer__copyright-credits>Generated with <a href=https://gohugo.io/ rel="nofollow noopener" target=_blank>Hugo</a> and <a href=https://github.com/Vimux/Mainroad/ rel="nofollow noopener" target=_blank>Mainroad</a> theme.</span></div></div></footer></div><script async defer src=/js/menu.js></script></body></html>