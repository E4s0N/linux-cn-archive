<!doctype html><html class=no-js lang=en><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><title>如何使用机器学习来分析情感 - Linux.cn Archive</title>
<script>(function(e,t){e[t]=e[t].replace("no-js","js")})(document.documentElement,"className")</script><meta name=description content><meta property="og:title" content="如何使用机器学习来分析情感"><meta property="og:description" content="本文将帮助你理解情感分析的概念，并且学习如何使用机器学习进行情感分析。"><meta property="og:type" content="article"><meta property="og:url" content="/article-15504-1.html"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-02-03T11:22:59+00:00"><meta property="article:modified_time" content="2023-02-03T11:22:59+00:00"><meta itemprop=name content="如何使用机器学习来分析情感"><meta itemprop=description content="本文将帮助你理解情感分析的概念，并且学习如何使用机器学习进行情感分析。"><meta itemprop=datePublished content="2023-02-03T11:22:59+00:00"><meta itemprop=dateModified content="2023-02-03T11:22:59+00:00"><meta itemprop=wordCount content="306"><meta itemprop=keywords content="情感分析,机器学习,"><link rel=preconnect href=https://fonts.bunny.net crossorigin><link rel=dns-prefetch href=//fonts.bunny.net><link rel=dns-prefetch href=//fonts.bunny.net><link rel=stylesheet href="https://fonts.bunny.net/css?family=Open+Sans:400,400i,700"><link rel=stylesheet href=/css/style.css><link rel="shortcut icon" href=/favicon.ico></head><body class=body><div class="container container--outer"><header class=header><div class="container header__container"><div class=logo><a class=logo__link href=/ title="Linux.cn Archive" rel=home><div class="logo__item logo__text"><div class=logo__title>Linux.cn Archive</div></div></a></div><nav class=menu><button class=menu__btn aria-haspopup=true aria-expanded=false tabindex=0>
<span class=menu__btn-title tabindex=-1>Menu</span></button><ul class=menu__list><li class=menu__item><a class=menu__link href=/><span class=menu__text>Home</span></a></li><li class=menu__item><a class=menu__link href=/categories/><span class=menu__text>Categories</span></a></li><li class=menu__item><a class=menu__link href=/tags/><span class=menu__text>Tags</span></a></li><li class=menu__item><a class=menu__link href><span class=menu__text>RSS</span></a></li></ul></nav></div></header><div class="wrapper flex"><div class=primary><main class=main role=main><article class=post><header class=post__header><h1 class=post__title>如何使用机器学习来分析情感</h1><div class="post__meta meta"><div class="meta__item-datetime meta__item"><svg class="meta__icon icon icon-time" width="16" height="14" viewBox="0 0 30 28"><path d="M15 0C7 0 1 6 1 14s6 14 14 14 14-6 14-14S23 0 15 0zm0 25C9 25 4 20 4 14S9 3 15 3s11 5 11 11-5 11-11 11zm1-18h-2v8.4l6.8 4.4L22 18l-6-3.8V7z"/></svg><time class=meta__text datetime=2023-02-03T11:22:59Z>February 03, 2023</time></div></div></header><div class="content post__content clearfix"><p><img src=https://img.linux.net.cn/data/attachment/album/202302/03/112201q909lsqqs9e0jjzc.jpg alt></p><p>本文将帮助你理解 情感分析 sentiment analysis 的概念，并且学习如何使用机器学习进行情感分析。我们使用了不同的机器学习算法进行情感分析，然后将各个算法的准确率结果进行比较，以确定哪一种算法最适合这个问题。</p><p>情感分析是自然语言处理（NLP）中的一个重要的内容。情感指的是我们对某一事件、物品、情况或事物产生的感觉。情感分析是一个从文本中自动提取人类情感的研究领域。它在上世纪 90 年代初才慢慢地开始发展起来。</p><p>本文将让你明白如何将机器学习（ML）用于情感分析，并比较不同机器学习算法的结果。本文的目标不在于研究如何提高算法性能。</p><p>如今，我们生活在一个快节奏的社会中，所有的商品都能在网上购买到，每个人都可以在网上发表自己的评论。而一些商品的负面网络评论可能会损害公司的声誉，从而影响公司的销售额。因此对公司来说，通过商品评论来了解客户真正想要什么变得非常重要。但是这些评论数据太多了，无法一个个地手动查看所有的评论。这就是情绪分析诞生的缘由。</p><p>现在，就让我们看看如何用机器学习开发一个模型，来进行基本的情绪分析吧。</p><h3 id=现在就开始吧>现在就开始吧！</h3><h4 id=获取数据>获取数据</h4><p>第一步是选择一个数据集。你可以从任何公开的评论中进行选择，例如推文或电影评论。数据集中至少要包含两列：标签和实际的文本段。</p><p>下图显示了我们选取的部分数据集。</p><p><img src=https://img.linux.net.cn/data/attachment/album/202302/03/112300bjhjhs0u5pjop58n.jpg alt="Figure 1: Data sample"></p><p>接下来，我们导入所需的库：</p><pre tabindex=0><code>import pandas as pd
import numpy as np
from nltk.stem.porter import PorterStemmer
import re
import string
</code></pre><p>正如你在上面代码看到，我们导入了 <code>NumPy</code> 和 <code>Pandas</code> 库来处理数据。至于其他库，我们会在使用到它们时再说明。</p><p>数据集已准备就绪，并且已导入所需的库。接着，我们需要用 <code>Pandas</code> 库将数据集读入到我们的项目中去。我们使用以下的代码将数据集读入 Pandas 数据帧 DataFrame 类型：</p><pre tabindex=0><code>sentiment_dataframe = pd.read_csv(“/content/drive/MyDrive/Data/sentiments - sentiments.tsv”,sep = ‘\t’)
</code></pre><h4 id=数据处理>数据处理</h4><p>现在我们的项目中已经导入好数据集了。然后，我们要对数据进行处理，以便算法可以更好地理解数据集的特征。我们首先为数据集中的列命名，通过下面的代码来完成：</p><pre tabindex=0><code>sentiment_dataframe.columns = [“label”,”body_text”]
</code></pre><p>然后，我们对 <code>label</code> 列进行数值化：<code>negative</code> 的评论替换为 1，<code>positive</code> 的评论替换为 0。下图显示了经过基本修改后的 <code>sentiment_dataframe</code> 的值。</p><p><img src=https://img.linux.net.cn/data/attachment/album/202302/03/112300n5ickmgi5585hm13.jpg alt="Figure 2: Data frame with basic modifications"></p><h4 id=准备好特征值目标值>准备好特征值、目标值</h4><p>下一步是数据的预处理。这是非常重要的一步，因为机器学习算法只能理解/处理数值形数据，而不能理解文本，所以此时要进行特征抽取，将字符串/文本转换成数值化的数据。此外，还需要删除冗余和无用的数据，因为这些数据可能会污染我们的训练模型。我们在这一步中去除了噪声数据、缺失值数据和不一致的数据。</p><p>对于情感分析，我们在数据帧中添加特征文本的长度和标点符号计数。我们还要进行词干提取，即将所有相似词（如 “give”、“giving” 等）转换为单一形式。完成后，我们将数据集分为两部分：特征值 X 和 目标值 Y。</p><p>上述内容是使用以下代码完成的。下图显示了执行这些步骤后的数据帧。</p><p><img src=https://img.linux.net.cn/data/attachment/album/202302/03/112300yeekkkybk44jc50w.jpg alt="Figure 3: Data frame after the division of the data set"></p><pre tabindex=0><code>def count_punct(text):
   count = sum([1 for char in text if char in string.punctuation])
   return round(count/(len(text) - text.count(“ “)),3)*100
 
tokenized_tweet = sentiment_dataframe[‘body_text’].apply(lambda x: x.split())
stemmer = PorterStemmer()
tokenized_tweet = tokenized_tweet.apply(lambda x: [stemmer.stem(i) for i in x])
for i in range(len(tokenized_tweet)):
   tokenized_tweet[i] = ‘ ‘.join(tokenized_tweet[i])
sentiment_dataframe[‘body_text’] = tokenized_tweet
sentiment_dataframe[‘body_len’] = sentiment_dataframe[‘body_text’].apply(lambda x:len(x) - x.count(“ “))
sentiment_dataframe[‘punct%’] = sentiment_dataframe[‘body_text’].apply(lambda x:count_punct(x))
X = sentiment_dataframe[‘body_text’]
y = sentiment_dataframe[‘label’]
</code></pre><h4 id=特征工程文本特征处理>特征工程：文本特征处理</h4><p>我们接下来进行文本特征抽取，对文本特征进行数值化。为此，我们使用 计数向量器 CountVectorizer ，它返回词频矩阵。</p><p>在此之后，计算数据帧 X 中的文本长度和标点符号计数等特征。X 的示例如下图所示。</p><p><img src=https://img.linux.net.cn/data/attachment/album/202302/03/112300j0cgoo0sqgxp3isx.jpg alt="Figure 4: Sample of final features"></p><h4 id=使用的机器学习算法>使用的机器学习算法</h4><p>现在数据已经可以训练了。下一步是确定使用哪些算法来训练模型。如前所述，我们将尝试多种机器学习算法，并确定最适合情感分析的算法。由于我们打算对文本进行二元分类，因此我们使用以下算法：</p><ul><li>K-近邻算法（KNN）</li><li>逻辑回归算法</li><li>支持向量机（SVMs）</li><li>随机梯度下降（SGD）</li><li>朴素贝叶斯算法</li><li>决策树算法</li><li>随机森林算法</li></ul><h4 id=划分数据集>划分数据集</h4><p>首先，将数据集划分为训练集和测试集。使用 <code>sklearn</code> 库，详见以下代码：</p><pre tabindex=0><code>from sklearn.model_selection import train_test_split
X_train, X_test, y_train, y_test = train_test_split(X,y, test_size = 0.20, random_state = 99)
</code></pre><p>我们使用 20% 的数据进行测试，80% 的数据用于训练。划分数据的意义在于对一组新数据（即测试集）评估我们训练的模型是否有效。</p><h5 id=k-近邻算法>K-近邻算法</h5><p>现在，让我们开始训练第一个模型。首先，我们使用 KNN 算法。先训练模型，然后再评估模型的准确率（具体的代码都可以使用 Python 的 <code>sklearn</code> 库来完成）。详见以下代码，KNN 训练模型的准确率大约为 50%。</p><pre tabindex=0><code>from sklearn.neighbors import KNeighborsClassifier
model = KNeighborsClassifier(n_neighbors=3)
model.fit(X_train, y_train)
model.score (X_test,y_test)

0.5056689342403629
</code></pre><h5 id=逻辑回归算法>逻辑回归算法</h5><p>逻辑回归模型的代码十分类似——首先从库中导入函数，拟合模型，然后对模型进行评估。下面的代码使用逻辑回归算法，准确率大约为 66%。</p><pre tabindex=0><code>from sklearn.linear_model import LogisticRegression
model = LogisticRegression()
model.fit (X_train,y_train)
model.score (X_test,y_test)

0.6621315192743764
</code></pre><h5 id=支持向量机算法>支持向量机算法</h5><p>以下代码使用 SVM，准确率大约为 67%。</p><pre tabindex=0><code>from sklearn import svm
model = svm.SVC(kernel=’linear’)
model.fit(X_train, y_train)
model.score(X_test,y_test)

0.6780045351473923
</code></pre><h5 id=随机森林算法>随机森林算法</h5><p>以下的代码使用了随机森林算法，随机森林训练模型的准确率大约为 69%。</p><pre tabindex=0><code>from sklearn.ensemble import RandomForestClassifier
model = RandomForestClassifier()
model.fit(X_train, y_train)
model.score(X_test,y_test)

0.6938775510204082
</code></pre><h5 id=决策树算法>决策树算法</h5><p>接下来，我们使用决策树算法，其准确率约为 61%。</p><pre tabindex=0><code>from sklearn.tree import DecisionTreeClassifier
model = DecisionTreeClassifier()
model = model.fit(X_train,y_train)
model.score(X_test,y_test)

0.6190476190476191
</code></pre><h5 id=随机梯度下降算法>随机梯度下降算法</h5><p>以下的代码使用随机梯度下降算法，其准确率大约为 49%。</p><pre tabindex=0><code>from sklearn.linear_model import SGDClassifier
model = SGDClassifier()
model = model.fit(X_train,y_train)
model.score(X_test,y_test)

0.49206349206349204
</code></pre><h5 id=朴素贝叶斯算法>朴素贝叶斯算法</h5><p>以下的代码使用朴素贝叶斯算法，朴素贝叶斯训练模型的准确率大约为 60%。</p><pre tabindex=0><code>from sklearn.naive_bayes import GaussianNB
model = GaussianNB()
model.fit(X_train, y_train)
model.score(X_test,y_test)

0.6009070294784581
</code></pre><h4 id=情感分析的最佳算法>情感分析的最佳算法</h4><p>接下来，我们绘制所有算法的准确率图。如下图所示。</p><p><img src=https://img.linux.net.cn/data/attachment/album/202302/03/112300fl2uak20vakxu070.jpg alt="Figure 5: Accuracy performance of the different algorithms"></p><p>可以看到，对于情感分析这一问题，随机森林算法有最佳的准确率。由此，我们可以得出结论，随机森林算法是所有机器算法中最适合情感分析的算法。我们可以通过处理得到更好的特征、尝试其他矢量化技术、或者使用更好的数据集或更好的分类算法，来进一步提高准确率。</p><p>既然，随机森林算法是解决情感分析问题的最佳算法，我将向你展示一个预处理数据的样本。在下图中，你可以看到模型会做出正确的预测！试试这个来改进你的项目吧！</p><p><img src=https://img.linux.net.cn/data/attachment/album/202302/03/112301vcbt5899c0hcig56.jpg alt="Figure 6: Sample predictions made"></p><hr><p>via: <a href=https://www.opensourceforu.com/2022/09/how-to-analyse-sentiments-using-machine-learning/>https://www.opensourceforu.com/2022/09/how-to-analyse-sentiments-using-machine-learning/</a></p><p>作者：<a href=https://www.opensourceforu.com/author/jishnu-saurav-mittapalli/>Jishnu Saurav Mittapalli</a> 选题：<a href=https://github.com/lkxed>lkxed</a> 译者：<a href=https://github.com/chai001125>chai001125</a> 校对：<a href=https://github.com/wxy>wxy</a></p><p>本文由 <a href=https://github.com/LCTT/TranslateProject>LCTT</a> 原创编译，<a href=https://linux.cn/>Linux中国</a> 荣誉推出</p></div><footer class=post__footer><div class="post__tags tags clearfix"><svg class="tags__badge icon icon-tag" width="16" height="16" viewBox="0 0 32 32"><path d="M32 19c0 1-1 2-1 2L21 31s-1 1-2 1-2-1-2-1L2 16c-1-1-1.4-2-1.4-2S0 12.5.0 11V3C0 1.5.8.8.8.8S1.5.0 3 0h8c1.5.0 3 .6 3 .6S15 1 16 2l15 15s1 1 1 2zM7 10a3 3 0 100-6 3 3 0 000 6z"/></svg><ul class=tags__list><li class=tags__item><a class="tags__link btn" href=/tags/%E6%83%85%E6%84%9F%E5%88%86%E6%9E%90/ rel=tag>情感分析</a></li><li class=tags__item><a class="tags__link btn" href=/tags/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/ rel=tag>机器学习</a></li></ul></div></footer></article></main></div></div><footer class=footer><div class="container footer__container flex"><div class=footer__copyright>&copy; 2025 Linux.cn Archive.
<span class=footer__copyright-credits>Generated with <a href=https://gohugo.io/ rel="nofollow noopener" target=_blank>Hugo</a> and <a href=https://github.com/Vimux/Mainroad/ rel="nofollow noopener" target=_blank>Mainroad</a> theme.</span></div></div></footer></div><script async defer src=/js/menu.js></script></body></html>