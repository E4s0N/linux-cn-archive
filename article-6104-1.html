<!doctype html><html class=no-js lang=en><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><title>使用 dd 命令进行硬盘 I/O 性能检测 - Linux.cn Archive</title>
<script>(function(e,t){e[t]=e[t].replace("no-js","js")})(document.documentElement,"className")</script><meta name=description content><meta property="og:title" content="使用 dd 命令进行硬盘 I/O 性能检测"><meta property="og:description" content="如何使用dd命令测试我的硬盘性能？如何在linux操作系统下检测硬盘的读写速度？ 你可以使用以下命令在一个Linux或类Unix操作系统上进行简单的I/O性能测试。  dd命令 ：它被用来在Linux和类Unix系统下对硬盘设备进行写性能的检测。 hparm命令：它用来在基于 Linux 的系统上获取或设置硬盘参数，包括测试读性能以及缓存性能等。  在这篇指南中，你将会学到如何使用dd命令来测试硬盘性能。  使用dd命令来监控硬盘的读写性能：  打开shell终端。 或者通过ssh登录到远程服务器。 使用dd命令来测量服务器的吞吐率（写速度) dd if=/dev/zero of=/t"><meta property="og:type" content="article"><meta property="og:url" content="/article-6104-1.html"><meta property="article:section" content="posts"><meta property="article:published_time" content="2015-08-28T07:30:00+00:00"><meta property="article:modified_time" content="2015-08-28T07:30:00+00:00"><meta itemprop=name content="使用 dd 命令进行硬盘 I/O 性能检测"><meta itemprop=description content="如何使用dd命令测试我的硬盘性能？如何在linux操作系统下检测硬盘的读写速度？ 你可以使用以下命令在一个Linux或类Unix操作系统上进行简单的I/O性能测试。  dd命令 ：它被用来在Linux和类Unix系统下对硬盘设备进行写性能的检测。 hparm命令：它用来在基于 Linux 的系统上获取或设置硬盘参数，包括测试读性能以及缓存性能等。  在这篇指南中，你将会学到如何使用dd命令来测试硬盘性能。  使用dd命令来监控硬盘的读写性能：  打开shell终端。 或者通过ssh登录到远程服务器。 使用dd命令来测量服务器的吞吐率（写速度) dd if=/dev/zero of=/t"><meta itemprop=datePublished content="2015-08-28T07:30:00+00:00"><meta itemprop=dateModified content="2015-08-28T07:30:00+00:00"><meta itemprop=wordCount content="301"><meta itemprop=keywords content="dd,硬盘,"><link rel=preconnect href=https://fonts.bunny.net crossorigin><link rel=dns-prefetch href=//fonts.bunny.net><link rel=dns-prefetch href=//fonts.bunny.net><link rel=stylesheet href="https://fonts.bunny.net/css?family=Open+Sans:400,400i,700"><link rel=stylesheet href=/css/style.css><link rel="shortcut icon" href=/favicon.ico></head><body class=body><div class="container container--outer"><header class=header><div class="container header__container"><div class=logo><a class=logo__link href=/ title="Linux.cn Archive" rel=home><div class="logo__item logo__text"><div class=logo__title>Linux.cn Archive</div></div></a></div><nav class=menu><button class=menu__btn aria-haspopup=true aria-expanded=false tabindex=0>
<span class=menu__btn-title tabindex=-1>Menu</span></button><ul class=menu__list><li class=menu__item><a class=menu__link href=/><span class=menu__text>Home</span></a></li><li class=menu__item><a class=menu__link href=/categories/><span class=menu__text>Categories</span></a></li><li class=menu__item><a class=menu__link href=/tags/><span class=menu__text>Tags</span></a></li><li class=menu__item><a class=menu__link href><span class=menu__text>RSS</span></a></li></ul></nav></div></header><div class="wrapper flex"><div class=primary><main class=main role=main><article class=post><header class=post__header><h1 class=post__title>使用 dd 命令进行硬盘 I/O 性能检测</h1><div class="post__meta meta"><div class="meta__item-datetime meta__item"><svg class="meta__icon icon icon-time" width="16" height="14" viewBox="0 0 30 28"><path d="M15 0C7 0 1 6 1 14s6 14 14 14 14-6 14-14S23 0 15 0zm0 25C9 25 4 20 4 14S9 3 15 3s11 5 11 11-5 11-11 11zm1-18h-2v8.4l6.8 4.4L22 18l-6-3.8V7z"/></svg><time class=meta__text datetime=2015-08-28T07:30:00Z>August 28, 2015</time></div></div></header><div class="content post__content clearfix"><p>如何使用dd命令测试我的硬盘性能？如何在linux操作系统下检测硬盘的读写速度？</p><p>你可以使用以下命令在一个Linux或类Unix操作系统上进行简单的I/O性能测试。</p><ul><li><strong>dd命令</strong> ：它被用来在Linux和类Unix系统下对硬盘设备进行写性能的检测。</li><li><strong>hparm命令</strong>：它用来在基于 Linux 的系统上获取或设置硬盘参数，包括测试读性能以及缓存性能等。</li></ul><p>在这篇指南中，你将会学到如何使用dd命令来测试硬盘性能。</p><p><img src=/data/attachment/album/201508/27/230834dggg9138i09u8ncu.png alt></p><h3 id=使用dd命令来监控硬盘的读写性能>使用dd命令来监控硬盘的读写性能：</h3><ul><li>打开shell终端。</li><li>或者通过ssh登录到远程服务器。</li><li>使用dd命令来测量服务器的吞吐率（写速度) <code>dd if=/dev/zero of=/tmp/test1.img bs=1G count=1 oflag=dsync</code></li><li>使用dd命令测量服务器延迟 <code>dd if=/dev/zero of=/tmp/test2.img bs=512 count=1000 oflag=dsync</code></li></ul><h4 id=理解dd命令的选项>理解dd命令的选项</h4><p>在这个例子当中，我将使用搭载Ubuntu Linux 14.04 LTS系统的RAID-10（配有SAS SSD的Adaptec 5405Z）服务器阵列来运行。基本语法为：</p><pre tabindex=0><code>dd if=/dev/input.file  of=/path/to/output.file  bs=block-size  count=number-of-blocks  oflag=dsync
## GNU dd语法 ##
dd if=/dev/zero of=/tmp/test1.img bs=1G count=1 oflag=dsync
##另外一种GNU dd的语法 ##
dd if=/dev/zero of=/tmp/testALT.img bs=1G count=1 conv=fdatasync
</code></pre><p>输出样例：</p><p><img src=/data/attachment/album/201508/27/230838m6ulemt4kc8afaff.jpg alt="Fig.01: Ubuntu Linux Server with RAID10 and testing server throughput with dd"></p><p><em>图01: 使用dd命令获取的服务器吞吐率</em></p><p>请各位注意在这个实验中，我们写入一个G的数据，可以发现，服务器的吞吐率是135 MB/s，这其中</p><ul><li><code>if=/dev/zero</code> (if=/dev/input.file) ：用来设置dd命令读取的输入文件名。</li><li><code>of=/tmp/test1.img</code> (of=/path/to/output.file)：dd命令将input.file写入的输出文件的名字。</li><li><code>bs=1G</code> (bs=block-size) ：设置dd命令读取的块的大小。例子中为1个G。</li><li><code>count=1</code> (count=number-of-blocks)：dd命令读取的块的个数。</li><li><code>oflag=dsync</code> (oflag=dsync) ：使用同步I/O。不要省略这个选项。这个选项能够帮助你去除caching的影响，以便呈现给你精准的结果。</li><li><code>conv=fdatasyn</code>: 这个选项和<code>oflag=dsync</code>含义一样。</li></ul><p>在下面这个例子中，一共写了1000次，每次写入512字节来获得RAID10服务器的延迟时间：</p><pre tabindex=0><code>dd if=/dev/zero of=/tmp/test2.img bs=512 count=1000 oflag=dsync
</code></pre><p>输出样例：</p><pre tabindex=0><code>1000+0 records in
1000+0 records out
512000 bytes (512 kB) copied, 0.60362 s, 848 kB/s
</code></pre><p>请注意服务器的吞吐率以及延迟时间也取决于服务器/应用的负载。所以我推荐你在一个刚刚重启过并且处于峰值时间的服务器上来运行测试，以便得到更加准确的度量。现在你可以在你的所有设备上互相比较这些测试结果了。</p><h3 id=为什么服务器的吞吐率和延迟时间都这么差>为什么服务器的吞吐率和延迟时间都这么差？</h3><p>低的数值并不意味着你在使用差劲的硬件。可能是硬件 RAID10的控制器缓存导致的。</p><p>使用hdparm命令来查看硬盘缓存的读速度。</p><p>我建议你运行下面的命令2-3次来对设备读性能进行检测，以作为参照和相互比较：</p><pre tabindex=0><code>### 有缓存的硬盘读性能测试——/dev/sda ###
hdparm -t /dev/sda1
## 或者 ##
hdparm -t /dev/sda
</code></pre><p>然后运行下面这个命令2-3次来对缓存的读性能进行对照性检测：</p><pre tabindex=0><code>## Cache读基准——/dev/sda ###
hdparm -T /dev/sda1
## 或者 ##
hdparm -T /dev/sda
</code></pre><p>或者干脆把两个测试结合起来：</p><pre tabindex=0><code>hdparm -Tt /dev/sda
</code></pre><p>输出样例：</p><p><img src=/data/attachment/album/201508/27/230839yiazuscghk0glmho.jpg alt="Fig.02: Linux hdparm command to test reading and caching disk performance"></p><p><em>图02: 检测硬盘读入以及缓存性能的Linux hdparm命令</em></p><p>请再次注意，由于文件文件操作的缓存属性，你将总是会看到很高的读速度。</p><h3 id=使用dd命令来测试读取速度>使用dd命令来测试读取速度</h3><p>为了获得精确的读测试数据，首先在测试前运行下列命令，来将缓存设置为无效：</p><pre tabindex=0><code>flush
echo 3 | sudo tee /proc/sys/vm/drop_caches
time time dd if=/path/to/bigfile of=/dev/null bs=8k
</code></pre><h4 id=笔记本上的示例>笔记本上的示例</h4><p>运行下列命令：</p><pre tabindex=0><code>### 带有Cache的Debian系统笔记本吞吐率###
dd if=/dev/zero of=/tmp/laptop.bin bs=1G count=1 oflag=direct

###使cache失效###
hdparm -W0 /dev/sda

###没有Cache的Debian系统笔记本吞吐率###
dd if=/dev/zero of=/tmp/laptop.bin bs=1G count=1 oflag=direct
</code></pre><h4 id=苹果os-x-unixmacbook-pro的例子>苹果OS X Unix(Macbook pro)的例子</h4><p>GNU dd has many more options but OS X/BSD and Unix-like dd command need to run as follows to test real disk I/O and not memory add sync option as follows:</p><p>GNU dd命令有其他许多选项，但是在 OS X/BSD 以及类Unix中， dd命令需要像下面那样执行来检测去除掉内存地址同步的硬盘真实I/O性能：</p><pre tabindex=0><code>## 运行这个命令2-3次来获得更好地结果 ###
time sh -c &#34;dd if=/dev/zero of=/tmp/testfile bs=100k count=1k &amp;&amp; sync&#34;
</code></pre><p>输出样例：</p><pre tabindex=0><code>1024+0 records in
1024+0 records out
104857600 bytes transferred in 0.165040 secs (635346520 bytes/sec)

real    0m0.241s
user    0m0.004s
sys 0m0.113s
</code></pre><p>本人Macbook Pro的写速度是635346520字节（635.347MB/s)。</p><h3 id=不喜欢用命令行>不喜欢用命令行?</h3><p>你可以在Linux或基于Unix的系统上使用disk utility(gnome-disk-utility)这款工具来得到同样的信息。下面的那个图就是在我的Fedora Linux v22 VM上截取的。</p><h4 id=图形化方法>图形化方法</h4><p>点击“Activites”或者“Super”按键来在桌面和Activites视图间切换。输入“Disks”</p><p><img src=/data/attachment/album/201508/27/230842namxncmuxjm95bmr.jpg alt="Fig.03: Start the Gnome disk utility"></p><p><em>图03: 打开Gnome硬盘工具</em></p><p>在左边的面板上选择你的硬盘，点击configure按钮，然后点击“Benchmark partition”：</p><p><img src=/data/attachment/album/201508/27/230845xjwbd2b6qhk6jjkz.jpg alt="Fig.04: Benchmark disk/partition"></p><p><em>图04: 评测硬盘/分区</em></p><p>最后，点击“Start Benchmark&mldr;”按钮（你可能需要输入管理员用户名和密码）：</p><p><img src=/data/attachment/album/201508/27/230848yeeueaa17bt8jge2.jpg alt="Fig.05: Final benchmark result"></p><p><em>图05: 最终的评测结果</em></p><p>如果你要问，我推荐使用哪种命令和方法？</p><ul><li>我推荐在所有的类Unix系统上使用dd命令（<code>time sh -c "dd if=/dev/zero of=/tmp/testfile bs=100k count=1k && sync</code>）</li><li>如果你在使用GNU/Linux，使用dd命令 (<code>dd if=/dev/zero of=/tmp/testALT.img bs=1G count=1 conv=fdatasync</code>)</li><li>确保你每次使用时，都调整了count以及bs参数以获得更好的结果。</li><li>GUI方法只适合桌面系统为Gnome2或Gnome3的Linux/Unix笔记本用户。</li></ul><hr><p>via: <a href=http://www.cyberciti.biz/faq/howto-linux-unix-test-disk-performance-with-dd-command/>http://www.cyberciti.biz/faq/howto-linux-unix-test-disk-performance-with-dd-command/</a></p><p>作者：Vivek Gite 译者：<a href=https://github.com/DongShuaike>DongShuaike</a> 校对：<a href=https://github.com/wxy>wxy</a></p><p>本文由 <a href=https://github.com/LCTT/TranslateProject>LCTT</a> 原创翻译，<a href=https://linux.cn/>Linux中国</a> 荣誉推出</p></div><footer class=post__footer><div class="post__tags tags clearfix"><svg class="tags__badge icon icon-tag" width="16" height="16" viewBox="0 0 32 32"><path d="M32 19c0 1-1 2-1 2L21 31s-1 1-2 1-2-1-2-1L2 16c-1-1-1.4-2-1.4-2S0 12.5.0 11V3C0 1.5.8.8.8.8S1.5.0 3 0h8c1.5.0 3 .6 3 .6S15 1 16 2l15 15s1 1 1 2zM7 10a3 3 0 100-6 3 3 0 000 6z"/></svg><ul class=tags__list><li class=tags__item><a class="tags__link btn" href=/tags/dd/ rel=tag>dd</a></li><li class=tags__item><a class="tags__link btn" href=/tags/%E7%A1%AC%E7%9B%98/ rel=tag>硬盘</a></li></ul></div></footer></article></main></div></div><footer class=footer><div class="container footer__container flex"><div class=footer__copyright>&copy; 2025 Linux.cn Archive.
<span class=footer__copyright-credits>Generated with <a href=https://gohugo.io/ rel="nofollow noopener" target=_blank>Hugo</a> and <a href=https://github.com/Vimux/Mainroad/ rel="nofollow noopener" target=_blank>Mainroad</a> theme.</span></div></div></footer></div><script async defer src=/js/menu.js></script></body></html>