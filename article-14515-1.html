<!doctype html><html class=no-js lang=en><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><title>使用 Podman 运行一个 “hello world” MLCube - Linux.cn Archive</title>
<script>(function(e,t){e[t]=e[t].replace("no-js","js")})(document.documentElement,"className")</script><meta name=description content><meta property="og:title" content="使用 Podman 运行一个 “hello world” MLCube"><meta property="og:description" content="这篇介绍性文章解释了如何在 Fedora Linux 上使用 Podman 运行 “hello world” MLCube 例子。"><meta property="og:type" content="article"><meta property="og:url" content="/article-14515-1.html"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-04-27T10:36:36+00:00"><meta property="article:modified_time" content="2022-04-27T10:36:36+00:00"><meta itemprop=name content="使用 Podman 运行一个 “hello world” MLCube"><meta itemprop=description content="这篇介绍性文章解释了如何在 Fedora Linux 上使用 Podman 运行 “hello world” MLCube 例子。"><meta itemprop=datePublished content="2022-04-27T10:36:36+00:00"><meta itemprop=dateModified content="2022-04-27T10:36:36+00:00"><meta itemprop=wordCount content="214"><meta itemprop=keywords content="Podman,MLCube,"><link rel=preconnect href=https://fonts.bunny.net crossorigin><link rel=dns-prefetch href=//fonts.bunny.net><link rel=dns-prefetch href=//fonts.bunny.net><link rel=stylesheet href="https://fonts.bunny.net/css?family=Open+Sans:400,400i,700"><link rel=stylesheet href=/css/style.css><link rel="shortcut icon" href=/favicon.ico></head><body class=body><div class="container container--outer"><header class=header><div class="container header__container"><div class=logo><a class=logo__link href=/ title="Linux.cn Archive" rel=home><div class="logo__item logo__text"><div class=logo__title>Linux.cn Archive</div></div></a></div><nav class=menu><button class=menu__btn aria-haspopup=true aria-expanded=false tabindex=0>
<span class=menu__btn-title tabindex=-1>Menu</span></button><ul class=menu__list><li class=menu__item><a class=menu__link href=/><span class=menu__text>Home</span></a></li><li class=menu__item><a class=menu__link href=/categories/><span class=menu__text>Categories</span></a></li><li class=menu__item><a class=menu__link href=/tags/><span class=menu__text>Tags</span></a></li><li class=menu__item><a class=menu__link href><span class=menu__text>RSS</span></a></li></ul></nav></div></header><div class="wrapper flex"><div class=primary><main class=main role=main><article class=post><header class=post__header><h1 class=post__title>使用 Podman 运行一个 “hello world” MLCube</h1><div class="post__meta meta"><div class="meta__item-datetime meta__item"><svg class="meta__icon icon icon-time" width="16" height="14" viewBox="0 0 30 28"><path d="M15 0C7 0 1 6 1 14s6 14 14 14 14-6 14-14S23 0 15 0zm0 25C9 25 4 20 4 14S9 3 15 3s11 5 11 11-5 11-11 11zm1-18h-2v8.4l6.8 4.4L22 18l-6-3.8V7z"/></svg><time class=meta__text datetime=2022-04-27T10:36:36Z>April 27, 2022</time></div></div></header><div class="content post__content clearfix"><p><img src=/data/attachment/album/202204/27/103635qwtt6329orht0393.jpg alt></p><p><a href=https://mlcommons.org/en/mlcube/>MLCube</a> 是一个新的基于基础设施规范的开源容器，被引入到基于 Python 的机器学习工作流程中，以实现可重复性。它可以利用诸如 <a href=https://podman.io/>Podman</a>、<a href=https://sylabs.io/singularity/>Singularity</a> 和 <a href=https://www.docker.com/>Docker</a> 等工具。也支持在远程平台上的执行。开发 MLCube 的 MLCommons 最佳实践工作组的主席之一是来自 Red Hat 的 <a href=https://www.redhat.com/en/authors/diane-feddema>Diane Feddema</a>。这篇介绍性文章解释了如何在 Fedora Linux 上使用 Podman 运行 <a href=https://mlcommons.github.io/mlcube/getting-started/hello-world/>“hello world” MLCube 例子</a>。</p><p><a href=https://fedoramagazine.org/author/yazanalmonshed/>Yazan Monshed</a> 写了一篇关于 <a href=https://fedoramagazine.org/getting-started-with-podman-in-fedora/>Fedora 上的 Podman</a> 的非常有用的介绍，对这里使用的一些步骤给出了更多细节。</p><p>首先安装必要的依赖项。</p><pre tabindex=0><code>sudo dnf -y update
sudo dnf -y install podman git virtualenv \
                    policycoreutils-python-utils
</code></pre><p>然后，按照文档的要求，设置一个虚拟环境并获得示例代码。为了确保可重复性，使用一个特定的提交，因为该项目正在积极改进。</p><pre tabindex=0><code>virtualenv -p python3 ./env_mlcube 
source ./env_mlcube/bin/activate
git clone https://github.com/mlcommons/mlcube_examples.git 
cd ./mlcube_examples/hello_world
git checkout 5fe69bd
pip install mlcube mlcube-docker
mlcube describe
</code></pre><p>现在，通过编辑 $HOME/mlcube.yaml 文件，将运行器命令从 <code>docker</code> 改为 <code>podman</code>，即：</p><pre tabindex=0><code>docker: docker
</code></pre><p>改为：</p><pre tabindex=0><code>docker: podman
</code></pre><p>如果你使用的是 x86_64 架构的电脑，你可以用以下方式获取容器：</p><pre tabindex=0><code>mlcube configure --mlcube=. --platform=docker
</code></pre><p>你会看到一些选项：</p><pre tabindex=0><code>? Please select an image: 
  ▸ registry.fedoraproject.org/mlcommons/hello_world:0.0.1
    registry.access.redhat.com/mlcommons/hello_world:0.0.1
    docker.io/mlcommons/hello_world:0.0.1
    quay.io/mlcommons/hello_world:0.0.1
</code></pre><p>选择 <code>docker.io/mlcommons/hello_world:0.0.1</code> 来获取容器。</p><p>如果你的电脑不是 x86_64 架构的，你需要构建容器。改变文件 <code>$HOME/mlcube.yaml</code>，将这一行：</p><pre tabindex=0><code>build_strategy: pull
</code></pre><p>变为：</p><pre tabindex=0><code>build_strategy: auto
</code></pre><p>然后用以下方法构建容器：</p><pre tabindex=0><code>mlcube configure --mlcube=. --platform=docker
</code></pre><p>要运行测试，你可能需要在目录中适当地设置 SELinux 权限。你可以通过输入以下内容来检查 SELinux 是否已经启用：</p><pre tabindex=0><code>sudo sestatus
</code></pre><p>应该会有类似这样的输出：</p><pre tabindex=0><code>SELinux status:                 enabled
...
</code></pre><p><a href=https://computingforgeeks.com/set-selinux-context-label-for-podman-graphroot-directory/>Josphat Mutai</a>、<a href=https://blog.christophersmart.com/2021/01/31/podman-volumes-and-selinux/>Christopher Smart</a> 和 <a href=https://opensource.com/article/18/2/selinux-labels-container-runtimes>Daniel Walsh</a> 解释说，在为容器使用的文件设置适当的 SELinux 策略时，你需要谨慎。在这里，你将允许容器读取和写入 <code>workspace</code> 目录。</p><pre tabindex=0><code>sudo semanage fcontext -a -t container_file_t &#34;$PWD/workspace(/.*)?&#34;
sudo restorecon -Rv $PWD/workspace
</code></pre><p>现在检查目录策略：</p><pre tabindex=0><code>ls -Z
</code></pre><p>输出结果类似于：</p><pre tabindex=0><code>unconfined_u:object_r:user_home_t:s0 Dockerfile
unconfined_u:object_r:user_home_t:s0 README.md
unconfined_u:object_r:user_home_t:s0 mlcube.yaml
unconfined_u:object_r:user_home_t:s0 requirements.txt
unconfined_u:object_r:container_file_t:s0 workspace
</code></pre><p>现在运行这个例子：</p><pre tabindex=0><code>mlcube run --mlcube=. --task=hello --platform=docker
mlcube run --mlcube=. --task=bye --platform=docker
</code></pre><p>最后，检查输出：</p><pre tabindex=0><code>cat workspace/chats/chat_with_alice.txt
</code></pre><p>有类似于以下的文字：</p><pre tabindex=0><code>Hi, Alice! Nice to meet you.
Bye, Alice! It was great talking to you.
</code></pre><p>你可以按照 <a href=https://mlcommons.github.io/mlcube/tutorials/create-mlcube/>这里</a> 的描述创建你自己的 MLCube。欢迎对 <a href=https://github.com/mlcommons/mlcube_examples>MLCube 示例库</a> 做出贡献。<a href=https://github.com/containers/udica>Udica</a> 是一个新项目，它承诺为容器提供更精细的 SELinux 策略控制，便于系统管理员应用。这些项目的积极开发正在进行中。对它们进行测试并提供反馈，将有助于使带有 SELinux 的系统上的安全数据管理更容易、更有效。</p><hr><p>via: <a href=https://fedoramagazine.org/mlcube-and-podman/>https://fedoramagazine.org/mlcube-and-podman/</a></p><p>作者：<a href=https://fedoramagazine.org/author/fed500/>Benson Muite</a> 选题：<a href=https://github.com/lujun9972>lujun9972</a> 译者：<a href=https://github.com/geekpi>geekpi</a> 校对：<a href=https://github.com/wxy>wxy</a></p><p>本文由 <a href=https://github.com/LCTT/TranslateProject>LCTT</a> 原创编译，<a href=https://linux.cn/>Linux中国</a> 荣誉推出</p></div><footer class=post__footer><div class="post__tags tags clearfix"><svg class="tags__badge icon icon-tag" width="16" height="16" viewBox="0 0 32 32"><path d="M32 19c0 1-1 2-1 2L21 31s-1 1-2 1-2-1-2-1L2 16c-1-1-1.4-2-1.4-2S0 12.5.0 11V3C0 1.5.8.8.8.8S1.5.0 3 0h8c1.5.0 3 .6 3 .6S15 1 16 2l15 15s1 1 1 2zM7 10a3 3 0 100-6 3 3 0 000 6z"/></svg><ul class=tags__list><li class=tags__item><a class="tags__link btn" href=/tags/podman/ rel=tag>Podman</a></li><li class=tags__item><a class="tags__link btn" href=/tags/mlcube/ rel=tag>MLCube</a></li></ul></div></footer></article></main></div></div><footer class=footer><div class="container footer__container flex"><div class=footer__copyright>&copy; 2025 Linux.cn Archive.
<span class=footer__copyright-credits>Generated with <a href=https://gohugo.io/ rel="nofollow noopener" target=_blank>Hugo</a> and <a href=https://github.com/Vimux/Mainroad/ rel="nofollow noopener" target=_blank>Mainroad</a> theme.</span></div></div></footer></div><script async defer src=/js/menu.js></script></body></html>