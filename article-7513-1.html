<!doctype html><html class=no-js lang=en><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><title>Linux/UNIX 定时任务 cron 详解 - Linux.cn Archive</title>
<script>(function(e,t){e[t]=e[t].replace("no-js","js")})(document.documentElement,"className")</script><meta name=description content><meta property="og:title" content="Linux/UNIX 定时任务 cron 详解"><meta property="og:description" content="定时任务（cron job）被用于安排那些需要被周期性执行的命令。利用它，你可以配置某些命令或者脚本，让它们在某个设定的时间内周期性地运行。"><meta property="og:type" content="article"><meta property="og:url" content="/article-7513-1.html"><meta property="article:section" content="posts"><meta property="article:published_time" content="2016-06-28T15:54:00+00:00"><meta property="article:modified_time" content="2016-06-28T15:54:00+00:00"><meta itemprop=name content="Linux/UNIX 定时任务 cron 详解"><meta itemprop=description content="定时任务（cron job）被用于安排那些需要被周期性执行的命令。利用它，你可以配置某些命令或者脚本，让它们在某个设定的时间内周期性地运行。"><meta itemprop=datePublished content="2016-06-28T15:54:00+00:00"><meta itemprop=dateModified content="2016-06-28T15:54:00+00:00"><meta itemprop=wordCount content="487"><meta itemprop=keywords content="cron,crontab,定时任务,"><link rel=preconnect href=https://fonts.bunny.net crossorigin><link rel=dns-prefetch href=//fonts.bunny.net><link rel=dns-prefetch href=//fonts.bunny.net><link rel=stylesheet href="https://fonts.bunny.net/css?family=Open+Sans:400,400i,700"><link rel=stylesheet href=/css/style.css><link rel="shortcut icon" href=/favicon.ico></head><body class=body><div class="container container--outer"><header class=header><div class="container header__container"><div class=logo><a class=logo__link href=/ title="Linux.cn Archive" rel=home><div class="logo__item logo__text"><div class=logo__title>Linux.cn Archive</div></div></a></div><nav class=menu><button class=menu__btn aria-haspopup=true aria-expanded=false tabindex=0>
<span class=menu__btn-title tabindex=-1>Menu</span></button><ul class=menu__list><li class=menu__item><a class=menu__link href=/><span class=menu__text>Home</span></a></li><li class=menu__item><a class=menu__link href=/categories/><span class=menu__text>Categories</span></a></li><li class=menu__item><a class=menu__link href=/tags/><span class=menu__text>Tags</span></a></li><li class=menu__item><a class=menu__link href><span class=menu__text>RSS</span></a></li></ul></nav></div></header><div class="wrapper flex"><div class=primary><main class=main role=main><article class=post><header class=post__header><h1 class=post__title>Linux/UNIX 定时任务 cron 详解</h1><div class="post__meta meta"><div class="meta__item-datetime meta__item"><svg class="meta__icon icon icon-time" width="16" height="14" viewBox="0 0 30 28"><path d="M15 0C7 0 1 6 1 14s6 14 14 14 14-6 14-14S23 0 15 0zm0 25C9 25 4 20 4 14S9 3 15 3s11 5 11 11-5 11-11 11zm1-18h-2v8.4l6.8 4.4L22 18l-6-3.8V7z"/></svg><time class=meta__text datetime=2016-06-28T15:54:00Z>June 28, 2016</time></div></div></header><div class="content post__content clearfix"><p><img src=https://img.linux.net.cn/data/attachment/album/201606/28/155407teajtncbtgt4ptk4.png alt></p><h3 id=导言>导言</h3><p><img src=https://img.linux.net.cn/data/attachment/album/201606/28/155408xjf3eeflwfl36fw6.gif alt></p><p>定时任务 （ cron job ） 被用于安排那些需要被周期性执行的命令。利用它，你可以配置某些命令或者脚本，让它们在某个设定的时间内周期性地运行。<code>cron</code> 是 Linux 或者类 Unix 系统中最为实用的工具之一。cron 服务（守护进程）在系统后台运行，并且会持续地检查 <code>/etc/crontab</code> 文件和 <code>/etc/cron.*/</code>目录。它同样也会检查 <code>/var/spool/cron/</code> 目录。</p><h3 id=crontab-命令>crontab 命令</h3><p><code>crontab</code> 是用来安装、卸载或者列出定时任务列表的命令。cron 配置文件则用于驱动 <code>Vixie Cron</code> 的 <a href=http://www.manpager.com/linux/man8/cron.8.html>cron(8)</a> 守护进程。每个用户都可以拥有自己的 crontab 文件，虽然这些文件都位于 <code>/var/spool/cron/crontabs</code> 目录中，但并不意味着你可以直接编辑它们。你需要通过 <code>crontab</code> 命令来编辑或者配置你自己的定时任务。</p><h3 id=定时配置文件的类型>定时配置文件的类型</h3><p>配置文件分为以下不同的类型：</p><ul><li><strong>UNIX 或 Linux 的系统级 crontab</strong> : 此类型通常由那些需要 root 或类似权限的系统服务和重要任务使用。第六个字段（见下方的字段介绍）为用户名，用来指定此命令以哪个用户身份来执行。如此一来，系统的 <code>crontab</code> 就能够以任意用户的身份来执行操作。</li><li><strong>用户的 crontab</strong>: 用户可以使用 <code>crontab</code> 命令来安装属于他们自己的定时任务。 第六个字段为需要运行的命令, 所有的命令都会以创建该 crontab 任务的用户的身份运行。</li></ul><p><strong>注意</strong>: 这种问答形式的 <code>Cron</code> 实现由 Paul Vixie 编写而成，并且被包含在许多 <a href=http://www.linuxsecrets.com/>Linux</a> 发行版本和类 Unix 系统（如广受欢迎的第四版 BSD）中。它的语法被各种 crond 的实现所<a href=http://www.linuxsecrets.com/linux-hardware/>兼容</a>。</p><p>那么我该如何安装、创建或者编辑我自己的定时任务呢？</p><p>要编辑你的 crontab 文件，需要在 Linux 或 Unix 的 shell 提示符后键入以下命令：</p><pre tabindex=0><code>$ crontab -e
</code></pre><p><code>crontab</code> 语法（字段介绍）</p><p>语法为：</p><pre tabindex=0><code>1 2 3 4 5 /path/to/command arg1 arg2
</code></pre><p>或者</p><pre tabindex=0><code>1 2 3 4 5 /root/ntp_sync.sh
</code></pre><p>其中：</p><ul><li>第1个字段：分钟 (0-59)</li><li>第2个字段：小时 (0-23)</li><li>第3个字段：日期 (1-31)</li><li>第4个字段：月份 (1-12 [12 代表 December])</li><li>第5个字段：一周当中的某天 (0-7 [7 或 0 代表星期天])</li><li>/path/to/command - 计划执行的脚本或命令的名称</li></ul><p>便于记忆的格式：</p><pre tabindex=0><code>* * * * * 要执行的命令
----------------
| | | | |
| | | | ---- 周当中的某天 (0 - 7) (周日为 0 或 7)
| | | ------ 月份 (1 - 12)
| | -------- 一月当中的某天 (1 - 31)
| ---------- 小时 (0 - 23)
------------ 分钟 (0 - 59)
</code></pre><p>简单的 <code>crontab</code> 示例：</p><pre tabindex=0><code>### 每隔 5 分钟运行一次 backupscript 脚本 ##
*/5 * * * * /root/backupscript.sh

### 每天的凌晨 1 点运行 backupscript 脚本 ##
0 1 * * * /root/backupscript.sh

### 每月的第一个凌晨 3:15 运行 backupscript 脚本 ##
15 3 1 * * /root/backupscript.sh
</code></pre><h3 id=如何使用操作符>如何使用操作符</h3><p>操作符允许你为一个字段指定多个值，这里有三个操作符可供使用：</p><ul><li><strong>星号 (</strong><code>*</code><strong>)</strong> : 此操作符为字段指定所有可用的值。举个例子，在小时字段中，一个星号等同于每个小时；在月份字段中，一个星号则等同于每月。</li><li><strong>逗号 (</strong><code>,</code><strong>)</strong> : 这个操作符指定了一个包含多个值的列表，例如：<code>1,5,10,15,20,25</code>.</li><li><strong>横杠 (</strong><code>-</code><strong>)</strong> : 此操作符指定了一个值的范围，例如：<code>5-15</code> ，等同于使用逗号操作符键入的 <code>5,6,7,8,9,...,13,14,15</code>。</li><li><strong>分隔符 (</strong><code>/</code><strong>)</strong> : 此操作符指定了一个步进值，例如： <code>0-23/</code> 可以用于小时字段来指定某个命令每小时被执行一次。步进值也可以跟在星号操作符后边，如果你希望命令行每 2 小时执行一次，则可以使用 <code>*/2</code>。</li></ul><h3 id=如何禁用邮件输出>如何禁用邮件输出</h3><p>默认情况下，某个命令或者脚本的输出内容（如果有的话）会发送到你的本地邮箱账户中。若想停止接收 <code>crontab</code> 发送的邮件，需要添加 <code>>/dev/null 2>&amp;1</code> 这段内容到执行的命令的后面，例如：</p><pre tabindex=0><code>0 3 * * * /root/backup.sh &gt;/dev/null 2&gt;&amp;1
</code></pre><p>如果想将输出内容发送到特定的邮件账户中，比如说 <a href=mailto:vivek@nixcraft.in>vivek@nixcraft.in</a> 这个邮箱， 则你需要像下面这样定义一个 MAILTO 变量：</p><pre tabindex=0><code>MAILTO=&#34;vivek@nixcraft.in&#34;
0 3 * * * /root/backup.sh &gt;/dev/null 2&gt;&amp;1
</code></pre><p>访问 “<a href=http://www.cyberciti.biz/faq/disable-the-mail-alert-by-crontab-command/>禁用 Crontab 命令的邮件提示</a>” 查看更多信息。</p><h3 id=任务列出你所有的定时任务>任务：列出你所有的定时任务</h3><p>键入以下命令：</p><pre tabindex=0><code># crontab -l
# crontab -u username -l
</code></pre><p>要删除所有的定时任务，可以使用如下命令：</p><pre tabindex=0><code>### 删除当前定时任务
crontab -r
</code></pre><pre tabindex=0><code>### 删除某用户名下的定时任务，此命令需以 root 用户身份执行
crontab -r -u username
</code></pre><h3 id=使用特殊字符串来节省时间>使用特殊字符串来节省时间</h3><p>你可以使用以下 8 个特殊字符串中的其中一个替代头五个字段，这样不但可以节省你的时间，还可以提高可读性。</p><table><thead><tr><th>特殊字符</th><th>含义</th></tr></thead><tbody><tr><td>@reboot</td><td>在每次启动时运行一次</td></tr><tr><td>@yearly</td><td>每年运行一次,等同于 “0 0 1 1 *”.</td></tr><tr><td>@annually</td><td>(同 @yearly)</td></tr><tr><td>@monthly</td><td>每月运行一次, 等同于 “0 0 1 * *”.</td></tr><tr><td>@weekly</td><td>每周运行一次, 等同于 “0 0 * * 0”.</td></tr><tr><td>@daily</td><td>每天运行一次, 等同于 “0 0 * * *”.</td></tr><tr><td>@midnight</td><td>(同 @daily)</td></tr><tr><td>@hourly</td><td>每小时运行一次, 等同于 “0 * * * *”.</td></tr></tbody></table><p>示例：</p><h4 id=每小时运行一次-ntpdate-命令>每小时运行一次 ntpdate 命令</h4><pre tabindex=0><code>@hourly /path/to/ntpdate
</code></pre><h3 id=关于-etccrontab-文件和-etccrond-目录的更多内容>关于 <code>/etc/crontab</code> 文件和 <code>/etc/cron.d/*</code> 目录的更多内容</h3><p><code>/etc/crontab</code> 是系统的 crontab 文件。通常只被 root 用户或守护进程用于配置系统级别的任务。每个单独的用户必须像上面介绍的那样使用 <code>crontab</code> 命令来安装和编辑自己的任务。<code>/var/spool/cron/</code> 或者 <code>/var/cron/tabs/</code> 目录存放了个人用户的 crontab 文件，它应该备份在用户的家目录当中。</p><h3 id=理解默认的-etccrontab-文件>理解默认的 <code>/etc/crontab</code> 文件</h3><p>典型的 <code>/etc/crontab</code> 文件内容是这样的：</p><pre tabindex=0><code>SHELL=/bin/bash
PATH=/sbin:/bin:/usr/sbin:/usr/bin
MAILTO=root
HOME=/
# run-parts
01 * * * * root run-parts /etc/cron.hourly
02 4 * * * root run-parts /etc/cron.daily
22 4 * * 0 root run-parts /etc/cron.weekly
42 4 1 * * root run-parts /etc/cron.monthly
</code></pre><p>首先，环境变量必须被定义。如果 SHELL 行被忽略，cron 会使用默认的 sh shell。如果 PATH 变量被忽略，就没有默认的搜索路径，所有的文件都需要使用绝对路径来定位。如果 HOME 变量被忽略，cron 会使用调用者（用户）的家目录替代。</p><p>另外，cron 会读取 <code>/etc/cron.d/</code>目录中的文件。通常情况下，像 sa-update 或者 sysstat 这样的系统守护进程会将他们的定时任务存放在此处。作为 root 用户或者超级用户，你可以使用以下目录来配置你的定时任务。你可以直接将脚本放到这里。<code>run-parts</code>命令会通过 <code>/etc/crontab</code> 文件来运行位于某个目录中的脚本或者程序。</p><table><thead><tr><th>目录</th><th>描述</th></tr></thead><tbody><tr><td>/etc/cron.d/</td><td>将所有的脚本文件放在此处，并从 /etc/crontab 文件中调用它们。</td></tr><tr><td>/etc/cron.daily/</td><td>运行需要 每天 运行一次的脚本</td></tr><tr><td>/etc/cron.hourly/</td><td>运行需要 每小时 运行一次的脚本</td></tr><tr><td>/etc/cron.monthly/</td><td>运行需要 每月 运行一次的脚本</td></tr><tr><td>/etc/cron.weekly/</td><td>运行需要 每周 运行一次的脚本</td></tr></tbody></table><h3 id=备份定时任务>备份定时任务</h3><pre tabindex=0><code># crontab -l &gt; /path/to/file

# crontab -u user -l &gt; /path/to/file
</code></pre><hr><p>via: <a href=https://www.unixmen.com/add-cron-jobs-linux-unix/>https://www.unixmen.com/add-cron-jobs-linux-unix/</a></p><p>作者：<a href=https://www.unixmen.com/author/duynv/>Duy NguyenViet</a> 译者：<a href=https://github.com/mr-ping>mr-ping</a> 校对：<a href=https://github.com/FSSlc>FSSlc</a></p><p>本文由 <a href=https://github.com/LCTT/TranslateProject>LCTT</a> 原创编译，<a href=https://linux.cn/>Linux中国</a> 荣誉推出</p></div><footer class=post__footer><div class="post__tags tags clearfix"><svg class="tags__badge icon icon-tag" width="16" height="16" viewBox="0 0 32 32"><path d="M32 19c0 1-1 2-1 2L21 31s-1 1-2 1-2-1-2-1L2 16c-1-1-1.4-2-1.4-2S0 12.5.0 11V3C0 1.5.8.8.8.8S1.5.0 3 0h8c1.5.0 3 .6 3 .6S15 1 16 2l15 15s1 1 1 2zM7 10a3 3 0 100-6 3 3 0 000 6z"/></svg><ul class=tags__list><li class=tags__item><a class="tags__link btn" href=/tags/cron/ rel=tag>cron</a></li><li class=tags__item><a class="tags__link btn" href=/tags/crontab/ rel=tag>crontab</a></li><li class=tags__item><a class="tags__link btn" href=/tags/%E5%AE%9A%E6%97%B6%E4%BB%BB%E5%8A%A1/ rel=tag>定时任务</a></li></ul></div></footer></article></main></div></div><footer class=footer><div class="container footer__container flex"><div class=footer__copyright>&copy; 2025 Linux.cn Archive.
<span class=footer__copyright-credits>Generated with <a href=https://gohugo.io/ rel="nofollow noopener" target=_blank>Hugo</a> and <a href=https://github.com/Vimux/Mainroad/ rel="nofollow noopener" target=_blank>Mainroad</a> theme.</span></div></div></footer></div><script async defer src=/js/menu.js></script></body></html>