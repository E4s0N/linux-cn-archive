<!doctype html><html class=no-js lang=en><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><title>如何在 Linux 上使用 pkgsrc - Linux.cn Archive</title>
<script>(function(e,t){e[t]=e[t].replace("no-js","js")})(document.documentElement,"className")</script><meta name=description content><meta property="og:title" content="如何在 Linux 上使用 pkgsrc"><meta property="og:description" content="NetBSD 的软件包管理器通用、灵活又容易。下面是如何使用它。"><meta property="og:type" content="article"><meta property="og:url" content="/article-11613-1.html"><meta property="article:section" content="posts"><meta property="article:published_time" content="2019-11-26T06:46:07+00:00"><meta property="article:modified_time" content="2019-11-26T06:46:07+00:00"><meta itemprop=name content="如何在 Linux 上使用 pkgsrc"><meta itemprop=description content="NetBSD 的软件包管理器通用、灵活又容易。下面是如何使用它。"><meta itemprop=datePublished content="2019-11-26T06:46:07+00:00"><meta itemprop=dateModified content="2019-11-26T06:46:07+00:00"><meta itemprop=wordCount content="369"><meta itemprop=keywords content="pkgsrc,"><link rel=preconnect href=https://fonts.bunny.net crossorigin><link rel=dns-prefetch href=//fonts.bunny.net><link rel=dns-prefetch href=//fonts.bunny.net><link rel=stylesheet href="https://fonts.bunny.net/css?family=Open+Sans:400,400i,700"><link rel=stylesheet href=/css/style.css><link rel="shortcut icon" href=/favicon.ico></head><body class=body><div class="container container--outer"><header class=header><div class="container header__container"><div class=logo><a class=logo__link href=/ title="Linux.cn Archive" rel=home><div class="logo__item logo__text"><div class=logo__title>Linux.cn Archive</div></div></a></div><nav class=menu><button class=menu__btn aria-haspopup=true aria-expanded=false tabindex=0>
<span class=menu__btn-title tabindex=-1>Menu</span></button><ul class=menu__list><li class=menu__item><a class=menu__link href=/><span class=menu__text>Home</span></a></li><li class=menu__item><a class=menu__link href=/categories/><span class=menu__text>Categories</span></a></li><li class=menu__item><a class=menu__link href=/tags/><span class=menu__text>Tags</span></a></li><li class=menu__item><a class=menu__link href><span class=menu__text>RSS</span></a></li></ul></nav></div></header><div class="wrapper flex"><div class=primary><main class=main role=main><article class=post><header class=post__header><h1 class=post__title>如何在 Linux 上使用 pkgsrc</h1><div class="post__meta meta"><div class="meta__item-datetime meta__item"><svg class="meta__icon icon icon-time" width="16" height="14" viewBox="0 0 30 28"><path d="M15 0C7 0 1 6 1 14s6 14 14 14 14-6 14-14S23 0 15 0zm0 25C9 25 4 20 4 14S9 3 15 3s11 5 11 11-5 11-11 11zm1-18h-2v8.4l6.8 4.4L22 18l-6-3.8V7z"/></svg><time class=meta__text datetime=2019-11-26T06:46:07Z>November 26, 2019</time></div></div></header><div class="content post__content clearfix"><blockquote><p>NetBSD 的软件包管理器通用、灵活又容易。下面是如何使用它。</p></blockquote><p><img src=/data/attachment/album/201911/26/064538fbktfzxba18wykde.jpg alt></p><p>NetBSD 以能在几乎所有平台上运行而闻名，但你知道它<em>第二</em>有名的 <a href=http://pkgsrc.org>pkgsrc</a> 包管理器吗？像 NetBSD 一样，pkgsrc 基本上可以在任何系统上运行，或者至少在任意 Unix 和类 Unix 的系统上上运行。你可以在 BSD、Linux、Illumos、Solaris 和 Mac 上安装 pkgsrc。它总共支持 20 多种操作系统。</p><h3 id=为什么使用-pkgsrc>为什么使用 pkgsrc？</h3><p>除了 MacOS 之外，所有 Unix 操作系统均自带包管理器。你不一定<em>需要</em> pkgsrc，但这可能是你想尝试的三个重要原因：</p><ul><li><strong>打包</strong>。如果你对打包感到好奇，但尚未尝试自己创建一个软件包，那么 pkgsrc 是一个相对简单的系统，尤其是如果你已经熟悉 Makefile 和类似 <a href=https://opensource.com/article/19/7/introduction-gnu-autotools>GNU Autotools</a> 之类的构建系统时。</li><li><strong>通用</strong>。如果你使用多个操作系统或发行版，那么可能会遇到每个系统的包管理器。你可以在不同的系统上使用 pkgsrc，以便你为一个系统打包了程序，就为所有系统打包了。</li><li><strong>灵活</strong>。在许多打包系统中，如何选择二进制包或源码包并不总是很明显。使用 pkgsrc，区别很明显，两种安装方法都一样容易，并且都可以为你解决依赖关系。</li></ul><h3 id=如何安装-pkgsrc>如何安装 pkgsrc</h3><p>无论你使用的是 BSD、Linux、Illumos、Solaris 还是 MacOS，安装过程都基本相同：</p><ol><li>使用 CVS 检出 pkgsrc 树</li><li>引导 pkgsrc 系统</li><li>安装软件包</li></ol><h4 id=使用-cvs-检出-pkgsrc-树>使用 CVS 检出 pkgsrc 树</h4><p>在 Git 和 Subversion 之前，就有了 <a href=http://www.netbsd.org/developers/cvs-repos/cvs_intro.html#intro>CVS</a>。要检出代码你无需了解 CVS 太多，如果你习惯 Git，那么可以将 检出 checkout 称为 克隆 clone 。当你用 CVS 检出 pkgsrc 时，你就下载了详细说明如何构建每个软件包的“ 配方 recipes ”。它有很多文件，但是它们都很小，因为你实际上并没有拉取每个包的源码，而只有按需构建时需要的构建基础架构和 Makefile。使用 CVS，你可以轻松地在新版本发布时更新 pkgsrc 检出。</p><p>pkgsrc 文档建议将其源码树放在 <code>/usr</code> 目录下，因此你必须使用 <code>sudo</code>（或成为 root）运行此命令：</p><pre tabindex=0><code>$ cd /usr
$ sudo cvs -q -z2 -d anoncvs@anoncvs.NetBSD.org:/cvsroot checkout -r pkgsrc-2019Q3 -P pkgsrc
</code></pre><p>在我撰写本文时，最新版本是 2019Q3。请检查 <a href=http://pkgsrc.org/>pkgsrc.org</a> 主页的新闻部分或 <a href=http://www.netbsd.org/docs/pkgsrc/getting.html>NetBSD文档</a>，以确定最新版本。</p><h4 id=引导-pkgsrc>引导 pkgsrc</h4><p>pkgsrc 树复制到你的计算机后，你会看到一个充满构建脚本的 <code>/usr/pkgsrc</code> 目录。在使用之前，你必须引导 pkgsrc，以便你可以轻松地访问构建和安装软件所需的相关命令。</p><p>引导 pkgsrc 的方式取决于你所使用操作系统。</p><p>对于 NetBSD，你只需使用捆绑的引导器：</p><pre tabindex=0><code># cd pkgsrc/bootstrap
# ./bootstrap
</code></pre><p>在其他系统上，还有更好的方法，包括一些自定义功能，它是由 Joyent 提供的。要了解运行的确切命令，请访问 <a href=http://pkgsrc.joyent.com/>pkgsrc.joyent.com</a>。比如，在 Linux（Fedora、Debian、Slackware 等）上：</p><pre tabindex=0><code>$ curl -O https://pkgsrc.joyent.com/packages/Linux/el7/bootstrap/bootstrap-trunk-x86_64-20170127.tar.gz
$ BOOTSTRAP_SHA=&#34;eb0d6911489579ca893f67f8a528ecd02137d43a&#34;
</code></pre><p>尽管路径暗示文件适用于 RHEL 7，但二进制文件往往与所有（最前沿的 Linux 发行版）兼容。如果你发现二进制文件与你的发行版不兼容，你可以选择从源码构建。</p><p>验证 SHA1 校验和：</p><pre tabindex=0><code>$ echo &#34;${BOOTSTRAP_SHA}&#34; bootstrap-trunk*gz &gt; check-shasum
sha1sum -c check-shasum
</code></pre><p>你还可以验证 PGP 签名：</p><pre tabindex=0><code>$ curl -O https://pkgsrc.joyent.com/packages/Linux/el7/bootstrap/bootstrap-trunk-x86_64-20170127.tar.gz.asc
$ curl -sS https://pkgsrc.joyent.com/pgp/56AAACAF.asc | gpg --import
$ gpg --verify ${BOOTSTRAP_TAR}{.asc,}
</code></pre><p>当你确认你已有正确的引导套件，将其安装到 <code>/usr/pkg</code>：</p><pre tabindex=0><code>sudo tar -zxpf ${BOOTSTRAP_TAR} -C /
</code></pre><p>它为你提供了通常的 pkgsrc 命令。将这些位置添加到<a href=https://opensource.com/article/17/6/set-path-linux>你的 PATH 环境变量中</a>：</p><pre tabindex=0><code>$ echo &#34;PATH=/usr/pkg/sbin:/usr/pkg/bin:$PATH&#34; &gt;&gt; ~/.bashrc
$ echo &#34;MANPATH=/usr/pkg/man:$MANPATH&#34; &gt;&gt; ~/.bashrc
</code></pre><p>如果你宁愿使用 pkgsrc 而不依赖于 Joyent 的构建，那么只需运行 pkgsrc 源码树的引导脚本即可。在运行特定于系统的脚本之前，请先阅读 <code>bootstrap</code> 目录中相关 <code>README</code> 文件。</p><p><img src=/data/attachment/album/201911/26/064609piqd1vh8x8j6vhhq.jpg alt="Bootstrapping pkgsrc on NetBSD" title="Bootstrapping pkgsrc on NetBSD"></p><h3 id=如何使用-pkgsrc-安装软件>如何使用 pkgsrc 安装软件</h3><p>使用 pkgsrc 安装预编译的二进制文件（就像使用 DNF 或 Apt 一样）是很容易的。二进制安装的命令是 <code>pgkin</code>，它有自己的专门网站 <a href=http://pkgin.net>pkgin.net</a>。对于任何用过 Linux 的人来说，这个过程应该感觉相当熟悉。</p><p>要搜索 <code>tmux</code> 包：</p><pre tabindex=0><code>$ pkgin search tmux
</code></pre><p>要安装 tmux 包：</p><pre tabindex=0><code>$ sudo pkgin install tmux
</code></pre><p><code>pkgin</code> 命令的目的是模仿典型的 Linux 包管理器的行为，因此有选项可以列出可用的包、查找包提供的特定可执行文件，等等。</p><h3 id=如何使用-pkgsrc-从源码构建>如何使用 pkgsrc 从源码构建</h3><p>然而，pkgsrc 真正强大的地方是方便地从源码构建包。你在第一步中检出了所有 20000 多个构建脚本，你可以直接进入 pkgsrc 源码树来访问这些脚本。</p><p>例如，要从源码构建 <code>tcsh</code>，首先找到构建脚本：</p><pre tabindex=0><code>$ find /usr/pkgsrc -type d -name &#34;tcsh&#34;
/usr/pkgsrc/shells/tcsh
</code></pre><p>接下来，进入源码目录：</p><pre tabindex=0><code>$ cd /usr/pgksrc/shells/tcsh
</code></pre><p>构建脚本目录包含许多文件来帮助在你的系统上构建应用，但值得注意的是，这里面有包含了软件说明的 <code>DESCR</code> 文件，以及触发构建的 <code>Makefile</code>。</p><pre tabindex=0><code>$ ls
CVS    DESCR     Makefile
PLIST  distinfo  patches
$ cat DESCR
TCSH is an extended C-shell with many useful features like
filename completion, history editing, etc.
$
</code></pre><p>准备就绪后，构建并安装：</p><pre tabindex=0><code>$ sudo bmake install
</code></pre><p>pkgsrc 系统使用 <code>bmake</code> 命令（在第一步检出 pkgsrc 后提供），因此请务必使用 <code>bmake</code>（而不是出于习惯使用 <code>make</code>）。</p><p>如果要为多个系统构建，那么你可以创建一个包，而不是立即安装：</p><pre tabindex=0><code>$ cd /usr/pgksrc/shells/tcsh
$ sudo bmake package
[...]
=&gt; Creating binary package in /usr/pkgsrc/packages/All/tcsh-X.Y.Z.tgz
</code></pre><p>pkgsrc 创建的包是标准的 tarball，但它可以方便地通过 <code>pkg_add</code> 安装：</p><pre tabindex=0><code>$ sudo pkg_add /usr/pkgsrc/packages/All/tcsh-X.Y.Z.tgz
tcsh-X.Y.Z: adding /usr/pkg/bin/tcsh to /etc/shells
$ tcsh
localhost%
</code></pre><p>pkgsrc 的 pkgtools 集合提供 <code>pkg_add</code>、<code>pkg_info</code>、<code>pkg_admin</code>、<code>pkg_create</code> 和 <code>pkg_delete</code> 命令，来帮助管理你在系统上构建和维护软件包。</p><h3 id=pkgsrc易于管理>pkgsrc，易于管理</h3><p>pkgsrc 系统提供了直接，容易上手的软件包管理方法。如果你正在寻找一个不妨碍你并且可以定制的包管理器，请在任何运行 Unix 或类 Unix 的系统上试试 pkgsrc。</p><hr><p>via: <a href=https://opensource.com/article/19/11/pkgsrc-netbsd-linux>https://opensource.com/article/19/11/pkgsrc-netbsd-linux</a></p><p>作者：<a href=https://opensource.com/users/seth>Seth Kenlon</a> 选题：<a href=https://github.com/lujun9972>lujun9972</a> 译者：<a href=https://github.com/geekpi>geekpi</a> 校对：<a href=https://github.com/wxy>wxy</a></p><p>本文由 <a href=https://github.com/LCTT/TranslateProject>LCTT</a> 原创编译，<a href=https://linux.cn/>Linux中国</a> 荣誉推出</p></div><footer class=post__footer><div class="post__tags tags clearfix"><svg class="tags__badge icon icon-tag" width="16" height="16" viewBox="0 0 32 32"><path d="M32 19c0 1-1 2-1 2L21 31s-1 1-2 1-2-1-2-1L2 16c-1-1-1.4-2-1.4-2S0 12.5.0 11V3C0 1.5.8.8.8.8S1.5.0 3 0h8c1.5.0 3 .6 3 .6S15 1 16 2l15 15s1 1 1 2zM7 10a3 3 0 100-6 3 3 0 000 6z"/></svg><ul class=tags__list><li class=tags__item><a class="tags__link btn" href=/tags/pkgsrc/ rel=tag>pkgsrc</a></li></ul></div></footer></article></main></div></div><footer class=footer><div class="container footer__container flex"><div class=footer__copyright>&copy; 2025 Linux.cn Archive.
<span class=footer__copyright-credits>Generated with <a href=https://gohugo.io/ rel="nofollow noopener" target=_blank>Hugo</a> and <a href=https://github.com/Vimux/Mainroad/ rel="nofollow noopener" target=_blank>Mainroad</a> theme.</span></div></div></footer></div><script async defer src=/js/menu.js></script></body></html>